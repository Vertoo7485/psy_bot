# app/services/self_help/days/day_4_service.rb
module SelfHelp
  module Days
    class Day4Service < DayBaseService
      include TelegramMarkupHelper
      
      # ĞšĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹
      DAY_NUMBER = 4
      
      # Ğ¨Ğ°Ğ³Ğ¸ Ğ´Ğ½Ñ 4
      DAY_STEPS = {
        'intro' => {
          title: "ğŸ¯ *Ğ”ĞµĞ½ÑŒ 4: ĞÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğµ â€” Ğ¸ÑĞºÑƒÑÑÑ‚Ğ²Ğ¾ Ğ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾* ğŸ‘ï¸",
          instruction: <<~MARKDOWN
            **Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Ğ¼Ğ¸Ñ€ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ½Ğ¸Ñ!** ğŸŒŸ

            Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ²Ñ‹ Ğ¾Ñ‚ĞºÑ€Ğ¾ĞµÑ‚Ğµ Ğ´Ğ»Ñ ÑĞµĞ±Ñ ÑƒĞ´Ğ¸Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½ÑƒÑ ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚ÑŒ â€” Ğ½Ğ°Ğ±Ğ»ÑĞ´Ğ°Ñ‚ÑŒ Ğ¼Ğ¸Ñ€ Ñ‚Ğ°Ğº, ĞºĞ°Ğº Ğ±ÑƒĞ´Ñ‚Ğ¾ Ğ²Ğ¸Ğ´Ğ¸Ñ‚Ğµ ĞµĞ³Ğ¾ Ğ²Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ. ĞÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğµ â€” ÑÑ‚Ğ¾ Ğ½Ğµ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ, Ğ° *Ğ²Ğ¸Ğ´ĞµÑ‚ÑŒ* Ğ¿Ğ¾-Ğ½Ğ°ÑÑ‚Ğ¾ÑÑ‰ĞµĞ¼Ñƒ.

            ğŸ“Š **ĞĞ°ÑƒÑ‡Ğ½Ñ‹Ğµ Ñ„Ğ°ĞºÑ‚Ñ‹ Ğ¾ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾ÑÑ‚Ğ¸:**
            â€¢ ğŸ§  Ğ£Ğ»ÑƒÑ‡ÑˆĞ°ĞµÑ‚ Ğ½ĞµĞ¹Ñ€Ğ¾Ğ¿Ğ»Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ·Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ ĞºĞ¾Ñ€Ñ‹ (Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ĞšĞ°Ğ»Ğ¸Ñ„Ğ¾Ñ€Ğ½Ğ¸Ğ¹ÑĞºĞ¾Ğ³Ğ¾ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚Ğ°)
            â€¢ ğŸ‘ï¸ Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¾ÑÑ‚Ñ€Ğ¾Ñ‚Ñƒ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ Ğº Ğ´ĞµÑ‚Ğ°Ğ»ÑĞ¼ Ğ½Ğ° 40-50%
            â€¢ ğŸ¨ ĞĞºÑ‚Ğ¸Ğ²Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğµ Ğ¿Ğ¾Ğ»ÑƒÑˆĞ°Ñ€Ğ¸Ğµ Ğ¼Ğ¾Ğ·Ğ³Ğ° (Ñ‚Ğ²Ğ¾Ñ€Ñ‡ĞµÑÑ‚Ğ²Ğ¾, Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ½Ğ¾Ğµ Ğ¼Ñ‹ÑˆĞ»ĞµĞ½Ğ¸Ğµ)
            â€¢ ğŸ˜Œ Ğ¡Ğ½Ğ¸Ğ¶Ğ°ĞµÑ‚ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ ÑÑ‚Ñ€ĞµÑÑĞ° Ğ¾Ñ‚ Ğ¿ĞµÑ€ĞµĞ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸ĞµĞ¹
            â€¢ ğŸ•°ï¸ Ğ—Ğ°Ğ¼ĞµĞ´Ğ»ÑĞµÑ‚ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸, ÑĞ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ñ ÑÑ„Ñ„ĞµĞºÑ‚ Â«Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°ÑÑ‚Ğ¾ÑÑ‰ĞµĞ³Ğ¾Â»

            ğŸ¯ **Ğ§Ñ‚Ğ¾ Ğ²Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚Ğµ Ğ¾Ñ‚ ÑĞµĞ³Ğ¾Ğ´Ğ½ÑÑˆĞ½ĞµĞ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:**
            1. ğŸ‘ï¸ ĞĞ°Ğ²Ñ‹Ğº Ğ³Ğ»ÑƒĞ±Ğ¸Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ
            2. ğŸ¨ Ğ¡Ğ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚ÑŒ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ñ‚ÑŒ ĞºÑ€Ğ°ÑĞ¾Ñ‚Ñƒ Ğ² Ğ¾Ğ±Ñ‹Ğ´ĞµĞ½Ğ½Ğ¾Ğ¼
            3. ğŸ§  Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° ĞºĞ¾Ğ½Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¸ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ
            4. ğŸ˜Œ Ğ¢ĞµÑ…Ğ½Ğ¸ĞºÑƒ Ğ´Ğ»Ñ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ÑƒÑĞ¿Ğ¾ĞºĞ¾ĞµĞ½Ğ¸Ñ ÑƒĞ¼Ğ°
            5. ğŸŒˆ ĞŸĞ¾Ğ²Ñ‹ÑˆĞµĞ½Ğ¸Ğµ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ‡ÑƒĞ²ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
          MARKDOWN
        },
        'exercise_explanation' => {
          title: "ğŸ‘ï¸ *Ğ£Ğ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ: Ğ˜ÑĞºÑƒÑÑÑ‚Ğ²Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ½Ğ¸Ñ* ğŸ‘ï¸",
          instruction: <<~MARKDOWN
            **ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ğ¸Ğ¼ĞµĞ½Ğ½Ğ¾ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğµ?** ğŸ§

            ĞĞ°ÑˆĞ¸ Ğ³Ğ»Ğ°Ğ·Ğ° ĞµĞ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ÑÑ‚ Ñ‚Ñ‹ÑÑÑ‡Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ², Ğ½Ğ¾ Ğ¼Ğ¾Ğ·Ğ³ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒĞµÑ‚ 99% Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ°Ğº Â«Ğ½ĞµĞ²Ğ°Ğ¶Ğ½ÑƒÑÂ». Ğ­Ñ‚Ğ° Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ¿ĞµÑ€ĞµĞ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ Ğ²Ğ°Ñˆ Ğ¼Ğ¾Ğ·Ğ³:

            â€¢ ğŸ”„ **Ğ›Ğ¾Ğ¼Ğ°ĞµÑ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ¼:** ĞŸÑ€ĞµÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ²Ñ‹Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ
            â€¢ ğŸ‘¶ **Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ´ĞµÑ‚ÑĞºĞ¾Ğµ Ğ²Ğ¸Ğ´ĞµĞ½Ğ¸Ğµ:** Ğ¡Ğ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ĞºĞ°Ğº Ğ² Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ñ€Ğ°Ğ·
            â€¢ ğŸ§  **Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¼Ğ¾Ğ·Ğ³:** Ğ£ĞºÑ€ĞµĞ¿Ğ»ÑĞµÑ‚ Ğ½ĞµĞ¹Ñ€Ğ¾Ğ½Ğ½Ñ‹Ğµ ÑĞ²ÑĞ·Ğ¸ Ğ´Ğ»Ñ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°
            â€¢ ğŸ˜Œ **Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ¼ĞµĞ´Ğ¸Ñ‚Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ:** Ğ¡Ğ½Ğ¸Ğ¶Ğ°ĞµÑ‚ Ñ‡Ğ°ÑÑ‚Ğ¾Ñ‚Ñƒ Ğ¼Ñ‹ÑĞ»ĞµĞ¹ Ğ½Ğ° 60-70%
            â€¢ ğŸ¨ **Ğ Ğ°Ğ·Ğ²Ğ¸Ğ²Ğ°ĞµÑ‚ ÑÑÑ‚ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ğµ:** Ğ£Ñ‡Ğ¸Ñ‚ Ğ²Ğ¸Ğ´ĞµÑ‚ÑŒ ĞºÑ€Ğ°ÑĞ¾Ñ‚Ñƒ Ğ² Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¼

            **ĞšĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ°:**
            1. ğŸ‘ï¸ Ğ¡Ğ¾Ğ·Ğ½Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ñ„Ğ¾ĞºÑƒÑĞ¸Ñ€ÑƒĞµĞ¼ÑÑ Ğ½Ğ° Ğ¾Ğ´Ğ½Ğ¾Ğ¼ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğµ
            2. ğŸ” ĞÑ‚Ğ¼ĞµÑ‡Ğ°ĞµĞ¼ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾ ÑƒĞ¿ÑƒÑĞºĞ°ĞµĞ¼
            3. ğŸ§  ĞŸĞ¾Ğ´Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ²Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğ¹ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ Ğ¾Ñ†ĞµĞ½Ğ¾Ñ‡Ğ½Ñ‹Ğ¼Ğ¸ Ğ¼Ñ‹ÑĞ»ÑĞ¼Ğ¸
            4. ğŸŒŠ ĞŸĞ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµĞ¼ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ Ñ‚ĞµÑ‡ÑŒ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ğ¾

            **Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½ÑÑˆĞ½ĞµĞµ ÑƒĞ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ:** 3-7 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ Ğ·Ğ° Ğ¾Ğ´Ğ½Ğ¸Ğ¼ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ¼.
            Ğ¦ĞµĞ»ÑŒ â€” Ğ½Ğµ Â«Ğ¿Ñ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒÂ», Ğ° Â«ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ ĞºĞ°Ğº Ğ±ÑƒĞ´Ñ‚Ğ¾ Ğ²Ğ¿ĞµÑ€Ğ²Ñ‹ĞµÂ».
          MARKDOWN
        },
        'practice_guidance' => {
          title: "ğŸ“‹ *ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğº Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¼ĞµĞ´Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ğ¸* ğŸ“‹",
          instruction: <<~MARKDOWN
            **ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:**

            ğŸ‘ï¸ **ĞŸĞ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¸ Ñ„Ğ¾ĞºÑƒÑ:**
            â€¢ Ğ¡ÑĞ´ÑŒÑ‚Ğµ ĞºĞ¾Ğ¼Ñ„Ğ¾Ñ€Ñ‚Ğ½Ğ¾, ÑĞ¿Ğ¸Ğ½Ğ° Ğ¿Ñ€ÑĞ¼Ğ°Ñ, Ğ½Ğ¾ Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ğ½Ğ°Ñ
            â€¢ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ğ±ÑŠĞµĞºÑ‚ Ğ½Ğ° Ñ€Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸ 1-3 Ğ¼ĞµÑ‚Ñ€Ğ°
            â€¢ ĞĞ±ÑŠĞµĞºÑ‚ Ğ½Ğµ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ğ¼ Ğ¸Ğ»Ğ¸ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ¿Ñ€Ğ¾ÑÑ‚Ñ‹Ğ¼
            â€¢ Ğ Ğ°ÑÑĞ»Ğ°Ğ±ÑŒÑ‚Ğµ Ğ³Ğ»Ğ°Ğ·Ğ°, Ğ½Ğµ Ğ½Ğ°Ğ¿Ñ€ÑĞ³Ğ°Ğ¹Ñ‚Ğµ Ğ·Ñ€ĞµĞ½Ğ¸Ğµ

            ğŸŒŸ **Ğ›ÑƒÑ‡ÑˆĞ¸Ğµ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ñ‹ Ğ´Ğ»Ñ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ:**
            â€¢ ĞšĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ½Ğ¾Ğµ Ñ€Ğ°ÑÑ‚ĞµĞ½Ğ¸Ğµ Ñ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ½Ñ‹Ğ¼Ğ¸ Ğ»Ğ¸ÑÑ‚ÑŒÑĞ¼Ğ¸
            â€¢ ĞšĞ°Ñ€Ñ‚Ğ¸Ğ½Ğ° Ğ¸Ğ»Ğ¸ Ñ„Ğ¾Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ Ñ Ğ´ĞµÑ‚Ğ°Ğ»ÑĞ¼Ğ¸
            â€¢ Ğ¤Ñ€ÑƒĞºÑ‚ Ğ¸Ğ»Ğ¸ Ğ¾Ğ²Ğ¾Ñ‰ Ñ Ñ‚ĞµĞºÑÑ‚ÑƒÑ€Ğ¾Ğ¹
            â€¢ Ğ§Ğ°ÑÑ‹ Ñ ÑĞµĞºÑƒĞ½Ğ´Ğ½Ğ¾Ğ¹ ÑÑ‚Ñ€ĞµĞ»ĞºĞ¾Ğ¹
            â€¢ Ğ¡Ğ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ Ñ€ÑƒĞºĞ¸
            â€¢ Ğ£Ğ·Ğ¾Ñ€ Ğ½Ğ° Ñ‚ĞºĞ°Ğ½Ğ¸ Ğ¸Ğ»Ğ¸ ĞºĞ¾Ğ²Ñ€Ğµ

            ğŸ§  **Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ½Ğ° Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ:**
            â€¢ ĞÑ‚ĞºĞ°Ğ¶Ğ¸Ñ‚ĞµÑÑŒ Ğ¾Ñ‚ Ñ†ĞµĞ»Ğ¸ Â«Ğ¿Ğ¾Ğ½ÑÑ‚ÑŒÂ» Ğ¾Ğ±ÑŠĞµĞºÑ‚
            â€¢ ĞĞ°Ğ±Ğ»ÑĞ´Ğ°Ğ¹Ñ‚Ğµ Ğ±ĞµĞ· Ğ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ (Â«ÑÑ‚Ğ¾ Ğ»Ğ¸ÑÑ‚Â») Ğ¸ Ğ¾Ñ†ĞµĞ½ĞºĞ¸ (Â«ÑÑ‚Ğ¾ ĞºÑ€Ğ°ÑĞ¸Ğ²Ğ¾Â»)
            â€¢ Ğ‘ÑƒĞ´ÑŒÑ‚Ğµ Ğ»ÑĞ±Ğ¾Ğ¿Ñ‹Ñ‚Ğ½Ñ‹: Â«Ğ˜Ğ½Ñ‚ĞµÑ€ĞµÑĞ½Ğ¾, Ñ‡Ñ‚Ğ¾ Ñ ÑĞµĞ¹Ñ‡Ğ°Ñ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ñ?Â»
            â€¢ ĞŸÑ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ¹Ñ‚Ğµ Ğ²ÑÑ‘, Ñ‡Ñ‚Ğ¾ Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ² Ğ¿Ğ¾Ğ»Ğµ Ğ·Ñ€ĞµĞ½Ğ¸Ñ
            â€¢ Ğ•ÑĞ»Ğ¸ Ğ¿Ğ¾ÑĞ²Ğ»ÑÑÑ‚ÑÑ Ğ¼Ñ‹ÑĞ»Ğ¸ Ğ¾ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğµ â€” Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ¾Ñ‚Ğ¼ĞµÑ‡Ğ°Ğ¹Ñ‚Ğµ Ğ¸Ñ… Ğ¸ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°Ğ¹Ñ‚ĞµÑÑŒ Ğº Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ

            **Ğ’Ğ°Ğ¶Ğ½Ğ¾:** ĞšĞ°Ğº Ğ¸ Ğ² Ğ´Ñ‹Ñ…Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ¼ĞµĞ´Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ğ¸, ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ€Ğ°Ğ·, ĞºĞ¾Ğ³Ğ´Ğ° Ğ²Ñ‹ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°ĞµÑ‚Ğµ, Ñ‡Ñ‚Ğ¾ Ğ¾Ñ‚Ğ²Ğ»ĞµĞºĞ»Ğ¸ÑÑŒ, Ğ¸ Ğ¼ÑĞ³ĞºĞ¾ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ĞµÑÑŒ â€” ÑÑ‚Ğ¾ Ğ¸ ĞµÑÑ‚ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ°.
          MARKDOWN
        },
        'post_practice_reflection' => {
          title: "ğŸ“ *Ğ ĞµÑ„Ğ»ĞµĞºÑĞ¸Ñ Ğ¿Ğ¾ÑĞ»Ğµ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸* ğŸ“",
          instruction: <<~MARKDOWN
            **ĞŸÑ€ĞµĞºÑ€Ğ°ÑĞ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°! Ğ’Ñ‹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ!** ğŸŒˆ

            **Ğ’Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ´Ğ»Ñ Ñ€ĞµÑ„Ğ»ĞµĞºÑĞ¸Ğ¸:**

            ğŸ‘ï¸ **1. Ğ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ¾Ğ¿Ñ‹Ñ‚Ğµ:**
            â€¢ Ğ§Ñ‚Ğ¾ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ²Ñ‹ Ğ·Ğ°Ğ¼ĞµÑ‚Ğ¸Ğ»Ğ¸ Ğ² Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğµ?
            â€¢ ĞšĞ°Ğº Ğ¼ĞµĞ½ÑĞ»Ğ¾ÑÑŒ Ğ²Ğ°ÑˆĞµ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ğµ Ğ² Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞµ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ?
            â€¢ Ğ‘Ñ‹Ğ»Ğ¸ Ğ»Ğ¸ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ñ‹ Â«Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸ÑÂ»?
            â€¢ ĞšĞ°ĞºĞ¸Ğµ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ²Ñ‹ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾ Ğ½Ğµ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°ĞµÑ‚Ğµ?

            ğŸ§  **2. ĞĞ± ÑƒĞ¼Ğµ Ğ¸ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¸:**
            â€¢ ĞšĞ°Ğº Ñ‡Ğ°ÑÑ‚Ğ¾ Ğ¿Ğ¾ÑĞ²Ğ»ÑĞ»Ğ¸ÑÑŒ Ğ¾Ñ†ĞµĞ½Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ¼Ñ‹ÑĞ»Ğ¸ (Â«ĞºÑ€Ğ°ÑĞ¸Ğ²Ğ¾Â», Â«ÑĞºÑƒÑ‡Ğ½Ğ¾Â»)?
            â€¢ Ğ£Ğ´Ğ°Ğ²Ğ°Ğ»Ğ¾ÑÑŒ Ğ»Ğ¸ Ğ²Ğ°Ğ¼ Ğ½Ğ°Ğ±Ğ»ÑĞ´Ğ°Ñ‚ÑŒ Ğ±ĞµĞ· Ğ²Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½ĞµĞ³Ğ¾ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ°?
            â€¢ ĞšĞ°Ğº Ğ²Ñ‹ ÑĞµĞ±Ñ Ñ‡ÑƒĞ²ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ»Ğ¸, ĞºĞ¾Ğ³Ğ´Ğ° Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ ÑĞ¼Ğ¾Ñ‚Ñ€ĞµĞ»Ğ¸, Ğ½Ğµ Ğ´ÑƒĞ¼Ğ°Ñ?
            â€¢ ĞšĞ°ĞºĞ¸Ğµ Ğ¼Ñ‹ÑĞ»Ğ¸ Ğ±Ñ‹Ğ»Ğ¸ ÑĞ°Ğ¼Ñ‹Ğ¼Ğ¸ Ğ½Ğ°ÑÑ‚Ğ¾Ğ¹Ñ‡Ğ¸Ğ²Ñ‹Ğ¼Ğ¸?

            ğŸ’« **3. Ğ Ñ‚ĞµĞ»Ğµ Ğ¸ Ğ¾Ğ±Ñ‰ĞµĞ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸:**
            â€¢ ĞšĞ°Ğº Ñ‡ÑƒĞ²ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ»Ğ¸ ÑĞµĞ±Ñ Ğ³Ğ»Ğ°Ğ·Ğ° (Ğ½Ğ°Ğ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ğµ/Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ğ¸Ğµ)?
            â€¢ Ğ˜Ğ·Ğ¼ĞµĞ½ÑĞ»Ğ¾ÑÑŒ Ğ»Ğ¸ Ğ´Ñ‹Ñ…Ğ°Ğ½Ğ¸Ğµ Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸?
            â€¢ Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ğ»Ğ¾ Ñ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸ĞµĞ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸?
            â€¢ ĞšĞ°Ğº Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»Ğ¾ÑÑŒ Ğ²Ğ°ÑˆĞµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¾Ñ‚ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğº ĞºĞ¾Ğ½Ñ†Ñƒ?

            ğŸŒŸ **Ğ—Ğ°Ğ¿Ğ¾Ğ¼Ğ½Ğ¸Ñ‚Ğµ:** Ğ¦ĞµĞ»ÑŒ Ğ½Ğµ Ğ² Ñ‚Ğ¾Ğ¼, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Â«Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Â» Ğ½Ğ°Ğ±Ğ»ÑĞ´Ğ°Ñ‚ÑŒ, Ğ° Ğ² Ñ‚Ğ¾Ğ¼, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ *Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ñ‚ÑŒ*, ĞºĞ°Ğº Ğ²Ñ‹ Ğ½Ğ°Ğ±Ğ»ÑĞ´Ğ°ĞµÑ‚Ğµ.
          MARKDOWN
        }
      }.freeze
      
      # Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ¸ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ
      OBSERVATION_TECHNIQUES = [
        {
          name: "Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ¿ÑÑ‚Ğ½Ğ°",
          emoji: "ğŸ¨",
          description: "Ğ¡Ğ¾ÑÑ€ĞµĞ´Ğ¾Ñ‚Ğ¾Ñ‡ÑŒÑ‚ĞµÑÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° Ñ†Ğ²ĞµÑ‚Ğ°Ñ…. Ğ—Ğ°Ğ¼ĞµÑ‡Ğ°Ğ¹Ñ‚Ğµ Ğ¾Ñ‚Ñ‚ĞµĞ½ĞºĞ¸, Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ñ‹, Ğ¸Ğ½Ñ‚ĞµĞ½ÑĞ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ. Ğ˜Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ñ„Ğ¾Ñ€Ğ¼Ñƒ Ğ¸ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ.",
          for_situation: "Ğ”Ğ»Ñ ÑĞ½ÑÑ‚Ğ¸Ñ Ğ½Ğ°Ğ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ñ, Ñ€Ğ°Ğ·Ğ²Ğ¸Ñ‚Ğ¸Ñ Ñ†Ğ²ĞµÑ‚Ğ¾Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ"
        },
        {
          name: "ĞšĞ¾Ğ½Ñ‚ÑƒÑ€Ñ‹ Ğ¸ Ñ„Ğ¾Ñ€Ğ¼Ñ‹",
          emoji: "ğŸŒ€",
          description: "Ğ¡Ğ»ĞµĞ´Ğ¸Ñ‚Ğµ Ğ·Ğ° Ğ»Ğ¸Ğ½Ğ¸ÑĞ¼Ğ¸ Ğ¸ ĞºĞ¾Ğ½Ñ‚ÑƒÑ€Ğ°Ğ¼Ğ¸. Ğ—Ğ°Ğ¼ĞµÑ‡Ğ°Ğ¹Ñ‚Ğµ Ğ¸Ğ·Ğ³Ğ¸Ğ±Ñ‹, ÑƒĞ³Ğ»Ñ‹, Ğ³ĞµĞ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹. Ğ¦Ğ²ĞµÑ‚ Ğ¸ Ñ‚ĞµĞºÑÑ‚ÑƒÑ€Ğ° Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‡Ğ½Ñ‹.",
          for_situation: "Ğ”Ğ»Ñ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸, Ñ‚Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ Ğº Ğ´ĞµÑ‚Ğ°Ğ»ÑĞ¼"
        },
        {
          name: "Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¿Ñ€Ğ¸Ñ€Ğ¾Ğ´Ñ‹",
          emoji: "ğŸŒ³",
          description: "ĞĞ°Ğ±Ğ»ÑĞ´Ğ°Ğ¹Ñ‚Ğµ Ğ¿Ñ€Ğ¸Ñ€Ğ¾Ğ´Ğ½Ñ‹Ğ¹ Ğ¾Ğ±ÑŠĞµĞºÑ‚. Ğ Ğ°ÑÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¾Ğ¶Ğ¸Ğ»ĞºĞ¸ Ğ»Ğ¸ÑÑ‚Ğ°, ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ ĞºĞ°Ğ¼Ğ½Ñ, ÑƒĞ·Ğ¾Ñ€Ñ‹ Ğ½Ğ° ĞºĞ¾Ñ€Ğµ. ĞŸĞ¾Ğ´Ğ¼ĞµÑ‡Ğ°Ğ¹Ñ‚Ğµ Ğ½ĞµÑĞ¾Ğ²ĞµÑ€ÑˆĞµĞ½ÑÑ‚Ğ²Ğ°.",
          for_situation: "Ğ”Ğ»Ñ ÑĞ²ÑĞ·Ğ¸ Ñ Ğ¿Ñ€Ğ¸Ñ€Ğ¾Ğ´Ğ¾Ğ¹, Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚Ğ¸Ñ"
        },
        {
          name: "ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ñ‹Ğµ Ğ»Ğ¸Ğ½Ğ¸Ğ¸",
          emoji: "ğŸ›ï¸",
          description: "Ğ¤Ğ¾ĞºÑƒÑ Ğ½Ğ° ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ°Ñ…. ĞĞ°Ğ±Ğ»ÑĞ´Ğ°Ğ¹Ñ‚Ğµ ÑĞ¸Ğ¼Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ, Ğ¿Ñ€Ğ¾Ğ¿Ğ¾Ñ€Ñ†Ğ¸Ğ¸, Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ Ğ»Ğ¸Ğ½Ğ¸Ğ¹.",
          for_situation: "Ğ”Ğ»Ñ ÑƒĞ¿Ğ¾Ñ€ÑĞ´Ğ¾Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¼Ñ‹ÑĞ»ĞµĞ¹, ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹"
        },
        {
          name: "Ğ’Ğ·Ğ³Ğ»ÑĞ´ Ñ€ĞµĞ±ĞµĞ½ĞºĞ°",
          emoji: "ğŸ”„",
          description: "ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ğ¾Ğ±ÑŠĞµĞºÑ‚ ĞºĞ°Ğº Ğ² Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ñ€Ğ°Ğ·. Ğ—Ğ°Ğ±ÑƒĞ´ÑŒÑ‚Ğµ ĞµĞ³Ğ¾ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ. ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚Ğµ Ñ Ğ½Ğ°Ğ¸Ğ²Ğ½Ñ‹Ğ¼ Ğ»ÑĞ±Ğ¾Ğ¿Ñ‹Ñ‚ÑÑ‚Ğ²Ğ¾Ğ¼.",
          for_situation: "Ğ”Ğ»Ñ Ñ‚Ğ²Ğ¾Ñ€Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ñ€Ñ‹Ğ²Ğ°, ÑĞ²ĞµĞ¶ĞµĞ³Ğ¾ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ"
        },
        {
          name: "ĞšĞ°Ñ€Ñ‚Ğ¸Ğ½Ğ° ĞºĞ°Ğº Ğ¼ĞµĞ´Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ñ",
          emoji: "ğŸ–¼ï¸",
          description: "Ğ Ğ°ÑÑĞ¼Ğ°Ñ‚Ñ€Ğ¸Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğº Ğ¼ĞµĞ´Ğ¸Ñ‚Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¾Ğ±ÑŠĞµĞºÑ‚. ĞŸĞ¾Ğ·Ğ²Ğ¾Ğ»ÑŒÑ‚Ğµ Ğ²Ğ·Ğ³Ğ»ÑĞ´Ñƒ Ğ±Ğ»ÑƒĞ¶Ğ´Ğ°Ñ‚ÑŒ Ğ±ĞµĞ· Ñ†ĞµĞ»Ğ¸.",
          for_situation: "Ğ”Ğ»Ñ Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¾Ğ³Ğ¾ Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ğ¸Ñ, ÑÑÑ‚ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ½Ğ°ÑĞ»Ğ°Ğ¶Ğ´ĞµĞ½Ğ¸Ñ"
        }
      ].freeze
      
      # Ğ¢Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ² Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ
      COMMON_CHALLENGES = [
        {
          challenge: "Ğ“Ğ»Ğ°Ğ·Ğ° ÑƒÑÑ‚Ğ°ÑÑ‚ Ğ¸Ğ»Ğ¸ Ğ½Ğ°Ğ¿Ñ€ÑĞ³Ğ°ÑÑ‚ÑÑ",
          emoji: "ğŸŒ€",
          solution: "ĞœÑĞ³ĞºĞ¾ Ğ¼Ğ¾Ñ€Ğ³Ğ°Ğ¹Ñ‚Ğµ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 15-30 ÑĞµĞºÑƒĞ½Ğ´. Ğ Ğ°ÑÑĞ»Ğ°Ğ±ÑŒÑ‚Ğµ Ğ²ĞµĞºĞ¸. ĞŸĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ¸Ñ‚Ğµ Ğ²Ğ·Ğ³Ğ»ÑĞ´ Ğ½Ğ° Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ ÑƒÑ‡Ğ°ÑÑ‚Ğ¾Ğº Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ°. ĞŸĞ¾Ğ¼Ğ½Ğ¸Ñ‚Ğµ: ÑÑ‚Ğ¾ Ğ½Ğµ Ğ¿Ñ€Ğ¸ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ğ·Ğ³Ğ»ÑĞ´, Ğ° Ğ¼ÑĞ³ĞºĞ¾Ğµ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğµ."
        },
        {
          challenge: "Ğ¢Ñ€ÑƒĞ´Ğ½Ğ¾ ĞºĞ¾Ğ½Ñ†ĞµĞ½Ñ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ, ÑƒĞ¼ Ğ±Ğ»ÑƒĞ¶Ğ´Ğ°ĞµÑ‚",
          emoji: "ğŸ˜£",
          solution: "Ğ­Ñ‚Ğ¾ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾! ĞšĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ Ğ²Ğ·Ğ³Ğ»ÑĞ´Ğ° Ğº Ğ¾Ğ±ÑŠĞµĞºÑ‚Ñƒ â€” ÑÑ‚Ğ¾ ÑƒÑĞ¿ĞµÑ…. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ·Ğ°Ğ´Ğ°Ğ²Ğ°Ñ‚ÑŒ ÑĞµĞ±Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ: Â«Ğ§Ñ‚Ğ¾ Ñ ÑĞµĞ¹Ñ‡Ğ°Ñ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ñ?Â» Ğ­Ñ‚Ğ¾ Ğ¿Ğ¾Ğ¼Ğ¾Ğ¶ĞµÑ‚ ÑƒĞ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ñ„Ğ¾ĞºÑƒÑ."
        },
        {
          challenge: "ĞœÑ‹ÑĞ»Ğ¸ Ğ¼ĞµÑˆĞ°ÑÑ‚ (Â«Ğ­Ñ‚Ğ¾ ÑĞºÑƒÑ‡Ğ½Ğ¾Â», Â«ĞĞ¸Ñ‡ĞµĞ³Ğ¾ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ½Ğ¾Ğ³Ğ¾Â»)",
          emoji: "ğŸ’­",
          solution: "ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ ÑÑ‚Ğ¸ Ğ¼Ñ‹ÑĞ»Ğ¸ ĞºĞ°Ğº Ğ¾Ğ±Ğ»Ğ°ĞºĞ° Ğ½Ğ° Ğ½ĞµĞ±Ğµ. ĞĞ½Ğ¸ Ñ‡Ğ°ÑÑ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°. ĞÑ‚Ğ¼ĞµÑ‚ÑŒÑ‚Ğµ Ğ¸Ñ…: Â«Ğ, ÑÑ‚Ğ¾ Ğ¼Ñ‹ÑĞ»ÑŒ Ğ¾ ÑĞºÑƒĞºĞµÂ», Ğ¸ Ğ¼ÑĞ³ĞºĞ¾ Ğ²ĞµÑ€Ğ½Ğ¸Ñ‚ĞµÑÑŒ Ğº Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ."
        },
        {
          challenge: "ĞĞµ Ğ²Ğ¸Ğ¶Ñƒ Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾ Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾, Ğ²ÑÑ‘ Ğ¾Ğ±Ñ‹Ğ´ĞµĞ½Ğ½Ğ¾",
          emoji: "ğŸ‘ï¸",
          solution: "Ğ˜Ğ¼ĞµĞ½Ğ½Ğ¾ Ğ² ÑÑ‚Ğ¾Ğ¼ Ğ¸ Ñ†ĞµĞ»ÑŒ â€” ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ğ¼Ğ°Ğ³Ğ¸Ñ Ğ² Ğ¾Ğ±Ñ‹Ğ´ĞµĞ½Ğ½Ğ¾Ğ¼. ĞŸÑ€Ğ¸ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚ĞµÑÑŒ Ğº Ñ‚ĞµĞºÑÑ‚ÑƒÑ€Ğµ, Ğº Ğ¸Ğ³Ñ€Ğµ ÑĞ²ĞµÑ‚Ğ°, Ğº Ğ¼ĞµĞ»ÑŒÑ‡Ğ°Ğ¹ÑˆĞ¸Ğ¼ Ğ´ĞµÑ‚Ğ°Ğ»ÑĞ¼. Ğ˜Ğ½Ğ¾Ğ³Ğ´Ğ° Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ´Ğ¾Ğ»ÑŒÑˆĞµ."
        }
      ].freeze
      
      # ===== ĞŸĞ£Ğ‘Ğ›Ğ˜Ğ§ĞĞ«Ğ• ĞœĞ•Ğ¢ĞĞ”Ğ« =====
      
      def deliver_intro
        send_message(text: DAY_STEPS['intro'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['intro'][:instruction], parse_mode: 'Markdown')
        
        # Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ´Ğ»Ñ Ğ¼Ğ¾Ñ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ğ¸
        send_message(
          text: statistics_message,
          parse_mode: 'Markdown'
        )
        
        @user.set_self_help_step("day_#{DAY_NUMBER}_intro")
        store_day_data('current_step', 'intro')
        
        send_message(
          text: "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ²Ğ¸Ğ´ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ñ… Ğ²ĞµÑ‰ĞµĞ¹?",
          reply_markup: day_4_content_markup
        )
      end
      
      def deliver_exercise
        @user.set_self_help_step("day_#{DAY_NUMBER}_exercise_in_progress")
        store_day_data('current_step', 'exercise_explanation')
        
        send_message(text: DAY_STEPS['exercise_explanation'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['exercise_explanation'][:instruction], parse_mode: 'Markdown')
        
        send_message(
          text: "ğŸ¨ **Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºÑƒ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ:**",
          parse_mode: 'Markdown',
          reply_markup: day_4_observation_techniques_markup
        )
      end
      
      # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ¸ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ
      def handle_technique_selection(technique_index)
        technique = OBSERVATION_TECHNIQUES[technique_index.to_i]
        
        if technique
          store_day_data('selected_technique', technique)
          
          send_message(
            text: "âœ… Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ° Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ°: #{technique[:emoji]} *#{technique[:name]}*\n\n#{technique[:description]}",
            parse_mode: 'Markdown'
          )
          
          send_message(
            text: "#{technique[:emoji]} **ĞšĞ¾Ğ³Ğ´Ğ° Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ Ğ¿Ğ¾Ğ»ĞµĞ·Ğ½Ğ°:** #{technique[:for_situation]}",
            parse_mode: 'Markdown'
          )
          
          # ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¸Ğ¼ Ğº Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞµ
          sleep(1)
          show_practice_guidance
        else
          send_message(text: "âš ï¸ ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ°Ñ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ°. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¸Ğ· Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ½Ñ‹Ñ….")
        end
      end
      
      def show_practice_guidance
        store_day_data('current_step', 'practice_guidance')
        
        send_message(text: DAY_STEPS['practice_guidance'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['practice_guidance'][:instruction], parse_mode: 'Markdown')
        
        send_message(
          text: "â±ï¸ *Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:*\n\nâ€¢ ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ÑÑ‰Ğ¸Ğµ: 3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹\nâ€¢ Ğ¡ Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğ¼: 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚\nâ€¢ ĞŸÑ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ñ‹Ğµ: 7 Ğ¼Ğ¸Ğ½ÑƒÑ‚\n\n*ĞĞ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ Ñ ĞºĞ¾Ğ¼Ñ„Ğ¾Ñ€Ñ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ»Ñ Ğ²Ğ°Ñ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸!*",
          parse_mode: 'Markdown',
          reply_markup: day_4_observation_timer_markup
        )
      end
      
      def start_observation_timer(minutes)
        store_day_data('observation_time', minutes)
        
        timer_message = <<~MARKDOWN
          ğŸ‘ï¸ *ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ!* ğŸ‘ï¸

          â±ï¸ **Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Ğ½Ğ° #{minutes} Ğ¼Ğ¸Ğ½ÑƒÑ‚**
          
          ğŸ¯ **Ğ’Ğ°ÑˆĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°:**
          1. Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ğ±ÑŠĞµĞºÑ‚ Ğ´Ğ»Ñ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ
          2. ĞŸÑ€Ğ¸Ğ¼Ğ¸Ñ‚Ğµ ÑƒĞ´Ğ¾Ğ±Ğ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
          3. ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½ÑƒÑ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºÑƒ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ
          4. ĞšĞ¾Ğ³Ğ´Ğ° ÑƒĞ¼ Ğ¾Ñ‚Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ÑÑ â€” Ğ¼ÑĞ³ĞºĞ¾ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°Ğ¹Ñ‚Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğº Ğ¾Ğ±ÑŠĞµĞºÑ‚Ñƒ
          5. ĞĞ°Ğ±Ğ»ÑĞ´Ğ°Ğ¹Ñ‚Ğµ Ğ±ĞµĞ· Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°
          
          ğŸŒŸ **ĞĞ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ½Ğ¸Ğµ:** ĞšĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ Ğº Ğ¾Ğ±ÑŠĞµĞºÑ‚Ñƒ â€” ÑÑ‚Ğ¾ ÑƒĞºÑ€ĞµĞ¿Ğ»ĞµĞ½Ğ¸Ğµ Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ğ½Ğ°Ğ²Ñ‹ĞºĞ° Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾ÑÑ‚Ğ¸!
          
          ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ½Ğ¸Ğ¶Ğµ, ĞºĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°ĞºĞ¾Ğ½Ñ‡Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ.
        MARKDOWN
        
        send_message(text: timer_message, parse_mode: 'Markdown')
        
        send_message(
          text: "â³ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ´Ğ»Ğ¸Ñ‚ÑÑ #{minutes} Ğ¼Ğ¸Ğ½ÑƒÑ‚...",
          reply_markup: day_4_practice_completion_markup
        )
      end
      
      def complete_practice
        store_day_data('practice_completed', true)
        store_day_data('completion_time', Time.current)
        
        # ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ€ĞµÑ„Ğ»ĞµĞºÑĞ¸Ñ
        show_post_practice_reflection
      end
      
      def show_post_practice_reflection
        store_day_data('current_step', 'post_practice_reflection')
        
        send_message(text: DAY_STEPS['post_practice_reflection'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['post_practice_reflection'][:instruction], parse_mode: 'Markdown')
        
        send_message(
          text: "ğŸ¤” *Ğ¡ ĞºĞ°ĞºĞ¸Ğ¼Ğ¸ Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚ÑĞ¼Ğ¸ ÑÑ‚Ğ¾Ğ»ĞºĞ½ÑƒĞ»Ğ¸ÑÑŒ?*",
          parse_mode: 'Markdown',
          reply_markup: day_4_challenges_markup
        )
      end
      
      def handle_challenge_selection(challenge_index)
        challenge = COMMON_CHALLENGES[challenge_index.to_i]
        
        if challenge
          send_message(
            text: "ğŸŒ€ **#{challenge[:challenge]}**\n\n#{challenge[:solution]}",
            parse_mode: 'Markdown'
          )
        end
        
        send_message(
          text: "ğŸŒŸ ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾! Ğ’Ñ‹ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ!\n\nĞ¥Ğ¾Ñ‚Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ğ”ĞµĞ½ÑŒ 4?",
          reply_markup: day_4_final_completion_markup
        )
      end
      
      def complete_exercise
        observation_time = get_day_data('observation_time') || 3
        selected_technique = get_day_data('selected_technique') || {}
        
        # ĞÑ‚Ğ¼ĞµÑ‡Ğ°ĞµĞ¼ Ğ´ĞµĞ½ÑŒ ĞºĞ°Ğº Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ğ¹ Ğ² Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğµ
        @user.complete_day_program(DAY_NUMBER)
        
        # Ğ¢Ğ°ĞºĞ¶Ğµ Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑÑ‚Ğ°Ñ€Ñ‹Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ´Ğ»Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
        @user.complete_self_help_day(DAY_NUMBER)
        
        # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
        save_observation_practice_stats(observation_time, selected_technique[:name])
        
        completion_message = <<~MARKDOWN
          ğŸŠ *Ğ”ĞµĞ½ÑŒ 4 Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½!* ğŸŠ

          **Ğ’Ğ°ÑˆĞ¸ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ:**
          
          ğŸ‘ï¸ **ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ:**
          â€¢ â±ï¸ Ğ’Ñ€ĞµĞ¼Ñ: #{observation_time} Ğ¼Ğ¸Ğ½ÑƒÑ‚
          â€¢ ğŸ¨ Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ°: #{selected_technique[:name] || "Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ¿ÑÑ‚Ğ½Ğ°"}
          â€¢ ğŸ§  ĞĞ°Ğ²Ñ‹Ğº: Ğ“Ğ»ÑƒĞ±Ğ¾ĞºĞ¾Ğµ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ğµ
          â€¢ ğŸŒˆ ĞŸÑ€Ğ¸Ğ¾Ğ±Ñ€ĞµÑ‚ĞµĞ½Ğ¸Ğµ: Ğ¡Ğ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚ÑŒ Ğ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾Ğµ ĞºĞ°Ğº Ğ½ĞµĞ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾Ğµ
          
          â° **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ±ÑƒĞ´ĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ñ‡ĞµÑ€ĞµĞ· 12 Ñ‡Ğ°ÑĞ¾Ğ²**
          
          Ğ’Ğ°Ñˆ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ: #{@user.progress_percentage}%
        MARKDOWN
        
        send_message(text: completion_message, parse_mode: 'Markdown')
        
        # ĞŸÑ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµĞ¼ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ
        propose_next_day_with_restriction
      end

      def propose_next_day_with_restriction
        next_day = 5
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ»Ğ¸ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ
        can_start_result = @user.can_start_day?(next_day)
        
        if can_start_result == true
          message = <<~MARKDOWN
            ğŸ¯ **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³: Ğ”ĞµĞ½ÑŒ #{next_day}**
            
            âœ… *Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ ÑĞµĞ¹Ñ‡Ğ°Ñ!*
            
            **Ğ§Ñ‚Ğ¾ Ğ²Ğ°Ñ Ğ¶Ğ´ĞµÑ‚:**
            â€¢ ğŸµ ĞÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğµ ÑĞ»ÑƒÑˆĞ°Ğ½Ğ¸Ğµ
            â€¢ ğŸ‘‚ Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ°ÑƒĞ´Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ
            â€¢ ğŸŒ Ğ“Ğ»ÑƒĞ±Ğ¾ĞºĞ°Ñ ÑĞ²ÑĞ·ÑŒ Ñ Ğ¾ĞºÑ€ÑƒĞ¶Ğ°ÑÑ‰Ğ¸Ğ¼ Ğ¼Ğ¸Ñ€Ğ¾Ğ¼
            â€¢ ğŸ§˜ ĞœĞµĞ´Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ²ÑƒĞºĞ¸
            
            Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ¿Ñ€ÑĞ¼Ğ¾ ÑĞµĞ¹Ñ‡Ğ°Ñ.
          MARKDOWN
          
          button_text = "ğŸ‘‚ ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ”ĞµĞ½ÑŒ #{next_day}"
        else
          error_message = can_start_result.is_a?(Array) ? can_start_result.join("\n") : can_start_result
          
          message = <<~MARKDOWN
            ğŸ¯ **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³: Ğ”ĞµĞ½ÑŒ #{next_day}**
            
            â±ï¸ *ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ:* #{error_message}
            
            **ĞŸĞ¾ĞºĞ° Ğ¶Ğ´ĞµÑ‚Ğµ, Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ:**
            â€¢ ğŸ‘ï¸ ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ
            â€¢ ğŸ“ ĞŸĞ¾ÑĞºÑĞ¿ĞµÑ€Ğ¸Ğ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼Ğ¸ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ°Ğ¼Ğ¸ Ğ¸Ğ· ÑĞµĞ³Ğ¾Ğ´Ğ½ÑÑˆĞ½ĞµĞ³Ğ¾ Ğ´Ğ½Ñ
            â€¢ ğŸ¨ ĞĞ°Ñ€Ğ¸ÑĞ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ ÑÑ„Ğ¾Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚Ğ¾, Ñ‡Ñ‚Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´Ğ°Ğ»Ğ¸
            â€¢ ğŸ“Š ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ (/progress)
            
            ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ½Ğ¸Ğ¶Ğµ Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ, Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ğ»Ğ¸ ÑƒĞ¶Ğµ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ.
            Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑĞ¾Ğ¾Ğ±Ñ‰Ğ¸Ñ‚, ĞºĞ¾Ğ³Ğ´Ğ° Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ÑŒ.
          MARKDOWN
          
          button_text = "â±ï¸ ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ Ğ”Ğ½Ñ #{next_day}"
        end
        
        # ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
        send_message(text: message, parse_mode: 'Markdown')
        
        # Ğ’Ğ¡Ğ•Ğ“Ğ”Ğ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ
        send_message(
          text: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ:",
          reply_markup: {
            inline_keyboard: [
              [
                { 
                  text: button_text, 
                  callback_data: "start_day_#{next_day}_from_proposal" 
                }
              ]
            ]
          }
        )
      end
      
      def resume_session
        current_state = @user.self_help_state
        
        case current_state
        when "day_#{DAY_NUMBER}_intro"
          # Ğ•ÑĞ»Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ°Ñ‡Ğ°Ğ» Ğ´ĞµĞ½ÑŒ, Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑƒĞ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ
          deliver_exercise
        when "day_#{DAY_NUMBER}_exercise_in_progress"
          # Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ ÑˆĞ°Ğ³Ğ°
          current_step = get_day_data('current_step')
          if current_step.present?
            handle_resume_from_step(current_step)
          else
            # Ğ•ÑĞ»Ğ¸ ÑˆĞ°Ğ³ Ğ½Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½, Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ ÑƒĞ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ
            deliver_exercise
          end
        else
          # Ğ•ÑĞ»Ğ¸ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ½Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¾ Ğ¸Ğ»Ğ¸ Ğ½Ğµ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ´Ğ½Ñ 4
          log_warn("Unknown or invalid state for resume: #{current_state}")
          # ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ²Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµĞ¼ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ
          show_intro_without_state
        end
      end
      
      # ===== ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ ĞšĞĞĞŸĞĞš =====
      
      def handle_button(callback_data)
        case callback_data
        when 'start_day_4_content', 'start_day_4_from_proposal'
          deliver_exercise
          
        when 'continue_day_4_content'
          # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ğ½Ğ° ĞºĞ°ĞºĞ¾Ğ¼ ÑˆĞ°Ğ³Ğµ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ğ»ÑÑ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ
          current_step = get_day_data('current_step')
          handle_resume_from_step(current_step || 'intro')
          
        when /^day_4_technique_(\d+)$/
          handle_technique_selection($1)
          
        when /^day_4_timer_(\d+)$/
          start_observation_timer($1.to_i)
          
        when 'day_4_timer_custom'
          send_message(text: "â° Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸ (Ğ¾Ñ‚ 1 Ğ´Ğ¾ 15):")
          store_day_data('awaiting_custom_timer', true)
          
        when 'day_4_practice_complete'
          complete_practice
          
        when 'day_4_practice_restart'
          deliver_exercise
          
        when 'day_4_practice_cancel'
          send_message(
            text: "âŒ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ¿Ñ€ĞµÑ€Ğ²Ğ°Ğ½Ğ°. Ğ’Ñ‹ Ğ²ÑĞµĞ³Ğ´Ğ° Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒÑÑ Ğº Ğ½ĞµĞ¹ Ğ¿Ğ¾Ğ·Ğ¶Ğµ.",
            reply_markup: TelegramMarkupHelper.back_to_main_menu_markup
          )
          
        when /^day_4_challenge_(\d+)$/
          handle_challenge_selection($1)
          
        when 'day_4_no_challenges'
          send_message(text: "ğŸŒŸ ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾! Ğ£ Ğ²Ğ°Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ»Ğ°ÑÑŒ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ°!")
          send_message(
            text: "Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµĞ¼ Ğ”ĞµĞ½ÑŒ 4?",
            reply_markup: day_4_final_completion_markup
          )
          
        when 'day_4_complete_exercise', 'day_4_exercise_completed'
          complete_exercise
          
        when 'day_4_restart_practice'
          deliver_exercise
          
        when 'day_4_make_note'
          send_message(
            text: "ğŸ“ ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºÑƒ Ğ¾ Ğ²Ğ°ÑˆĞµĞ¹ ÑĞµĞ³Ğ¾Ğ´Ğ½ÑÑˆĞ½ĞµĞ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ:\nâ€¢ Ğ§Ñ‚Ğ¾ Ğ²Ñ‹ Ğ½Ğ°Ğ±Ğ»ÑĞ´Ğ°Ğ»Ğ¸?\nâ€¢ Ğ§Ñ‚Ğ¾ ÑƒĞ´Ğ¸Ğ²Ğ¸Ğ»Ğ¾?\nâ€¢ ĞšĞ°ĞºĞ¸Ğµ Ğ±Ñ‹Ğ»Ğ¸ Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸Ñ?"
          )
          store_day_data('awaiting_practice_note', true)
          
        when 'day_4_help_choose'
          send_message(
            text: "ğŸ¯ **Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ñƒ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ¸:**\n\nâ€¢ ĞĞ¾Ğ²Ğ¸Ñ‡ĞºĞ¸: Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ¿ÑÑ‚Ğ½Ğ°\nâ€¢ Ğ¢Ñ€ĞµĞ²Ğ¾Ğ³Ğ°/ÑÑ‚Ñ€ĞµÑÑ: Ğ’Ğ·Ğ³Ğ»ÑĞ´ Ñ€ĞµĞ±ĞµĞ½ĞºĞ°\nâ€¢ ĞšĞ¾Ğ½Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ñ†Ğ¸Ñ: ĞšĞ¾Ğ½Ñ‚ÑƒÑ€Ñ‹ Ğ¸ Ñ„Ğ¾Ñ€Ğ¼Ñ‹\nâ€¢ Ğ¢Ğ²Ğ¾Ñ€Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ±Ğ»Ğ¾Ğº: Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¿Ñ€Ğ¸Ñ€Ğ¾Ğ´Ñ‹\nâ€¢ Ğ Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ğ¸Ğµ: ĞšĞ°Ñ€Ñ‚Ğ¸Ğ½Ğ° ĞºĞ°Ğº Ğ¼ĞµĞ´Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ñ\nâ€¢ ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº Ğ² Ğ¼Ñ‹ÑĞ»ÑÑ…: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ñ‹Ğµ Ğ»Ğ¸Ğ½Ğ¸Ğ¸",
            parse_mode: 'Markdown'
          )
          
        else
          log_warn("Unknown button callback: #{callback_data}")
          send_message(text: "ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°.")
        end
      end
      
      # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ²Ğ²Ğ¾Ğ´Ğ°
      def handle_text_input(input_text)
        # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€Ğ°
        if get_day_data('awaiting_custom_timer')
          store_day_data('awaiting_custom_timer', false)
          
          minutes = input_text.to_i
          if minutes.between?(1, 15)
            start_observation_timer(minutes)
            return true
          else
            send_message(text: "âš ï¸ ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ¾Ñ‚ 1 Ğ´Ğ¾ 15.")
            return false
          end
        end
        
        # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ·Ğ°Ğ¼ĞµÑ‚ĞºĞ¸ Ğ¾ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ
        if get_day_data('awaiting_practice_note')
          store_day_data('awaiting_practice_note', false)
          store_day_data('practice_note', input_text)
          
          send_message(text: "âœ… Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ°! ĞĞ½Ğ° Ğ¿Ğ¾Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ²Ğ°Ğ¼ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ.")
          send_message(
            text: "Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµĞ¼ Ğ”ĞµĞ½ÑŒ 4?",
            reply_markup: day_4_final_completion_markup
          )
          return true
        end
        
        false
      end
      
      private
      
      # Ğ’ÑĞ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‚ĞºĞ¸
      def day_4_content_markup
        {
          inline_keyboard: [
            [
              { text: "ğŸ‘ï¸ ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ", callback_data: 'start_day_4_content' }
            ],
            [
              { text: "#{EMOJI[:back]} Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒÑÑ Ğ² Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ", callback_data: 'back_to_main_menu' }
            ]
          ]
        }.to_json
      end
      
      def day_4_observation_techniques_markup
        TelegramMarkupHelper.day_4_observation_techniques_markup
      end
      
      def day_4_observation_timer_markup
        TelegramMarkupHelper.day_4_observation_timer_markup
      end
      
      def day_4_practice_completion_markup
        TelegramMarkupHelper.day_4_practice_completion_markup
      end
      
      def day_4_challenges_markup
        TelegramMarkupHelper.day_4_challenges_markup
      end
      
      def day_4_final_completion_markup
        TelegramMarkupHelper.day_4_final_completion_markup
      end

      def show_intro_without_state
        send_message(text: DAY_STEPS['intro'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['intro'][:instruction], parse_mode: 'Markdown')
        send_message(
          text: statistics_message,
          parse_mode: 'Markdown'
        )
        send_message(
          text: "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ²Ğ¸Ğ´ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ñ… Ğ²ĞµÑ‰ĞµĞ¹?",
          reply_markup: day_4_content_markup
        )
      end
      
      def handle_resume_from_step(step)
        case step
        when 'intro'
          deliver_intro
        when 'exercise_explanation'
          deliver_exercise
        when 'practice_guidance'
          show_practice_guidance
        when 'post_practice_reflection'
          show_post_practice_reflection
        else
          deliver_intro
        end
      end
      
      def statistics_message
        <<~MARKDOWN
          ğŸ“Š *ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾ÑÑ‚ÑŒ Ñ‚Ğ°Ğº ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ°:*
          
          â€¢ ğŸ‘ï¸ **85%** â€” Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ¼Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ñ‡ĞµÑ€ĞµĞ· Ğ·Ñ€ĞµĞ½Ğ¸Ğµ
          â€¢ ğŸ§  **40%** â€” Ğ¼Ğ¾Ğ·Ğ³Ğ° Ğ²Ğ¾Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¾ Ğ² Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºÑƒ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸
          â€¢ ğŸ˜Œ **70%** â€” Ğ»ÑĞ´ĞµĞ¹ Ğ¸ÑĞ¿Ñ‹Ñ‚Ñ‹Ğ²Ğ°ÑÑ‚ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ñ€ĞµÑÑ Ğ¾Ñ‚ Ğ¿ĞµÑ€ĞµĞ³Ñ€ÑƒĞ·ĞºĞ¸
          â€¢ ğŸ¨ **60%** â€” ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ğµ Ñ‚Ğ²Ğ¾Ñ€Ñ‡ĞµÑĞºĞ¸Ñ… ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚ĞµĞ¹ Ğ¿Ğ¾ÑĞ»Ğµ Ñ€ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
          â€¢ ğŸ‘€ **50%** â€” ÑĞ½Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ Ğ½Ğ°Ğ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ñ Ğ³Ğ»Ğ°Ğ· Ğ¿Ñ€Ğ¸ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğ¼ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğ¸
          â€¢ ğŸ•°ï¸ **30%** â€” Ğ·Ğ°Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ¸Ğµ ÑÑƒĞ±ÑŠĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
          
          *Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº: Ğ˜ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ MIT, UCLA, ĞšĞµĞ¼Ğ±Ñ€Ğ¸Ğ´Ğ¶ÑĞºĞ¾Ğ³Ğ¾ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚Ğ°*
        MARKDOWN
      end
      
      def save_observation_practice_stats(practice_time, technique_name)
        begin
          # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ°
          store_day_data('observation_practice_stats', {
            date: Date.current.to_s,
            duration: practice_time,
            technique: technique_name,
            completed: true
          })
        rescue => e
          log_error("Failed to save observation practice stats", e)
        end
      end
      
      def log_error(message, error = nil)
        Rails.logger.error "[#{self.class}] #{message} - User: #{@user.telegram_id}"
        Rails.logger.error error.message if error
      end
      
      def log_warn(message)
        Rails.logger.warn "[#{self.class}] #{message} - User: #{@user.telegram_id}"
      end
    end
  end
end