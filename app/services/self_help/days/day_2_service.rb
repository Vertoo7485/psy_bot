# app/services/self_help/days/day_2_service.rb
module SelfHelp
  module Days
    class Day2Service < DayBaseService
      include TelegramMarkupHelper
      
      # ĞšĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹
      DAY_NUMBER = 2
      
      # Ğ¨Ğ°Ğ³Ğ¸ Ğ´Ğ½Ñ 2
      DAY_STEPS = {
        'intro' => {
          title: "ğŸ¯ *Ğ”ĞµĞ½ÑŒ 2: Ğ¡Ğ²ÑĞ·ÑŒ Ñ Ñ‚ĞµĞ»Ğ¾Ğ¼ Ñ‡ĞµÑ€ĞµĞ· ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ* ğŸ¯",
          instruction: <<~MARKDOWN
            **ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Ğ´Ğ»Ñ ÑĞµĞ±Ñ ÑĞ·Ñ‹Ğº ÑĞ²Ğ¾ĞµĞ³Ğ¾ Ñ‚ĞµĞ»Ğ°**
            
            Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ¼Ñ‹ Ğ±ÑƒĞ´ĞµĞ¼ ÑƒÑ‡Ğ¸Ñ‚ÑŒÑÑ ÑĞ»ÑƒÑˆĞ°Ñ‚ÑŒ Ğ¸ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ñ‚ÑŒ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ñ‹ Ñ‚ĞµĞ»Ğ° Ñ‡ĞµÑ€ĞµĞ· Ñ‚ĞµÑ…Ğ½Ğ¸ĞºÑƒ *ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµĞ»Ğ°* (body scan).

            ğŸ§  **ĞĞ°ÑƒÑ‡Ğ½Ğ°Ñ Ğ¾ÑĞ½Ğ¾Ğ²Ğ°:**
            â€¢ Ğ˜ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ÑÑ‚, Ñ‡Ñ‚Ğ¾ 70% ÑÑ‚Ñ€ĞµÑÑĞ° Ğ¿Ñ€Ğ¾ÑĞ²Ğ»ÑĞµÑ‚ÑÑ ÑĞ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ² Ñ‚ĞµĞ»Ğµ
            â€¢ Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµĞ»Ğ° ÑĞ½Ğ¸Ğ¶Ğ°ĞµÑ‚ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¼Ğ¸Ğ½Ğ´Ğ°Ğ»ĞµĞ²Ğ¸Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ñ‚ĞµĞ»Ğ° (Ñ†ĞµĞ½Ñ‚Ñ€Ğ° ÑÑ‚Ñ€Ğ°Ñ…Ğ°)
            â€¢ Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ğ²Ğ°ĞµÑ‚ ÑĞ²ÑĞ·ÑŒ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ñ€ĞµÑ„Ñ€Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ĞºĞ¾Ñ€Ğ¾Ğ¹ Ğ¸ ÑĞ¾Ğ¼Ğ°Ñ‚Ğ¾ÑĞµĞ½ÑĞ¾Ñ€Ğ½Ñ‹Ğ¼Ğ¸ Ğ·Ğ¾Ğ½Ğ°Ğ¼Ğ¸
            â€¢ Ğ£Ğ¼ĞµĞ½ÑŒÑˆĞ°ĞµÑ‚ Ñ…Ñ€Ğ¾Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ±Ğ¾Ğ»Ğ¸ Ğ¸ Ğ¼Ñ‹ÑˆĞµÑ‡Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¶Ğ¸Ğ¼Ñ‹ Ñƒ 60% Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒÑÑ‰Ğ¸Ñ…

            ğŸ’ª **Ğ§Ñ‚Ğ¾ Ğ²Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚Ğµ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ:**
            1. ğŸ” ĞĞ°Ğ²Ñ‹Ğº Ñ€Ğ°Ğ½Ğ½ĞµĞ³Ğ¾ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ ÑÑ‚Ñ€ĞµÑÑĞ°
            2. ğŸ˜Œ Ğ¡Ğ½Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ Ñ…Ñ€Ğ¾Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ¼Ñ‹ÑˆĞµÑ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ñ
            3. ğŸ§­ Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ğµ ÑĞ²ÑĞ·Ğ¸ Â«Ğ¼Ğ¾Ğ·Ğ³-Ñ‚ĞµĞ»Ğ¾Â»
            4. ğŸ›¡ï¸ Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ·ĞµĞ¼Ğ»ĞµĞ½Ğ¸Ñ

            â±ï¸ **Ğ’Ñ€ĞµĞ¼Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:** 10-15 Ğ¼Ğ¸Ğ½ÑƒÑ‚
            ğŸ¯ **Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ:** ĞŸĞ¾Ğ´Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ´Ğ»Ñ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ÑÑ‰Ğ¸Ñ…
          MARKDOWN
        },
        'preparation' => {
          title: "ğŸ›‹ï¸ *ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğº ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµĞ»Ğ°* ğŸ›‹ï¸",
          instruction: <<~MARKDOWN
            **ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:**

            ğŸª‘ **ĞŸĞ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞ»Ğ°:**
            â€¢ Ğ›ÑĞ³Ñ‚Ğµ Ğ½Ğ° ÑĞ¿Ğ¸Ğ½Ñƒ (Ğ½Ğ° ĞºĞ¾Ğ²Ñ€Ğ¸Ğº, ĞºÑ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ Ğ¿Ğ¾Ğ»)
            â€¢ Ğ ÑƒĞºĞ¸ Ğ²Ğ´Ğ¾Ğ»ÑŒ Ñ‚ĞµĞ»Ğ°, Ğ»Ğ°Ğ´Ğ¾Ğ½ÑĞ¼Ğ¸ Ğ²Ğ²ĞµÑ€Ñ… Ğ¸Ğ»Ğ¸ Ğ²Ğ½Ğ¸Ğ·
            â€¢ ĞĞ¾Ğ³Ğ¸ Ğ½Ğ° ÑˆĞ¸Ñ€Ğ¸Ğ½Ğµ Ğ¿Ğ»ĞµÑ‡, Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ñ‹
            â€¢ ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ´ÑƒÑˆĞºÑƒ Ğ¿Ğ¾Ğ´ Ğ³Ğ¾Ğ»Ğ¾Ğ²Ñƒ Ğ¸ ĞºĞ¾Ğ»ĞµĞ½Ğ¸

            â° **Ğ’Ñ€ĞµĞ¼Ñ Ğ¸ Ğ¼ĞµÑÑ‚Ğ¾:**
            â€¢ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ²Ñ€ĞµĞ¼Ñ, ĞºĞ¾Ğ³Ğ´Ğ° Ğ²Ğ°Ñ Ğ½Ğµ Ğ¿Ğ¾Ğ±ĞµÑĞ¿Ğ¾ĞºĞ¾ÑÑ‚ 10-15 Ğ¼Ğ¸Ğ½ÑƒÑ‚
            â€¢ ĞÑ‚ĞºĞ»ÑÑ‡Ğ¸Ñ‚Ğµ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğµ
            â€¢ Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ Ğ² ĞºĞ¾Ğ¼Ñ„Ğ¾Ñ€Ñ‚Ğ½Ğ¾Ğ¹ Ñ‚ĞµĞ¼Ğ¿ĞµÑ€Ğ°Ñ‚ÑƒÑ€Ğµ (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑƒĞºÑ€Ñ‹Ñ‚ÑŒÑÑ Ğ¿Ğ»ĞµĞ´Ğ¾Ğ¼)
            â€¢ ĞŸÑ€Ğ¸Ğ³Ğ»ÑƒÑˆĞµĞ½Ğ½Ñ‹Ğ¹ ÑĞ²ĞµÑ‚ Ğ¸Ğ»Ğ¸ Ñ‚ĞµĞ¼Ğ½Ğ¾Ñ‚Ğ° Ğ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°ÑÑ‚ ĞºĞ¾Ğ½Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸

            ğŸ§˜ **Ğ”Ñ‹Ñ…Ğ°Ğ½Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞ´ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾Ğ¼:**
            1. Ğ¡Ğ´ĞµĞ»Ğ°Ğ¹Ñ‚Ğµ 3 Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ñ… Ğ²Ğ´Ğ¾Ñ…Ğ° Ğ¸ Ğ²Ñ‹Ğ´Ğ¾Ñ…Ğ°
            2. ĞŸĞ¾Ñ‡ÑƒĞ²ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚ Ñ‚ĞµĞ»Ğ° Ñ Ğ¿Ğ¾Ğ²ĞµÑ€Ñ…Ğ½Ğ¾ÑÑ‚ÑŒÑ
            3. ĞÑ‚Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ğ²ÑĞµ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¾Ñ‚ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
            4. ĞŸÑ€Ğ¸Ğ¼Ğ¸Ñ‚Ğµ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºÑƒ Ğ½Ğ°Ğ±Ğ»ÑĞ´Ğ°Ñ‚ĞµĞ»Ñ: Â«Ğ¯ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ñ, Ñ‡Ñ‚Ğ¾ ĞµÑÑ‚ÑŒÂ»

            **Ğ’Ğ°Ğ¶Ğ½Ğ¾:** ĞĞµÑ‚ Â«Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¹Â» Ğ¸Ğ»Ğ¸ Â«Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¹Â» Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸. Ğ”Ğ°Ğ¶Ğµ ĞµÑĞ»Ğ¸ ÑƒĞ¼ Ñ‡Ğ°ÑÑ‚Ğ¾ Ğ¾Ñ‚Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ÑÑ â€” ÑÑ‚Ğ¾ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾!
          MARKDOWN
        },
        'instruction' => {
          title: "ğŸ§­ *ĞšĞ°Ğº Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑÑ‚ÑŒ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµĞ»Ğ°* ğŸ§­",
          instruction: <<~MARKDOWN
            **ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ğ¾Ğµ Ñ€ÑƒĞºĞ¾Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ğ¾:**

            ğŸ¯ **ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿:** ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ğ¾Ğµ Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾ Ğ²ÑĞµĞ¼Ñƒ Ñ‚ĞµĞ»Ñƒ, Ñ‡Ğ°ÑÑ‚ÑŒ Ğ·Ğ° Ñ‡Ğ°ÑÑ‚ÑŒÑ.

            ğŸ”„ **ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
            1. ĞœĞ°ĞºÑƒÑˆĞºĞ° Ğ³Ğ¾Ğ»Ğ¾Ğ²Ñ‹ â†’ Ğ»Ğ¾Ğ± â†’ Ğ»Ğ¸Ñ†Ğ¾
            2. Ğ¨ĞµÑ â†’ Ğ¿Ğ»ĞµÑ‡Ğ¸ â†’ Ğ²ĞµÑ€Ñ…Ğ½ÑÑ Ñ‡Ğ°ÑÑ‚ÑŒ ÑĞ¿Ğ¸Ğ½Ñ‹
            3. Ğ ÑƒĞºĞ¸ (Ğ¿Ğ»ĞµÑ‡Ğ¸ â†’ Ğ»Ğ¾ĞºÑ‚Ğ¸ â†’ Ğ·Ğ°Ğ¿ÑÑÑ‚ÑŒÑ â†’ ĞºĞ¸ÑÑ‚Ğ¸ â†’ Ğ¿Ğ°Ğ»ÑŒÑ†Ñ‹)
            4. Ğ“Ñ€ÑƒĞ´Ğ½Ğ°Ñ ĞºĞ»ĞµÑ‚ĞºĞ° â†’ Ğ¶Ğ¸Ğ²Ğ¾Ñ‚ â†’ Ğ¿Ğ¾ÑÑĞ½Ğ¸Ñ†Ğ°
            5. Ğ¢Ğ°Ğ· â†’ ÑĞ³Ğ¾Ğ´Ğ¸Ñ†Ñ‹ â†’ Ğ±ĞµĞ´Ñ€Ğ° â†’ ĞºĞ¾Ğ»ĞµĞ½Ğ¸
            6. Ğ“Ğ¾Ğ»ĞµĞ½Ğ¸ â†’ Ğ»Ğ¾Ğ´Ñ‹Ğ¶ĞºĞ¸ â†’ ÑÑ‚Ğ¾Ğ¿Ñ‹ â†’ Ğ¿Ğ°Ğ»ÑŒÑ†Ñ‹ Ğ½Ğ¾Ğ³

            ğŸ¨ **Ğ§Ñ‚Ğ¾ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ñ‚ÑŒ Ğ² ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ñ‡Ğ°ÑÑ‚Ğ¸:**
            â€¢ ğŸŒ¡ï¸ Ğ¢ĞµĞ¼Ğ¿ĞµÑ€Ğ°Ñ‚ÑƒÑ€Ğ° (Ñ‚ĞµĞ¿Ğ»Ğ¾/Ñ…Ğ¾Ğ»Ğ¾Ğ´/Ğ½ĞµĞ¹Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ğ¾)
            â€¢ ğŸ’ª ĞĞ°Ğ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ğµ/Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ğ¸Ğµ
            â€¢ âš–ï¸ Ğ’ĞµÑ/Ğ»ĞµĞ³ĞºĞ¾ÑÑ‚ÑŒ
            â€¢ ğŸŒŠ ĞŸÑƒĞ»ÑŒÑĞ°Ñ†Ğ¸Ñ/Ğ²Ğ¸Ğ±Ñ€Ğ°Ñ†Ğ¸Ñ/Ğ¿Ğ¾ĞºĞ°Ğ»Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ
            â€¢ ğŸ•³ï¸ ĞÑ‰ÑƒÑ‰ĞµĞ½Ğ¸Ğµ Ğ¿ÑƒÑÑ‚Ğ¾Ñ‚Ñ‹/Ğ½Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸

            ğŸ§  **Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ÑƒĞ¼Ğ°:**
            â€¢ ĞĞµ Ğ¿Ñ‹Ñ‚Ğ°Ğ¹Ñ‚ĞµÑÑŒ Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ
            â€¢ ĞĞµ Ğ¾Ñ†ĞµĞ½Ğ¸Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸Ñ ĞºĞ°Ğº Â«Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¸ĞµÂ» Ğ¸Ğ»Ğ¸ Â«Ğ¿Ğ»Ğ¾Ñ…Ğ¸ĞµÂ»
            â€¢ Ğ•ÑĞ»Ğ¸ ÑƒĞ¼ Ğ¾Ñ‚Ğ²Ğ»ĞµĞºÑÑ â€” Ğ¼ÑĞ³ĞºĞ¾ Ğ²ĞµÑ€Ğ½Ğ¸Ñ‚Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğº Ñ‚ĞµĞ»Ñƒ
            â€¢ ĞšĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ â€” ÑÑ‚Ğ¾ ÑƒÑĞ¿ĞµÑ… Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸!
          MARKDOWN
        },
        'reflection' => {
          title: "ğŸ“ *Ğ ĞµÑ„Ğ»ĞµĞºÑĞ¸Ñ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸* ğŸ“",
          instruction: <<~MARKDOWN
            **ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°! Ğ’Ñ‹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»Ğ¸ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµĞ»Ğ°!** ğŸŒŸ

            **Ğ’Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ´Ğ»Ñ ÑĞ°Ğ¼Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°:**

            ğŸŒ¡ï¸ **1. Ğ Ñ‚ĞµĞ»ĞµÑĞ½Ñ‹Ñ… Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸ÑÑ…:**
            â€¢ ĞšĞ°ĞºĞ¸Ğµ Ñ‡Ğ°ÑÑ‚Ğ¸ Ñ‚ĞµĞ»Ğ° Ğ¾Ñ‰ÑƒÑ‰Ğ°Ğ»Ğ¸ÑÑŒ Ğ½Ğ°Ğ¸Ğ±Ğ¾Ğ»ĞµĞµ ÑÑĞ½Ğ¾?
            â€¢ Ğ‘Ñ‹Ğ»Ğ¸ Ğ»Ğ¸ Ğ·Ğ¾Ğ½Ñ‹ Ğ½ĞµĞ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ñ Ğ¸Ğ»Ğ¸ Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ğ¸Ñ?
            â€¢ Ğ—Ğ°Ğ¼ĞµÑ‚Ğ¸Ğ»Ğ¸ Ğ»Ğ¸ Ğ²Ñ‹ Ñ€Ğ°Ğ·Ğ½Ğ¸Ñ†Ñƒ Ñ‚ĞµĞ¼Ğ¿ĞµÑ€Ğ°Ñ‚ÑƒÑ€Ñ‹ Ğ² Ñ€Ğ°Ğ·Ğ½Ñ‹Ñ… Ñ‡Ğ°ÑÑ‚ÑÑ… Ñ‚ĞµĞ»Ğ°?

            ğŸ§  **2. ĞĞ± ÑƒĞ¼Ğµ Ğ¸ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğ¸:**
            â€¢ ĞšĞ°Ğº Ñ‡Ğ°ÑÑ‚Ğ¾ ÑƒĞ¼ Ğ¾Ñ‚Ğ²Ğ»ĞµĞºĞ°Ğ»ÑÑ Ğ¾Ñ‚ Ñ‚ĞµĞ»Ğ°?
            â€¢ ĞšÑƒĞ´Ğ° Ñ‡Ğ°Ñ‰Ğµ Ğ²ÑĞµĞ³Ğ¾ ÑƒĞ±ĞµĞ³Ğ°Ğ»Ğ¸ Ğ¼Ñ‹ÑĞ»Ğ¸?
            â€¢ ĞšĞ°Ğº Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾ Ğ²Ñ‹ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ğ»Ğ¸, Ñ‡Ñ‚Ğ¾ Ğ¾Ñ‚Ğ²Ğ»ĞµĞºĞ»Ğ¸ÑÑŒ?

            âš¡ **3. Ğ ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑÑ… Ğ¸ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ¸ÑÑ…:**
            â€¢ Ğ§Ñ‚Ğ¾ Ğ±Ñ‹Ğ»Ğ¾ ÑĞ°Ğ¼Ñ‹Ğ¼ Ğ»ĞµĞ³ĞºĞ¸Ğ¼ Ğ² Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ?
            â€¢ Ğ§Ñ‚Ğ¾ Ğ¾ĞºĞ°Ğ·Ğ°Ğ»Ğ¾ÑÑŒ ÑĞ°Ğ¼Ñ‹Ğ¼ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ğ¼?
            â€¢ ĞšĞ°Ğº Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»Ğ¾ÑÑŒ Ğ²Ğ°ÑˆĞµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¾Ñ‚ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğº ĞºĞ¾Ğ½Ñ†Ñƒ?

            ğŸ’­ **4. Ğ”Ğ»Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ² Ğ¶Ğ¸Ğ·Ğ½ÑŒ:**
            â€¢ Ğ’ ĞºĞ°ĞºĞ¸Ğµ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ñ‹ Ğ´Ğ½Ñ Ğ¼Ğ¾Ğ³Ğ»Ğ¾ Ğ±Ñ‹ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğµ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ?
            â€¢ ĞšĞ°ĞºĞ¸Ğµ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ñ‹ Ñ‚ĞµĞ»Ğ° Ğ²Ñ‹ Ñ…Ğ¾Ñ‚ĞµĞ»Ğ¸ Ğ±Ñ‹ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ñ‚ÑŒ Ñ‡Ğ°Ñ‰Ğµ?
            â€¢ ĞšĞ°ĞºÑƒÑ Ğ¾Ğ´Ğ½Ñƒ Ñ‡Ğ°ÑÑ‚ÑŒ Ñ‚ĞµĞ»Ğ° Ğ²Ñ‹ Ğ±Ñ‹ Ğ²Ğ·ÑĞ»Ğ¸ Â«Ğ½Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Â» Ğ·Ğ°Ğ²Ñ‚Ñ€Ğ°?

            **Ğ—Ğ°Ğ¿Ğ¾Ğ¼Ğ½Ğ¸Ñ‚Ğµ:** ĞÑ‚Ğ²ĞµÑ‚Ñ‹ Ğ½ÑƒĞ¶Ğ½Ñ‹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ²Ğ°Ğ¼. ĞĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¸Ğ»Ğ¸ Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸Ğ¹!
          MARKDOWN
        }
      }.freeze
      
      # Ğ¢Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ² ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¸ Ñ‚ĞµĞ»Ğ°
      COMMON_CHALLENGES = [
        {
          challenge: "Ğ—Ğ°ÑÑ‹Ğ¿Ğ°Ñ Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸",
          emoji: "ğŸ˜´",
          solution: "Ğ­Ñ‚Ğ¾ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾! Ğ¢ĞµĞ»Ğ¾ Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ÑĞµÑ‚ÑÑ. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞ¸Ğ´Ñ Ğ¸Ğ»Ğ¸ Ğ² Ğ±Ğ¾Ğ»ĞµĞµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ ÑÑƒÑ‚Ğ¾Ğº."
        },
        {
          challenge: "ĞĞµ Ñ‡ÑƒĞ²ÑÑ‚Ğ²ÑƒÑ Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ñ… Ñ‡Ğ°ÑÑ‚ĞµĞ¹ Ñ‚ĞµĞ»Ğ°",
          emoji: "ğŸŒ«ï¸",
          solution: "ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ Ğ·Ğ°Ğ¼ĞµÑ‚ÑŒÑ‚Ğµ ÑÑ‚Ğ¾ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸Ğ¹. Ğ˜Ğ½Ğ¾Ğ³Ğ´Ğ° Ñ‚ĞµĞ»Ğ¾ Â«Ğ¼Ğ¾Ğ»Ñ‡Ğ¸Ñ‚Â» â€” ÑÑ‚Ğ¾ Ñ‚Ğ¾Ğ¶Ğµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ."
        },
        {
          challenge: "Ğ’Ğ¾Ğ·Ğ½Ğ¸ĞºĞ°ÑÑ‚ Ğ½ĞµĞ¿Ñ€Ğ¸ÑÑ‚Ğ½Ñ‹Ğµ Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸Ñ Ğ¸Ğ»Ğ¸ Ğ±Ğ¾Ğ»ÑŒ",
          emoji: "ğŸ˜£",
          solution: "ĞĞµ ÑƒÑĞ¸Ğ»Ğ¸Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° Ğ±Ğ¾Ğ»Ğ¸. ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°Ğ¹Ñ‚Ğµ ĞµÑ‘ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¸ Ğ¼ÑĞ³ĞºĞ¾ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¸Ñ‚Ğµ Ğº ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ¹ Ñ‡Ğ°ÑÑ‚Ğ¸ Ñ‚ĞµĞ»Ğ°."
        },
        {
          challenge: "Ğ£Ğ¼ Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚, Ğ° Ğ½Ğµ Ğ¾Ñ‰ÑƒÑ‰Ğ°ĞµÑ‚",
          emoji: "ğŸ’­",
          solution: "ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚ĞµÑÑŒ Ñ Ğ¼Ñ‹ÑĞ»ĞµĞ¹ Â«Ñ‡Ñ‚Ğ¾ ÑÑ‚Ğ¾?Â» Ğ½Ğ° Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ Â«ĞºĞ°Ğº ÑÑ‚Ğ¾ Ğ¾Ñ‰ÑƒÑ‰Ğ°ĞµÑ‚ÑÑ?Â». Ğ¯Ğ·Ñ‹Ğº Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸Ğ¹, Ğ° Ğ½Ğµ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°."
        }
      ].freeze
      
      # Ğ¡Ğ¾Ğ²ĞµÑ‚Ñ‹ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ²ÑĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾Ğ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
      DAILY_TIPS = [
        {
          tip: "ĞœĞ¸ĞºÑ€Ğ¾-ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ",
          emoji: "âš¡",
          description: "3 Ñ€Ğ°Ğ·Ğ° Ğ² Ğ´ĞµĞ½ÑŒ Ğ½Ğ° 1 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñƒ: ÑÑ‚Ğ¾Ğ¿Ñ‹ â†’ Ğ¶Ğ¸Ğ²Ğ¾Ñ‚ â†’ Ğ»Ğ¸Ñ†Ğ¾. Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ."
        },
        {
          tip: "ĞŸĞµÑ€ĞµĞ´ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ğ¼ Ñ€Ğ°Ğ·Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¾Ğ¼",
          emoji: "ğŸ’¬",
          description: "30 ÑĞµĞºÑƒĞ½Ğ´ Ğ½Ğ° Ğ¿Ğ»ĞµÑ‡Ğ¸ Ğ¸ Ğ¶Ğ¸Ğ²Ğ¾Ñ‚. Ğ¡Ğ½Ğ¸Ğ¶Ğ°ĞµÑ‚ Ñ€ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ."
        },
        {
          tip: "ĞŸÑ€Ğ¸ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ³Ğµ",
          emoji: "ğŸŒ€",
          description: "Ğ¡Ğ¾ÑÑ€ĞµĞ´Ğ¾Ñ‚Ğ¾Ñ‡ÑŒÑ‚ĞµÑÑŒ Ğ½Ğ° Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸ÑÑ… Ğ² ÑÑ‚Ğ¾Ğ¿Ğ°Ñ… Ğ¸ Ğ»Ğ°Ğ´Ğ¾Ğ½ÑÑ…. ĞŸĞ¾Ğ¼Ğ¾Ğ³Ğ°ĞµÑ‚ Ğ·Ğ°Ğ·ĞµĞ¼Ğ»Ğ¸Ñ‚ÑŒÑÑ."
        },
        {
          tip: "Ğ”Ğ»Ñ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ ÑĞ½Ğ°",
          emoji: "ğŸŒ™",
          description: "Ğ›ĞµĞ¶Ğ° Ğ² Ğ¿Ğ¾ÑÑ‚ĞµĞ»Ğ¸, Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ğ¾ Ğ¿Ñ€Ğ¾ÑĞºĞ°Ğ½Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ñ‚ĞµĞ»Ğ¾ Ğ¾Ñ‚ Ğ½Ğ¾Ğ³ Ğº Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğµ."
        }
      ].freeze
      
      # ===== ĞŸĞ£Ğ‘Ğ›Ğ˜Ğ§ĞĞ«Ğ• ĞœĞ•Ğ¢ĞĞ”Ğ« =====
      
      def deliver_intro
        send_message(text: DAY_STEPS['intro'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['intro'][:instruction], parse_mode: 'Markdown')
        
        @user.set_self_help_step("day_#{DAY_NUMBER}_intro")
        store_day_data('current_step', 'intro')
        
        send_message(
          text: "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ñ‚ÑŒÑÑ Ğº ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµĞ»Ğ°?",
          reply_markup: {
            inline_keyboard: [
              [{ text: "âœ… Ğ”Ğ°, Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµĞ¼", callback_data: "continue_day_2_content" }]
            ]
          }
        )
      end
      
      def deliver_exercise
        @user.set_self_help_step("day_#{DAY_NUMBER}_exercise_in_progress")
        store_day_data('current_step', 'preparation')
        
        send_message(text: DAY_STEPS['preparation'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['preparation'][:instruction], parse_mode: 'Markdown')
        
        send_message(
          text: "ğŸ“‹ **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ:**",
          parse_mode: 'Markdown',
          reply_markup: {
            inline_keyboard: [
              [{ text: "âœ… Ğ’ÑÑ‘ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¾", callback_data: "day_2_ready_for_instruction" }],
              [{ text: "â¸ï¸ ĞÑƒĞ¶Ğ½Ğ¾ Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ñ‚ÑŒÑÑ", callback_data: "day_2_need_more_time" }]
            ]
          }
        )
      end
      
      def show_instruction
        store_day_data('current_step', 'instruction')
        
        send_message(text: DAY_STEPS['instruction'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['instruction'][:instruction], parse_mode: 'Markdown')
        
        send_message(
          text: "ğŸ§ **Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:**",
          parse_mode: 'Markdown',
          reply_markup: {
            inline_keyboard: [
              [
                { text: "ğŸµ ĞÑƒĞ´Ğ¸Ğ¾-Ğ¼ĞµĞ´Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ñ", callback_data: "day_2_audio_meditation" },
                { text: "ğŸ“ Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ", callback_data: "day_2_text_version" }
              ],
              [
                { text: "â“ Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° ÑĞ¾Ğ²ĞµÑ‚Ñ‹", callback_data: "day_2_show_tips_first" }
              ]
            ]
          }
        )
      end
      
      def start_audio_meditation
        store_day_data('practice_format', 'audio')
        
        # ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ°ÑƒĞ´Ğ¸Ğ¾
        audio_sent = send_body_scan_audio
        
        if audio_sent
          send_message(
            text: "ğŸµ *ĞÑƒĞ´Ğ¸Ğ¾-Ğ¼ĞµĞ´Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ°!* ğŸµ\n\nĞ¡Ğ»ĞµĞ´ÑƒĞ¹Ñ‚Ğµ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸ÑĞ¼ Ğ² Ğ°ÑƒĞ´Ğ¸Ğ¾. ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ·Ğ°Ğ¹Ğ¼ĞµÑ‚ 10-15 Ğ¼Ğ¸Ğ½ÑƒÑ‚.",
            parse_mode: 'Markdown'
          )
        else
          send_message(
            text: "âš ï¸ *ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ°ÑƒĞ´Ğ¸Ğ¾* âš ï¸\n\nĞ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²ÑƒÑ Ğ²ĞµÑ€ÑĞ¸Ñ:",
            parse_mode: 'Markdown'
          )
          show_text_meditation
          return
        end
        
        send_message(
          text: "ĞšĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°ĞºĞ¾Ğ½Ñ‡Ğ¸Ñ‚Ğµ Ğ¼ĞµĞ´Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ñ, Ğ½Ğ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ:",
          reply_markup: {
            inline_keyboard: [
              [{ text: "âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»(Ğ°) Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ", callback_data: "day_2_practice_complete" }],
              [{ text: "ğŸ”„ ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ", callback_data: "day_2_repeat_instruction" }]
            ]
          }
        )
      end
      
      def show_text_meditation
        store_day_data('practice_format', 'text')
        
        text_instruction = <<~MARKDOWN
          ğŸ§˜ *Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµĞ»Ğ°* ğŸ§˜

          **ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ (10-15 Ğ¼Ğ¸Ğ½ÑƒÑ‚):**

          1. ğŸ›Œ Ğ›ÑĞ³Ñ‚Ğµ ÑƒĞ´Ğ¾Ğ±Ğ½Ğ¾, Ğ·Ğ°ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Ğ³Ğ»Ğ°Ğ·Ğ°
          2. ğŸŒ¬ï¸ 3 Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ñ… Ğ²Ğ´Ğ¾Ñ…Ğ° Ğ¸ Ğ²Ñ‹Ğ´Ğ¾Ñ…Ğ°
          3. â³ ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ...

          **ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ğ¾ Ğ¿ĞµÑ€ĞµĞ¼ĞµÑ‰Ğ°Ğ¹Ñ‚Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ:**
          
          ğŸ‘‰ **Ğ“ĞĞ›ĞĞ’Ğ (2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹):**
          â€¢ ĞœĞ°ĞºÑƒÑˆĞºĞ° â†’ Ğ»Ğ¾Ğ± â†’ Ğ±Ñ€Ğ¾Ğ²Ğ¸ â†’ Ğ³Ğ»Ğ°Ğ·Ğ°
          â€¢ Ğ©ĞµĞºĞ¸ â†’ Ğ½Ğ¾Ñ â†’ Ğ³ÑƒĞ±Ñ‹ â†’ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğ´Ğ¾Ğº
          â€¢ Ğ£ÑˆĞ¸ â†’ Ğ·Ğ°Ñ‚Ñ‹Ğ»Ğ¾Ğº â†’ Ğ²ÑÑ Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ° Ñ†ĞµĞ»Ğ¸ĞºĞ¾Ğ¼
          
          ğŸ‘‰ **Ğ¨Ğ•Ğ¯ Ğ˜ ĞŸĞ›Ğ•Ğ§Ğ˜ (2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹):**
          â€¢ ĞŸĞµÑ€ĞµĞ´Ğ½ÑÑ Ñ‡Ğ°ÑÑ‚ÑŒ ÑˆĞµĞ¸ â†’ Ğ·Ğ°Ğ´Ğ½ÑÑ
          â€¢ Ğ›ĞµĞ²Ğ¾Ğµ Ğ¿Ğ»ĞµÑ‡Ğ¾ â†’ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğµ Ğ¿Ğ»ĞµÑ‡Ğ¾
          â€¢ Ğ’ĞµÑ€Ñ…Ğ½ÑÑ Ñ‡Ğ°ÑÑ‚ÑŒ ÑĞ¿Ğ¸Ğ½Ñ‹ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ»Ğ¾Ğ¿Ğ°Ñ‚Ğ¾Ğº
          
          ğŸ‘‰ **Ğ Ğ£ĞšĞ˜ (3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹):**
          â€¢ ĞŸĞ»ĞµÑ‡Ğ¸ â†’ Ğ»Ğ¾ĞºÑ‚Ğ¸ â†’ Ğ¿Ñ€ĞµĞ´Ğ¿Ğ»ĞµÑ‡ÑŒÑ
          â€¢ Ğ—Ğ°Ğ¿ÑÑÑ‚ÑŒÑ â†’ Ğ»Ğ°Ğ´Ğ¾Ğ½Ğ¸ â†’ Ğ¿Ğ°Ğ»ÑŒÑ†Ñ‹
          â€¢ ĞĞ±Ñ€Ğ°Ñ‚Ğ¸Ñ‚Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ: Ğ»ĞµĞ²Ğ°Ñ Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ°Ñ Ñ€ÑƒĞºĞ° Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ¾Ñ‰ÑƒÑ‰Ğ°Ñ‚ÑŒÑÑ Ğ¿Ğ¾-Ñ€Ğ°Ğ·Ğ½Ğ¾Ğ¼Ñƒ
          
          ğŸ‘‰ **Ğ¢ĞĞ Ğ¡ (2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹):**
          â€¢ Ğ“Ñ€ÑƒĞ´Ğ½Ğ°Ñ ĞºĞ»ĞµÑ‚ĞºĞ° â†’ Ğ¶Ğ¸Ğ²Ğ¾Ñ‚
          â€¢ ĞŸĞ¾ÑÑĞ½Ğ¸Ñ†Ğ° â†’ Ğ±Ğ¾ĞºĞ°
          â€¢ Ğ”Ñ‹Ñ…Ğ°Ğ½Ğ¸Ğµ: ĞºĞ°Ğº Ğ´Ğ²Ğ¸Ğ¶ĞµÑ‚ÑÑ Ñ‚ĞµĞ»Ğ¾ Ğ¿Ñ€Ğ¸ Ğ²Ğ´Ğ¾Ñ…Ğµ Ğ¸ Ğ²Ñ‹Ğ´Ğ¾Ñ…Ğµ?
          
          ğŸ‘‰ **ĞĞĞ“Ğ˜ (3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹):**
          â€¢ Ğ‘ĞµĞ´Ñ€Ğ° â†’ ĞºĞ¾Ğ»ĞµĞ½Ğ¸ â†’ Ğ³Ğ¾Ğ»ĞµĞ½Ğ¸
          â€¢ Ğ›Ğ¾Ğ´Ñ‹Ğ¶ĞºĞ¸ â†’ ÑÑ‚Ğ¾Ğ¿Ñ‹ â†’ Ğ¿Ğ°Ğ»ÑŒÑ†Ñ‹ Ğ½Ğ¾Ğ³
          â€¢ Ğ’ĞµÑ Ğ½Ğ¾Ğ³ Ğ½Ğ° Ğ¿Ğ¾Ğ²ĞµÑ€Ñ…Ğ½Ğ¾ÑÑ‚Ğ¸
          
          ğŸ‘‰ **Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ˜Ğ• (1 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°):**
          â€¢ Ğ’ÑĞµ Ñ‚ĞµĞ»Ğ¾ Ñ†ĞµĞ»Ğ¸ĞºĞ¾Ğ¼ ĞºĞ°Ğº ĞµĞ´Ğ¸Ğ½Ğ¾Ğµ Ñ†ĞµĞ»Ğ¾Ğµ
          â€¢ ĞĞ±Ñ‰ĞµĞµ Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ñ
          â€¢ ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ğ¾ Ğ¾Ñ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Ğ³Ğ»Ğ°Ğ·Ğ°

          â±ï¸ **ĞĞµ Ñ‚Ğ¾Ñ€Ğ¾Ğ¿Ğ¸Ñ‚ĞµÑÑŒ!** Ğ›ÑƒÑ‡ÑˆĞµ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½ĞµĞµ, Ğ½Ğ¾ Ñ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ¸ĞµĞ¼.
        MARKDOWN
        
        send_message(text: text_instruction, parse_mode: 'Markdown')
        
        send_message(
          text: "ĞšĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°ĞºĞ¾Ğ½Ñ‡Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ, Ğ½Ğ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ:",
          reply_markup: {
            inline_keyboard: [
              [{ text: "âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»(Ğ°) Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ", callback_data: "day_2_practice_complete" }],
              [{ text: "â° Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€", callback_data: "day_2_set_timer" }]
            ]
          }
        )
      end
      
      def show_reflection
        store_day_data('current_step', 'reflection')
        
        send_message(text: DAY_STEPS['reflection'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['reflection'][:instruction], parse_mode: 'Markdown')
        
        # Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ´Ğ»Ñ Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚ĞµĞ¹ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸
        challenge_buttons = COMMON_CHALLENGES.each_with_index.map do |challenge, index|
          [{ text: "#{challenge[:emoji]} #{challenge[:challenge]}", callback_data: "day_2_challenge_#{index}" }]
        end
        
        challenge_buttons << [{ text: "âœ… ĞĞ¸ĞºĞ°ĞºĞ¸Ñ… Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚ĞµĞ¹", callback_data: "day_2_no_challenges" }]
        
        send_message(
          text: "ğŸ¤” *Ğ¡ ĞºĞ°ĞºĞ¸Ğ¼Ğ¸ Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚ÑĞ¼Ğ¸ ÑÑ‚Ğ¾Ğ»ĞºĞ½ÑƒĞ»Ğ¸ÑÑŒ?*",
          parse_mode: 'Markdown',
          reply_markup: { inline_keyboard: challenge_buttons }
        )
      end
      
      def handle_challenge_selection(challenge_index)
        challenge = COMMON_CHALLENGES[challenge_index.to_i]
        
        if challenge
          send_message(
            text: "ğŸ’¡ **#{challenge[:challenge]}**\n\n#{challenge[:solution]}",
            parse_mode: 'Markdown'
          )
        end
        
        show_daily_tips
      end
      
      def show_daily_tips
        tips_text = <<~MARKDOWN
          ğŸ¯ *ĞšĞ°Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµĞ»Ğ° Ğ² Ğ¿Ğ¾Ğ²ÑĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾Ğ¹ Ğ¶Ğ¸Ğ·Ğ½Ğ¸:*

          Ğ’Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾ÑÑ‚Ñ‹Ğµ ÑĞ¿Ğ¾ÑĞ¾Ğ±Ñ‹ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ² Ğ²Ğ°Ñˆ Ğ´ĞµĞ½ÑŒ:
        MARKDOWN
        
        send_message(text: tips_text, parse_mode: 'Markdown')
        
        DAILY_TIPS.each do |tip|
          send_message(
            text: "#{tip[:emoji]} **#{tip[:tip]}**\n#{tip[:description]}",
            parse_mode: 'Markdown'
          )
        end
        
        send_message(
          text: "ğŸŒŸ ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾! Ğ’Ñ‹ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»Ğ¸ Ğ”ĞµĞ½ÑŒ 2!\n\nĞ—Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµĞ¼ Ğ´ĞµĞ½ÑŒ?",
          reply_markup: {
            inline_keyboard: [
              [{ text: "âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ğ”ĞµĞ½ÑŒ 2", callback_data: "day_2_complete_exercise" }],
              [{ text: "ğŸ“ Ğ¡Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºÑƒ", callback_data: "day_2_make_note" }],
              [{ text: "ğŸ”„ ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ", callback_data: "day_2_restart_practice" }]
            ]
          }
        )
      end
      
      def complete_exercise
        # ĞÑ‚Ğ¼ĞµÑ‡Ğ°ĞµĞ¼ Ğ´ĞµĞ½ÑŒ ĞºĞ°Ğº Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ğ¹
        @user.complete_self_help_day(DAY_NUMBER)
        
        completion_message = <<~MARKDOWN
          ğŸ‰ *Ğ”ĞµĞ½ÑŒ 2 Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½!* ğŸ‰

          **Ğ’Ñ‹ Ğ¾ÑĞ²Ğ¾Ğ¸Ğ»Ğ¸:**
          â€¢ ğŸ§˜ Ğ¢ĞµÑ…Ğ½Ğ¸ĞºÑƒ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµĞ»Ğ°
          â€¢ ğŸ” ĞĞ°Ğ²Ñ‹Ğº Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµĞ»ĞµÑĞ½Ñ‹Ñ… ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ¾Ğ²
          â€¢ ğŸ˜Œ Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ğ¸Ñ
          
          â° **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ±ÑƒĞ´ĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ñ‡ĞµÑ€ĞµĞ· 12 Ñ‡Ğ°ÑĞ¾Ğ²**
          
          *Ğ¡Ğ¾Ğ²ĞµÑ‚:* ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ²ĞµÑ‡ĞµÑ€Ğ¾Ğ¼ Ğ¿ĞµÑ€ĞµĞ´ ÑĞ½Ğ¾Ğ¼ Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ 3-Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ½Ñ‹Ğ¹ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ.
        MARKDOWN
        
        send_message(text: completion_message, parse_mode: 'Markdown')
        
        # ĞŸÑ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµĞ¼ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ
        propose_next_day_with_restriction
      end
      
      def resume_session
        current_state = @user.self_help_state
        
        case current_state
        when "day_2_intro"
          deliver_intro
        when "day_2_exercise_in_progress"
          current_step = get_day_data('current_step')
          handle_resume_from_step(current_step || 'preparation')
        else
          super
        end
      end
      
      # ===== ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ ĞšĞĞĞŸĞĞš =====
      
      def handle_button(callback_data)
        case callback_data
        when 'continue_day_2_content', 'start_day_2_from_proposal'
          deliver_exercise
          
        when 'day_2_skip_to_preparation'
          show_instruction
          
        when 'day_2_ready_for_instruction'
          show_instruction
          
        when 'day_2_need_more_time'
          send_message(
            text: "â±ï¸ *Ğ’Ğ¾Ğ·ÑŒĞ¼Ğ¸Ñ‚Ğµ Ğ²Ñ€ĞµĞ¼Ñ Ğ½Ğ° Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºÑƒ*\n\nĞšĞ¾Ğ³Ğ´Ğ° Ğ±ÑƒĞ´ĞµÑ‚Ğµ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹, Ğ½Ğ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ:",
            parse_mode: 'Markdown',
            reply_markup: {
              inline_keyboard: [
                [{ text: "âœ… Ğ“Ğ¾Ñ‚Ğ¾Ğ²(Ğ°) Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ÑŒ", callback_data: "day_2_ready_for_instruction" }]
              ]
            }
          )
          
        when 'day_2_audio_meditation'
          start_audio_meditation
          
        when 'day_2_text_version'
          show_text_meditation
          
        when 'day_2_show_tips_first'
          show_common_tips
          
        when 'day_2_practice_complete'
          show_reflection
          
        when 'day_2_repeat_instruction'
          show_instruction
          
        when 'day_2_set_timer'
          send_message(
            text: "â° Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€ Ğ½Ğ° 10-15 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ½Ğ° Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğµ Ğ¸Ğ»Ğ¸ ÑƒĞ¼Ğ½Ñ‹Ñ… Ñ‡Ğ°ÑĞ°Ñ….",
            reply_markup: {
              inline_keyboard: [
                [{ text: "âœ… Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½", callback_data: "day_2_timer_set" }]
              ]
            }
          )
          
        when 'day_2_timer_set'
          show_text_meditation
          
        when /^day_2_challenge_(\d+)$/
          handle_challenge_selection($1)
          
        when 'day_2_no_challenges'
          show_daily_tips
          
        when 'day_2_complete_exercise'
          complete_exercise
          
        when 'day_2_make_note'
          send_message(text: "ğŸ“ ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºÑƒ Ğ¾ Ğ²Ğ°ÑˆĞµĞ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ² ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğµ):")
          store_day_data('awaiting_practice_note', true)
          
        when 'day_2_restart_practice'
          deliver_exercise
          
        else
          log_warn("Unknown button callback: #{callback_data}")
          send_message(text: "ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ¼ĞµĞ½Ñ.")
        end
      end
      
      # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ²Ğ²Ğ¾Ğ´Ğ° (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¼ĞµÑ‚Ğ¾Ğº)
      def handle_text_input(input_text)
        if get_day_data('awaiting_practice_note')
          store_day_data('awaiting_practice_note', false)
          
          send_message(text: "ğŸ“ *Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ°!*\n\nĞ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ğ·Ğ° Ñ€ĞµÑ„Ğ»ĞµĞºÑĞ¸Ñ.", parse_mode: 'Markdown')
          
          send_message(
            text: "Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµĞ¼ Ğ”ĞµĞ½ÑŒ 2?",
            reply_markup: {
              inline_keyboard: [
                [{ text: "âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ğ”ĞµĞ½ÑŒ 2", callback_data: "day_2_complete_exercise" }]
              ]
            }
          )
          return true
        end
        
        false
      end
      
      private
      
      def handle_resume_from_step(step)
        case step
        when 'intro'
          deliver_intro
        when 'preparation'
          deliver_exercise
        when 'instruction'
          show_instruction
        when 'reflection'
          show_reflection
        else
          deliver_intro
        end
      end
      
      def send_body_scan_audio
        audio_file_path = Rails.root.join('public', 'assets', 'audio', 'body_scan.mp3')
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ°
        unless File.exist?(audio_file_path)
          log_error("Audio file not found: #{audio_file_path}")
          return false
        end
        
        begin
          @bot_service.bot.send_audio(
            chat_id: @chat_id,
            audio: File.open(audio_file_path),
            caption: "ğŸ§˜ *Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµĞ»Ğ° (10-15 Ğ¼Ğ¸Ğ½ÑƒÑ‚)* ğŸ§˜\n\nĞ¡Ğ»ĞµĞ´ÑƒĞ¹Ñ‚Ğµ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸ÑĞ¼ Ğ² Ğ°ÑƒĞ´Ğ¸Ğ¾. ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒĞ¹Ñ‚Ğµ Ğ² ÑƒĞ´Ğ¾Ğ±Ğ½Ğ¾Ğ¼ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸.",
            parse_mode: 'Markdown'
          )
          true
        rescue => e
          log_error("Failed to send audio", e)
          false
        end
      end
      
      def show_common_tips
        tips = <<~MARKDOWN
          ğŸ’¡ *Ğ¡Ğ¾Ğ²ĞµÑ‚Ñ‹ Ğ´Ğ»Ñ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:*

          1. ğŸ•°ï¸ **ĞĞµ ÑĞ¿ĞµÑˆĞ¸Ñ‚Ğµ** - Ğ»ÑƒÑ‡ÑˆĞµ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ğ¾Ğµ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ, Ñ‡ĞµĞ¼ Ğ±Ñ‹ÑÑ‚Ñ€Ğ°Ñ Â«Ğ¿Ñ€Ğ¾Ğ±ĞµĞ¶ĞºĞ°Â»
          2. ğŸ¯ **Ğ‘ĞµĞ· Ñ†ĞµĞ»Ğ¸** - Ğ½Ğµ ÑÑ‚Ñ€ĞµĞ¼Ğ¸Ñ‚ĞµÑÑŒ Ğº Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ğ¸Ñ, Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ğ¹Ñ‚Ğµ Ñ‡Ñ‚Ğ¾ ĞµÑÑ‚ÑŒ
          3. ğŸ”„ **Ğ”Ğ¾Ğ±Ñ€Ğ¾Ñ‚Ğ° Ğº ÑĞµĞ±Ğµ** - ĞµÑĞ»Ğ¸ ÑƒĞ¼ Ğ¾Ñ‚Ğ²Ğ»ĞµĞºÑÑ 100 Ñ€Ğ°Ğ·, Ğ²ĞµÑ€Ğ½Ğ¸Ñ‚Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ 100 Ñ€Ğ°Ğ·
          4. ğŸŒ¡ï¸ **ĞšĞ¾Ğ¼Ñ„Ğ¾Ñ€Ñ‚ Ğ¿Ñ€ĞµĞ¶Ğ´Ğµ Ğ²ÑĞµĞ³Ğ¾** - ĞµÑĞ»Ğ¸ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ½ĞµÑƒĞ´Ğ¾Ğ±Ğ½Ğ¾, Ğ¿Ğ¾Ğ¼ĞµĞ½ÑĞ¹Ñ‚Ğµ ĞµĞ³Ğ¾
          5. ğŸ§  **Ğ˜ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ, Ğ° Ğ½Ğµ ÑÑƒĞ´ÑŒÑ** - Â«Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ½Ğ¾, Ñ‡Ñ‚Ğ¾ Ñ Ñ‡ÑƒĞ²ÑÑ‚Ğ²ÑƒÑÂ» Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Â«Ñ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ñ‡ÑƒĞ²ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ñ‚ÑŒ...Â»
        MARKDOWN
        
        send_message(text: tips, parse_mode: 'Markdown')
        
        send_message(
          text: "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸?",
          reply_markup: {
            inline_keyboard: [
              [
                { text: "ğŸµ ĞÑƒĞ´Ğ¸Ğ¾-Ğ¼ĞµĞ´Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ñ", callback_data: "day_2_audio_meditation" },
                { text: "ğŸ“ Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ", callback_data: "day_2_text_version" }
              ]
            ]
          }
        )
      end
      
      def propose_next_day_with_restriction
        next_day = 3
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ»Ğ¸ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ
        can_start_result = @user.can_start_day?(next_day)
        
        if can_start_result == true
          message = <<~MARKDOWN
            ğŸ¯ **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³: Ğ”ĞµĞ½ÑŒ #{next_day}**
            
            âœ… *Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ ÑĞµĞ¹Ñ‡Ğ°Ñ!*
            
            **Ğ§Ñ‚Ğ¾ Ğ²Ğ°Ñ Ğ¶Ğ´ĞµÑ‚:**
            â€¢ ğŸ™ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ±Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ğ½Ğ¾ÑÑ‚Ğ¸
            â€¢ ğŸ“ Ğ’ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğ´Ğ½ĞµĞ²Ğ½Ğ¸ĞºĞ° Ğ±Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ğ½Ğ¾ÑÑ‚ĞµĞ¹
            â€¢ ğŸ§  ĞĞ°ÑƒÑ‡Ğ½Ñ‹Ğµ Ğ¾ÑĞ½Ğ¾Ğ²Ñ‹ Ğ²Ğ»Ğ¸ÑĞ½Ğ¸Ñ Ğ±Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ½Ğ° Ğ¼Ğ¾Ğ·Ğ³
            â€¢ ğŸ’« ĞšĞ°Ğº Ğ±Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ğµ Ğ¶Ğ¸Ğ·Ğ½Ğ¸
            
            Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ¿Ñ€ÑĞ¼Ğ¾ ÑĞµĞ¹Ñ‡Ğ°Ñ.
          MARKDOWN
          
          button_text = "ğŸš€ ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ”ĞµĞ½ÑŒ #{next_day}"
        else
          error_message = can_start_result.is_a?(Array) ? can_start_result.join("\n") : can_start_result
          
          message = <<~MARKDOWN
            ğŸ¯ **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³: Ğ”ĞµĞ½ÑŒ #{next_day}**
            
            â±ï¸ *ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ:* #{error_message}
            
            **ĞŸĞ¾ĞºĞ° Ğ¶Ğ´ĞµÑ‚Ğµ, Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ:**
            â€¢ ğŸ§˜ ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑŒ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµĞ»Ğ°
            â€¢ ğŸ“ Ğ¡Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºÑƒ Ğ¾ ÑĞµĞ³Ğ¾Ğ´Ğ½ÑÑˆĞ½ĞµĞ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ
            â€¢ ğŸ“Š ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ (/progress)
            â€¢ ğŸ˜Œ ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ (3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹)
          MARKDOWN
          
          button_text = "â±ï¸ ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ Ğ”Ğ½Ñ #{next_day}"
        end
        
        send_message(text: message, parse_mode: 'Markdown')
        
        send_message(
          text: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ:",
          reply_markup: {
            inline_keyboard: [
              [
                { text: button_text, callback_data: "start_day_#{next_day}_from_proposal" }
              ]
            ]
          }
        )
      end
      
      def log_warn(message)
        Rails.logger.warn "[#{self.class}] #{message} - User: #{@user.telegram_id}"
      end
    end
  end
end