module SelfHelp
  module Days
    class Day25Service < DayBaseService
      include TelegramMarkupHelper
      
      DAY_NUMBER = 25
      
      # –®–∞–≥–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è "–í–∏–¥ —Å–≤–µ—Ä—Ö—É"
      EXERCISE_STEPS = {
        'intro' => {
          title: "üåå **–î–µ–Ω—å 25: –°—Ç–æ–∏—á–µ—Å–∫–∏–π '–í–∏–¥ —Å–≤–µ—Ä—Ö—É' (View from Above)** üåå",
          instruction: "–°–µ–≥–æ–¥–Ω—è –º—ã –æ—Å–≤–æ–∏–º –æ–¥–Ω—É –∏–∑ —Å–∞–º—ã—Ö –º–æ—â–Ω—ã—Ö —Å—Ç–æ–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ö–Ω–∏–∫ ‚Äî *–º—ã—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –ø–æ —Å–º–µ–Ω–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã*.\n\n**–ß—Ç–æ —Ç–∞–∫–æ–µ '–í–∏–¥ —Å–≤–µ—Ä—Ö—É'?**\n–≠—Ç–æ –ø—Ä–∞–∫—Ç–∏–∫–∞, –≥–¥–µ –≤—ã –º—ã—Å–ª–µ–Ω–Ω–æ –ø–æ–¥–Ω–∏–º–∞–µ—Ç–µ—Å—å –Ω–∞–¥ —Å–≤–æ–µ–π —Å–∏—Ç—É–∞—Ü–∏–µ–π, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –µ—ë –≤ –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.\n\n**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**\n‚Ä¢ üåé **–û–±—ä–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –í–∏–¥–µ—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é –±–µ–∑ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π\n‚Ä¢ ‚è≥ **–í—Ä–µ–º–µ–Ω–Ω–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞:** –ü–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –≤–∞–∂–Ω–æ –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ\n‚Ä¢ üåü **–°–º–∏—Ä–µ–Ω–∏–µ:** –û—Å–æ–∑–Ω–∞–≤–∞—Ç—å —Å–≤–æ—ë –º–µ—Å—Ç–æ –≤–æ –≤—Å–µ–ª–µ–Ω–Ω–æ–π\n‚Ä¢ üßò **–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ:** –°–Ω–∏–∂–∞—Ç—å –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏–π\n\n**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ú—ã –±—É–¥–µ–º –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ '–æ—Ç–¥–∞–ª—è—Ç—å—Å—è' –æ—Ç –≤–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ 7 —É—Ä–æ–≤–Ω–µ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã."
        },
        'select_focus' => {
          title: "**–®–∞–≥ 1: –í—ã–±–æ—Ä —Ñ–æ–∫—É—Å–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è**",
          instruction: "–í—ã–±–µ—Ä–∏—Ç–µ **–æ–¥–Ω—É —Ç–µ–∫—É—â—É—é —Å–∏—Ç—É–∞—Ü–∏—é –∏–ª–∏ –º—ã—Å–ª—å**, –∫–æ—Ç–æ—Ä—É—é —Ö–æ—Ç–µ–ª–∏ –±—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Å –Ω–æ–≤–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã.\n\n**–ß—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ñ–æ–∫—É—Å–æ–º:**\n‚Ä¢ ü§î **–¢—Ä–µ–≤–æ–∂–Ω–∞—è –º—ã—Å–ª—å:** '–Ø –Ω–µ —Å–ø—Ä–∞–≤–ª—é—Å—å —Å –ø—Ä–æ–µ–∫—Ç–æ–º'\n‚Ä¢ üò† **–ö–æ–Ω—Ñ–ª–∏–∫—Ç:** –ù–µ–ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å –∫–æ–ª–ª–µ–≥–æ–π –∏–ª–∏ –±–ª–∏–∑–∫–∏–º\n‚Ä¢ üò∞ **–ë–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ:** –û –±—É–¥—É—â–µ–º, –∑–¥–æ—Ä–æ–≤—å–µ, —Ñ–∏–Ω–∞–Ω—Å–∞—Ö\n‚Ä¢ üòû **–°–æ–∂–∞–ª–µ–Ω–∏–µ:** –û –ø—Ä–æ—à–ª–æ–º —Ä–µ—à–µ–Ω–∏–∏\n‚Ä¢ üéØ **–¶–µ–ª—å:** –ö–æ—Ç–æ—Ä–∞—è –∫–∞–∂–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ–π\n\n**–ß–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ–µ, —Ç–µ–º –ª—É—á—à–µ.** –ß—Ç–æ –≤—ã–±–µ—Ä–µ—Ç–µ?"
        },
        'level1_room' => {
          title: "üö™ **–£—Ä–æ–≤–µ–Ω—å 1: –í–∞—à–∞ –∫–æ–º–Ω–∞—Ç–∞**",
          instruction: "–ó–∞–∫—Ä–æ–π—Ç–µ –≥–ª–∞–∑–∞ –Ω–∞ **30 —Å–µ–∫—É–Ω–¥**.\n\n–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã *–ø–∞—Ä–∏—Ç–µ –ø–æ–¥ –ø–æ—Ç–æ–ª–∫–æ–º —Å–≤–æ–µ–π –∫–æ–º–Ω–∞—Ç—ã* –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å–µ–±—è —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã.\n\n**–ß—Ç–æ –≤—ã –≤–∏–¥–∏—Ç–µ?**\n‚Ä¢ ü™ë –ì–¥–µ –≤—ã —Å–∏–¥–∏—Ç–µ/—Å—Ç–æ–∏—Ç–µ?\n‚Ä¢ üì± –ß—Ç–æ –≤–∞—Å –æ–∫—Ä—É–∂–∞–µ—Ç?\n‚Ä¢ üßç –ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –≤–∞—à–∞ –ø–æ–∑–∞, –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ª–∏—Ü–∞?\n‚Ä¢ üí≠ –ö–∞–∫–∏–µ –º—ã—Å–ª–∏ –∫—Ä—É—Ç—è—Ç—Å—è –≤ –≥–æ–ª–æ–≤–µ?\n\n**–° —ç—Ç–æ–π –≤—ã—Å–æ—Ç—ã:** –í–∞—à–∞ —Å–∏—Ç—É–∞—Ü–∏—è –≤—ã–≥–ª—è–¥–∏—Ç –±–æ–ª—å—à–µ –∏–ª–∏ –º–µ–Ω—å—à–µ?\n**–û–ø–∏—à–∏—Ç–µ —Å–≤–æ–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:**"
        },
        'level2_building' => {
          title: "üè¢ **–£—Ä–æ–≤–µ–Ω—å 2: –í–∞—à–µ –∑–¥–∞–Ω–∏–µ/–¥–æ–º**",
          instruction: "–¢–µ–ø–µ—Ä—å –ø–æ–¥–Ω–∏–º–∏—Ç–µ—Å—å –≤—ã—à–µ ‚Äî *–Ω–∞–¥ –∫—Ä—ã—à–µ–π –≤–∞—à–µ–≥–æ –¥–æ–º–∞ –∏–ª–∏ –∑–¥–∞–Ω–∏—è*.\n\n–°–º–æ—Ç—Ä–∏—Ç–µ **—Å –≤—ã—Å–æ—Ç—ã –ø—Ç–∏—á—å–µ–≥–æ –ø–æ–ª—ë—Ç–∞**:\n‚Ä¢ üè† –í–∞—à –¥–æ–º —Å—Ä–µ–¥–∏ –¥—Ä—É–≥–∏—Ö –¥–æ–º–æ–≤\n‚Ä¢ üö∂ –õ—é–¥–∏ –Ω–∞ —É–ª–∏—Ü–∞—Ö ‚Äî –∫—Ä–æ—à–µ—á–Ω—ã–µ —Ñ–∏–≥—É—Ä–∫–∏\n‚Ä¢ üöó –ú–∞—à–∏–Ω—ã ‚Äî –∫–∞–∫ –∏–≥—Ä—É—à–µ—á–Ω—ã–µ\n‚Ä¢ üå≥ –î–µ—Ä–µ–≤—å—è, –¥–≤–æ—Ä—ã\n\n**–í–∞—à–∞ –∫–æ–º–Ω–∞—Ç–∞ —Ç–µ–ø–µ—Ä—å** ‚Äî –ª–∏—à—å –º–∞–ª–µ–Ω—å–∫–∞—è —Ç–æ—á–∫–∞ –≤ —ç—Ç–æ–º –∑–¥–∞–Ω–∏–∏.\n**–í–∞—à–∏ –º—ã—Å–ª–∏ –∏ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è** ‚Äî –ª–∏—à—å —á–∞—Å—Ç—å –≤—Å–µ–≥–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —ç—Ç–æ–º –¥–æ–º–µ.\n\n**–ß—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è –≤ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–∏ —Å–∏—Ç—É–∞—Ü–∏–∏?**"
        },
        'level3_city' => {
          title: "üåÜ **–£—Ä–æ–≤–µ–Ω—å 3: –í–∞—à –≥–æ—Ä–æ–¥**",
          instruction: "–ü–æ–¥–Ω–∏–º–∞–µ–º—Å—è –µ—â—ë –≤—ã—à–µ ‚Äî *–Ω–∞–¥ –≤—Å–µ–º –≥–æ—Ä–æ–¥–æ–º*.\n\n**–°–º–æ—Ç—Ä–∏—Ç–µ –∫–∞–∫ —Å–æ —Å–ø—É—Ç–Ω–∏–∫–∞:**\n‚Ä¢ üó∫Ô∏è –†–∞–π–æ–Ω—ã, –ø–∞—Ä–∫–∏, —Ä–µ–∫–∏\n‚Ä¢ üè≠ –ó–∞–≤–æ–¥—ã, –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è\n‚Ä¢ üè• –ë–æ–ª—å–Ω–∏—Ü—ã, —à–∫–æ–ª—ã\n‚Ä¢ üèõÔ∏è –£—á—Ä–µ–∂–¥–µ–Ω–∏—è\n‚Ä¢ üë• –¢—ã—Å—è—á–∏ –ª—é–¥–µ–π, –∫–∞–∂–¥—ã–π —Å–æ —Å–≤–æ–µ–π –∂–∏–∑–Ω—å—é\n\n**–í–∞—à –¥–æ–º —Ç–µ–ø–µ—Ä—å** ‚Äî –æ–¥–Ω–∞ –∏–∑ —Ç—ã—Å—è—á —Ç–æ—á–µ–∫ –Ω–∞ –∫–∞—Ä—Ç–µ.\n**–í –≥–æ—Ä–æ–¥–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:**\n‚Ä¢ üéâ –ö—Ç–æ-—Ç–æ –ø—Ä–∞–∑–¥–Ω—É–µ—Ç —Ä–æ–∂–¥–µ–Ω–∏–µ\n‚Ä¢ üò¢ –ö—Ç–æ-—Ç–æ –≥–æ—Ä—é–µ—Ç –æ–± —É—Ç—Ä–∞—Ç–µ\n‚Ä¢ üíº –ö—Ç–æ-—Ç–æ —Å—Ç—Ä–æ–∏—Ç –±–∏–∑–Ω–µ—Å\n‚Ä¢ ‚ù§Ô∏è –ö—Ç–æ-—Ç–æ –≤–ª—é–±–ª—è–µ—Ç—Å—è\n\n**–í–∞—à–∞ —Å–∏—Ç—É–∞—Ü–∏—è –≤ –º–∞—Å—à—Ç–∞–±–µ –≥–æ—Ä–æ–¥–∞:**"
        },
        'level4_country' => {
          title: "üó∫Ô∏è **–£—Ä–æ–≤–µ–Ω—å 4: –í–∞—à–∞ —Å—Ç—Ä–∞–Ω–∞**",
          instruction: "–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤–æ—Å—Ö–æ–∂–¥–µ–Ω–∏–µ ‚Äî *–Ω–∞–¥ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–æ–π*.\n\n**–í–∏–¥–∏—Ç–µ –∫–æ–Ω—Ç—É—Ä—ã –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–∞:**\n‚Ä¢ üåÑ –ì–æ—Ä—ã, —Ä–∞–≤–Ω–∏–Ω—ã, —Ä–µ–∫–∏\n‚Ä¢ üèôÔ∏è –ú–µ–≥–∞–ø–æ–ª–∏—Å—ã –∏ –º–∞–ª–µ–Ω—å–∫–∏–µ –¥–µ—Ä–µ–≤–Ω–∏\n‚Ä¢ üõ£Ô∏è –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –∞—Ä—Ç–µ—Ä–∏–∏\n‚Ä¢ üåæ –ü–æ–ª—è, –ª–µ—Å–∞, –º–æ—Ä—è\n\n**–í–∞—à –≥–æ—Ä–æ–¥** ‚Äî –ª–∏—à—å —Ç–æ—á–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–µ —Å—Ç—Ä–∞–Ω—ã.\n**–í —Å—Ç—Ä–∞–Ω–µ –∂–∏–≤—É—Ç –º–∏–ª–ª–∏–æ–Ω—ã –ª—é–¥–µ–π**, —É –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ–∏:\n‚Ä¢ üéØ –ú–µ—á—Ç—ã –∏ —Ü–µ–ª–∏\n‚Ä¢ üòî –†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ—Ç–µ—Ä–∏\n‚Ä¢ üí™ –ü–æ–±–µ–¥—ã –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è\n‚Ä¢ üìñ –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –∂–∏–∑–Ω–∏\n\n**–ß—Ç–æ —á—É–≤—Å—Ç–≤—É–µ—Ç–µ, –≥–ª—è–¥—è —Ç–∞–∫ —à–∏—Ä–æ–∫–æ?**"
        },
        'level5_planet' => {
          title: "ü™ê **–£—Ä–æ–≤–µ–Ω—å 5: –ü–ª–∞–Ω–µ—Ç–∞ –ó–µ–º–ª—è**",
          instruction: "–¢–µ–ø–µ—Ä—å ‚Äî *–≤ –∫–æ—Å–º–æ—Å–µ*, –≥–ª—è–¥—è –Ω–∞ –≥–æ–ª—É–±–æ–π —à–∞—Ä –ó–µ–º–ª–∏.\n\n**–ó–Ω–∞–º–µ–Ω–∏—Ç—ã–π 'Blue Marble' –≤–∏–¥:**\n‚Ä¢ üåç –ö–æ–Ω—Ç–∏–Ω–µ–Ω—Ç—ã, –æ–∫–µ–∞–Ω—ã\n‚Ä¢ ‚òÅÔ∏è –û–±–ª–∞—á–Ω—ã–µ –≤–∏—Ö—Ä–∏\n‚Ä¢ üåÖ –°–º–µ–Ω–∞ –¥–Ω—è –∏ –Ω–æ—á–∏\n‚Ä¢ üåã –ü—Ä–∏—Ä–æ–¥–Ω—ã–µ —è–≤–ª–µ–Ω–∏—è\n\n**–í–∞—à–∞ —Å—Ç—Ä–∞–Ω–∞** ‚Äî —á–∞—Å—Ç—å –º–æ–∑–∞–∏–∫–∏ –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç–æ–≤.\n**–ù–∞ –ø–ª–∞–Ω–µ—Ç–µ:**\n‚Ä¢ 8 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∂–∏–∑–Ω–µ–π\n‚Ä¢ üèîÔ∏è –¢—ã—Å—è—á–∏ –∫—É–ª—å—Ç—É—Ä –∏ —è–∑—ã–∫–æ–≤\n‚Ä¢ ü¶Å –ú–∏–ª–ª–∏–æ–Ω—ã –≤–∏–¥–æ–≤ –∂–∏–≤—ã—Ö —Å—É—â–µ—Å—Ç–≤\n‚Ä¢ üí´ –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –æ–ø—ã—Ç–∞\n\n**–í–∞—à–∞ —Å–∏—Ç—É–∞—Ü–∏—è –≤ –º–∞—Å—à—Ç–∞–±–µ –ø–ª–∞–Ω–µ—Ç—ã:**"
        },
        'level6_time' => {
          title: "‚è≥ **–£—Ä–æ–≤–µ–Ω—å 6: –®–∫–∞–ª–∞ –≤—Ä–µ–º–µ–Ω–∏**",
          instruction: "–¢–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–∏–º *–≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—É*.\n\n**–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ:**\n‚Ä¢ üìú **100 –ª–µ—Ç –Ω–∞–∑–∞–¥:** –í–∞—à–∏—Ö –ø—Ä–æ–±–ª–µ–º –µ—â—ë –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–æ\n‚Ä¢ üîÆ **100 –ª–µ—Ç –≤–ø–µ—Ä–µ–¥:** –û –Ω–∏—Ö —É–∂–µ –Ω–∏–∫—Ç–æ –Ω–µ –≤—Å–ø–æ–º–Ω–∏—Ç\n‚Ä¢ ü¶ï **–î–∏–Ω–æ–∑–∞–≤—Ä—ã –∂–∏–ª–∏** 65 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –ª–µ—Ç –Ω–∞–∑–∞–¥\n‚Ä¢ üåü **–°–æ–ª–Ω—Ü–µ –±—É–¥–µ—Ç —Å–≤–µ—Ç–∏—Ç—å** –µ—â—ë 5 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –ª–µ—Ç\n‚Ä¢ üí´ **–í—Å–µ–ª–µ–Ω–Ω–∞—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç** 13.8 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –ª–µ—Ç\n\n**–í–∞—à–∞ –∂–∏–∑–Ω—å** ‚Äî –º–≥–Ω–æ–≤–µ–Ω–∏–µ –≤ —ç—Ç–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª–µ.\n**–í–∞—à–∏ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è** ‚Äî –º–∏–º–æ–ª–µ—Ç–Ω—ã–µ –≤–æ–ª–Ω—ã –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –æ–∫–µ–∞–Ω–∞ –≤—Ä–µ–º–µ–Ω–∏.\n\n**–ö–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Å–∏—Ç—É–∞—Ü–∏–∏?**"
        },
        'level7_cosmic' => {
          title: "‚ú® **–£—Ä–æ–≤–µ–Ω—å 7: –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞**",
          instruction: "–§–∏–Ω–∞–ª—å–Ω–æ–µ –≤–æ—Å—Ö–æ–∂–¥–µ–Ω–∏–µ ‚Äî *–∫ —Å–∞–º–æ–π —à–∏—Ä–æ–∫–æ–π –≤–æ–∑–º–æ–∂–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ*.\n\n**–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ:**\n‚Ä¢ üå† **–ù–∞—à–∞ –≥–∞–ª–∞–∫—Ç–∏–∫–∞** –ú–ª–µ—á–Ω—ã–π –ü—É—Ç—å: 100 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –∑–≤—ë–∑–¥\n‚Ä¢ üåÄ **–í—Å–µ–ª–µ–Ω–Ω–∞—è:** 2 —Ç—Ä–∏–ª–ª–∏–æ–Ω–∞ –≥–∞–ª–∞–∫—Ç–∏–∫\n‚Ä¢ ‚öõÔ∏è **–í—ã —Å–¥–µ–ª–∞–Ω—ã –∏–∑ –∑–≤—ë–∑–¥–Ω–æ–π –ø—ã–ª–∏** ‚Äî –∞—Ç–æ–º–æ–≤, —Ä–æ–¥–∏–≤—à–∏—Ö—Å—è –≤ –∑–≤—ë–∑–¥–∞—Ö\n‚Ä¢ üîÑ **–í—Å—ë –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è** ‚Äî –∑–≤—ë–∑–¥—ã —Ä–æ–∂–¥–∞—é—Ç—Å—è –∏ —É–º–∏—Ä–∞—é—Ç, –≥–∞–ª–∞–∫—Ç–∏–∫–∏ —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è\n‚Ä¢ ü§ù **–í—ã —Å–≤—è–∑–∞–Ω—ã —Å–æ –≤—Å–µ–º** ‚Äî —Ç–µ–º–∏ –∂–µ –∞—Ç–æ–º–∞–º–∏, —á—Ç–æ –∏ –≤ –¥–∞–ª—ë–∫–∏—Ö –∑–≤—ë–∑–¥–∞—Ö\n\n**–° —ç—Ç–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã:**\n‚Ä¢ üå± –í—ã ‚Äî —á–∞—Å—Ç—å –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–π –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π –∏—Å—Ç–æ—Ä–∏–∏\n‚Ä¢ üé≠ –í–∞—à–∞ —Å–∏—Ç—É–∞—Ü–∏—è ‚Äî –æ–¥–∏–Ω –∏–∑ –±–µ—Å—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤\n‚Ä¢ üíñ –í–∞—à–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∂–∏–≤–∞—Ç—å ‚Äî —á—É–¥–æ —Å–æ–∑–Ω–∞–Ω–∏—è –≤–æ –≤—Å–µ–ª–µ–Ω–Ω–æ–π\n\n**–ö–∞–∫–∏–µ —á—É–≤—Å—Ç–≤–∞ –∏ –º—ã—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç?**"
        },
        'integration' => {
          title: "üîÑ **–®–∞–≥ 9: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ**",
          instruction: "–¢–µ–ø–µ—Ä—å **–º–µ–¥–ª–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –æ–±—Ä–∞—Ç–Ω–æ** —á–µ—Ä–µ–∑ –≤—Å–µ —É—Ä–æ–≤–Ω–∏:\n\n1. ‚ú® **–ò–∑ –∫–æ—Å–º–æ—Å–∞** –∫ –ø–ª–∞–Ω–µ—Ç–µ –ó–µ–º–ª—è\n2. ü™ê **–° –æ—Ä–±–∏—Ç—ã** –∫ –≤–∞—à–µ–π —Å—Ç—Ä–∞–Ω–µ\n3. üó∫Ô∏è **–°–æ —Å—Ç—Ä–∞–Ω—ã** –∫ –≤–∞—à–µ–º—É –≥–æ—Ä–æ–¥—É\n4. üåÜ **–° –≥–æ—Ä–æ–¥–∞** –∫ –≤–∞—à–µ–º—É –¥–æ–º—É\n5. üè¢ **–° –∫—Ä—ã—à–∏** –≤ –≤–∞—à—É –∫–æ–º–Ω–∞—Ç—É\n6. üö™ **–í —Å–≤–æ—ë —Ç–µ–ª–æ** –∑–¥–µ—Å—å –∏ —Å–µ–π—á–∞—Å\n\n**–ü—Ä–∏–Ω–µ—Å–∏—Ç–µ —Å —Å–æ–±–æ–π** —Ç—É –º—É–¥—Ä–æ—Å—Ç—å –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—à–ª–∏ –Ω–∞–≤–µ—Ä—Ö—É.\n\n**–¢–µ–ø–µ—Ä—å, –≤–µ—Ä–Ω—É–≤—à–∏—Å—å:**\n‚Ä¢ ü§î –ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤–∞—à–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏?\n‚Ä¢ üåà –ß—Ç–æ —Å—Ç–∞–ª–æ –∫–∞–∑–∞—Ç—å—Å—è –º–µ–Ω–µ–µ –≤–∞–∂–Ω—ã–º?\n‚Ä¢ üí° –ß—Ç–æ —Å—Ç–∞–ª–æ –∫–∞–∑–∞—Ç—å—Å—è –±–æ–ª–µ–µ —Ü–µ–Ω–Ω—ã–º?\n‚Ä¢ üßò –ö–∞–∫ –≤—ã —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–∞—á–µ?"
        },
        'anchoring' => {
          title: "üéØ **–®–∞–≥ 10: –°–æ–∑–¥–∞–Ω–∏–µ —è–∫–æ—Ä—è**",
          instruction: "**–°–æ–∑–¥–∞–¥–∏–º –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –∫ —ç—Ç–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ.**\n\n**–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π '—è–∫–æ—Ä—å –≤–∏–¥–∞ —Å–≤–µ—Ä—Ö—É':**\n\n1. **–§–∏–∑–∏—á–µ—Å–∫–∏–π –∂–µ—Å—Ç:** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–Ω—è—Ç—å –≥–ª–∞–∑–∞ –∫ –Ω–µ–±—É, –≥–ª—É–±–æ–∫–æ –≤–¥–æ—Ö–Ω—É—Ç—å)\n2. **–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Ñ—Ä–∞–∑–∞:** (–Ω–∞–ø—Ä–∏–º–µ—Ä, '–≠—Ç–æ –ª–∏—à—å —Ç–æ—á–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–µ', '–í –º–∞—Å—à—Ç–∞–±–µ –≤—Å–µ–ª–µ–Ω–Ω–æ–π...')\n3. **–û–±—Ä–∞–∑-–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ:** (—Ñ–æ—Ç–æ –ó–µ–º–ª–∏ –∏–∑ –∫–æ—Å–º–æ—Å–∞, –≤–∏–¥ –∏–∑ –æ–∫–Ω–∞ —Å–∞–º–æ–ª—ë—Ç–∞)\n\n**–ü—Ä–∏–º–µ—Ä —è–∫–æ—Ä—è:**\n'–ö–æ–≥–¥–∞ —á—É–≤—Å—Ç–≤—É—é, —á—Ç–æ —Å–∏—Ç—É–∞—Ü–∏—è –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç, —Å–º–æ—Ç—Ä—é –≤ –æ–∫–Ω–æ –Ω–∞ –Ω–µ–±–æ, –≥–æ–≤–æ—Ä—é —Å–µ–±–µ \"–í–∏–¥ —Å–≤–µ—Ä—Ö—É\" –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é –Ω–∞—à—É –ø–ª–∞–Ω–µ—Ç—É –∏–∑ –∫–æ—Å–º–æ—Å–∞.'\n\n**–í–∞—à —è–∫–æ—Ä—å:**"
        },
        'summary' => {
          title: "üß† **–®–∞–≥ 11: –ò—Ç–æ–≥ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**",
          instruction: "üéä **–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!** –í—ã –æ—Å–≤–æ–∏–ª–∏ —Å—Ç–æ–∏—á–µ—Å–∫—É—é —Å—É–ø–µ—Ä—Å–∏–ª—É ‚Äî *—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–µ–Ω—è—Ç—å –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—É –ø–æ –∂–µ–ª–∞–Ω–∏—é*.\n\n**–í–∞—à –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç '–í–∏–¥ —Å–≤–µ—Ä—Ö—É' –≤–∫–ª—é—á–∞–µ—Ç:**\n\nüéØ **–ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–æ–∫—É—Å:** [–≤–∞—à–∞ —Å–∏—Ç—É–∞—Ü–∏—è]\nüåå **7 —É—Ä–æ–≤–Ω–µ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã:** –ö–æ–º–Ω–∞—Ç–∞ ‚Üí –î–æ–º ‚Üí –ì–æ—Ä–æ–¥ ‚Üí –°—Ç—Ä–∞–Ω–∞ ‚Üí –ü–ª–∞–Ω–µ—Ç–∞ ‚Üí –í—Ä–µ–º—è ‚Üí –ö–æ—Å–º–æ—Å\nüí≠ **–ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã:** [–≤–∞—à–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è]\nüéØ **–Ø–∫–æ—Ä—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:** [–≤–∞—à —è–∫–æ—Ä—å]\n\n**–ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å:**\n‚Ä¢ üåÄ **–ü—Ä–∏ –∑–∞—Ö–≤–∞—Ç–µ —ç–º–æ—Ü–∏—è–º–∏** ‚Äî —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å\n‚Ä¢ ü§Ø **–ü—Ä–∏ –æ—â—É—â–µ–Ω–∏–∏ '–∫–æ–Ω—Ü–∞ —Å–≤–µ—Ç–∞'** ‚Äî —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –º–∞—Å—à—Ç–∞–±\n‚Ä¢ üéØ **–ü—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π** ‚Äî —á—Ç–æ–±—ã —É—á–µ—Å—Ç—å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—É—é –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—É\n‚Ä¢ üòå **–î–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è** ‚Äî –∫–∞–∫ —É—Ç—Ä–µ–Ω–Ω—è—è –∏–ª–∏ –≤–µ—á–µ—Ä–Ω—è—è –ø—Ä–∞–∫—Ç–∏–∫–∞\n\n**–°—Ç–æ–∏—á–µ—Å–∫–∞—è –º—É–¥—Ä–æ—Å—Ç—å:**\n> '–®–∏—Ä–æ–∫–∏–π –≤–∑–≥–ª—è–¥ —É—Å–º–∏—Ä—è–µ—Ç –¥—É—à—É.'\n> ‚Äî –ú–∞—Ä–∫ –ê–≤—Ä–µ–ª–∏–π"
        }
      }.freeze
      
      # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–æ–∫—É—Å–∞
      FOCUS_CATEGORIES = [
        { emoji: "ü§î", name: "–¢—Ä–µ–≤–æ–∂–Ω–∞—è –º—ã—Å–ª—å", examples: ["–Ø –Ω–µ —Å–ø—Ä–∞–≤–ª—é—Å—å", "–í—Å—ë –ø–ª–æ—Ö–æ", "–ú–µ–Ω—è –æ—Å—É–¥—è—Ç"] },
        { emoji: "üò†", name: "–ö–æ–Ω—Ñ–ª–∏–∫—Ç", examples: ["–°–ø–æ—Ä —Å –∫–æ–ª–ª–µ–≥–æ–π", "–ù–µ–ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö", "–°–µ–º–µ–π–Ω—ã–π —Ä–∞–∑–ª–∞–¥"] },
        { emoji: "üò∞", name: "–ë–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ", examples: ["–û –±—É–¥—É—â–µ–º", "–û –∑–¥–æ—Ä–æ–≤—å–µ", "–û —Ñ–∏–Ω–∞–Ω—Å–∞—Ö", "–û —Ä–∞–±–æ—Ç–µ"] },
        { emoji: "üòû", name: "–°–æ–∂–∞–ª–µ–Ω–∏–µ", examples: ["–û –ø—Ä–æ—à–ª–æ–º —Ä–µ—à–µ–Ω–∏–∏", "–û–± —É–ø—É—â–µ–Ω–Ω–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏", "–û —Å–∫–∞–∑–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤–∞—Ö"] },
        { emoji: "üéØ", name: "–°–ª–æ–∂–Ω–∞—è —Ü–µ–ª—å", examples: ["–ë–æ–ª—å—à–æ–π –ø—Ä–æ–µ–∫—Ç", "–í–∞–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ", "–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏"] },
        { emoji: "üíº", name: "–†–∞–±–æ—á–∞—è —Å–∏—Ç—É–∞—Ü–∏—è", examples: ["–î–µ–¥–ª–∞–π–Ω", "–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è", "–ö–æ–Ω—Ñ–ª–∏–∫—Ç –Ω–∞ —Ä–∞–±–æ—Ç–µ", "–ö–∞—Ä—å–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä"] }
      ].freeze
      
      # –Ø–∫–æ—Ä–Ω—ã–µ –∂–µ—Å—Ç—ã –¥–ª—è –≤—ã–±–æ—Ä–∞
      ANCHOR_GESTURES = [
        { emoji: "üëÅÔ∏è", name: "–í–∑–≥–ª—è–¥ –≤–≤–µ—Ä—Ö", description: "–ü–æ–¥–Ω—è—Ç—å –≥–ª–∞–∑–∞ –∫ –Ω–µ–±—É –∏–ª–∏ –ø–æ—Ç–æ–ª–∫—É" },
        { emoji: "üå¨Ô∏è", name: "–ì–ª—É–±–æ–∫–∏–π –≤–¥–æ—Ö", description: "–°–¥–µ–ª–∞—Ç—å —Ç—Ä–∏ –≥–ª—É–±–æ–∫–∏—Ö –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –≤–¥–æ—Ö–∞" },
        { emoji: "ü§≤", name: "–û—Ç–∫—Ä—ã—Ç—ã–µ –ª–∞–¥–æ–Ω–∏", description: "–†–∞—Å–∫—Ä—ã—Ç—å –ª–∞–¥–æ–Ω–∏, –∫–∞–∫ –±—ã –æ—Ç–ø—É—Å–∫–∞—è" },
        { emoji: "üëê", name: "–†–∞–∑–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫", description: "–†–∞–∑–≤–µ—Å—Ç–∏ —Ä—É–∫–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã, –∫–∞–∫ –æ–±–Ω–∏–º–∞—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ" },
        { emoji: "üîÑ", name: "–í—Ä–∞—â–µ–Ω–∏–µ", description: "–ú–µ–¥–ª–µ–Ω–Ω–æ –ø–æ–≤–µ—Ä–Ω—É—Ç—å –≥–æ–ª–æ–≤—É –ø–æ –∫—Ä—É–≥—É" }
      ].freeze
      
      # ===== –ü–£–ë–õ–ò–ß–ù–´–ï –ú–ï–¢–û–î–´ =====
      
      def deliver_intro
        message_text = <<~MARKDOWN
          üåå *–î–µ–Ω—å 25: –°—Ç–æ–∏—á–µ—Å–∫–∏–π "–í–∏–¥ —Å–≤–µ—Ä—Ö—É" ‚Äî –ò—Å–∫—É—Å—Å—Ç–≤–æ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã* üåå

          **–ß–µ—Ç–≤—ë—Ä—Ç–∞—è –Ω–µ–¥–µ–ª—è: –ú–µ—Ç–∞-–Ω–∞–≤—ã–∫–∏ –º—ã—à–ª–µ–Ω–∏—è**

          –ü–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Å–∏—Ç—É–∞—Ü–∏—è–º–∏ (–¥–µ–Ω—å 24) —Å–µ–≥–æ–¥–Ω—è –Ω–∞—É—á–∏–º—Å—è *–º–µ–Ω—è—Ç—å —Å–∞–º—É –æ–ø—Ç–∏–∫—É –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è*.

          **–ß—Ç–æ –≤–∞—Å –∂–¥—ë—Ç:**
          1. üéØ –í—ã–±–æ—Ä —Å–∏—Ç—É–∞—Ü–∏–∏ –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã
          2. üöÄ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–æ—Å—Ö–æ–∂–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 7 —É—Ä–æ–≤–Ω–µ–π –º–∞—Å—à—Ç–∞–±–∞
          3. üåç –û—Ç –∫–æ–º–Ω–∞—Ç—ã –¥–æ –∫–æ—Å–º–æ—Å–∞ ‚Äî –ø–æ–ª–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∫—É—Ä—Å–∞
          4. üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –º—É–¥—Ä–æ—Å—Ç–∏ –≤ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç
          5. üéØ –°–æ–∑–¥–∞–Ω–∏–µ "—è–∫–æ—Ä—è" –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ

          **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 20-25 –º–∏–Ω—É—Ç
          **–≠—Ñ—Ñ–µ–∫—Ç:** –°–Ω–∏–∂–µ–Ω–∏–µ —Ç—Ä–µ–≤–æ–≥–∏, —Ä–æ—Å—Ç –º—É–¥—Ä–æ—Å—Ç–∏, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

          *"–¢–æ—Ç, –∫—Ç–æ –≤–∏–¥–∏—Ç –≤—Å—ë —Å –≤—ã—Å–æ—Ç—ã, —É–∂–µ –Ω–µ –±–æ–∏—Ç—Å—è –≤—ã—Å–æ—Ç—ã."*
        MARKDOWN
        
        send_message(text: message_text, parse_mode: 'Markdown')
        
        @user.set_self_help_step("day_#{DAY_NUMBER}_intro")
        store_day_data('current_step', 'intro')
        
        send_message(
          text: "–ì–æ—Ç–æ–≤—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Å–≤–æ—é –∂–∏–∑–Ω—å —Å –≤—ã—Å–æ—Ç—ã –ø—Ç–∏—á—å–µ–≥–æ, –æ—Ä–±–∏—Ç–∞–ª—å–Ω–æ–≥–æ –∏ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–ª—ë—Ç–∞?",
          reply_markup: day_25_start_markup
        )
      end
      
      def deliver_exercise
        @user.set_self_help_step("day_#{DAY_NUMBER}_exercise_in_progress")
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        unless get_day_data('exercise_data')
          store_day_data('exercise_data', {
            'focus' => nil,
            'focus_details' => nil,
            'level_observations' => {},
            'key_insights' => nil,
            'anchor_gesture' => nil,
            'anchor_phrase' => nil,
            'anchor_image' => nil,
            'completed_at' => nil
          })
          store_day_data('current_step', 'select_focus')
        end
        
        exercise_text = <<~MARKDOWN
          üöÄ *–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: –°—Ç–æ–∏—á–µ—Å–∫–∏–π "–í–∏–¥ —Å–≤–µ—Ä—Ö—É"*

          **–ú—ã –ø—Ä–æ–π–¥–µ–º 11 —à–∞–≥–æ–≤ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã:**

          1. **–í—ã–±–æ—Ä —Ñ–æ–∫—É—Å–∞** ‚Äî —á—Ç–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º
          2-8. **7 —É—Ä–æ–≤–Ω–µ–π –≤–æ—Å—Ö–æ–∂–¥–µ–Ω–∏—è** ‚Äî –æ—Ç –∫–æ–º–Ω–∞—Ç—ã –¥–æ –∫–æ—Å–º–æ—Å–∞
          9. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Äî –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ —Å –Ω–æ–≤–æ–π –º—É–¥—Ä–æ—Å—Ç—å—é
          10. **–°–æ–∑–¥–∞–Ω–∏–µ —è–∫–æ—Ä—è** ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
          11. **–ò—Ç–æ–≥** ‚Äî –≤–∞—à –Ω–æ–≤—ã–π –º–µ—Ç–∞-–Ω–∞–≤—ã–∫

          **–§–∏–ª–æ—Å–æ—Ñ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞:** –¢–µ—Ö–Ω–∏–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Å—Ç–æ–∏–∫–∏ –ú–∞—Ä–∫ –ê–≤—Ä–µ–ª–∏–π –∏ –°–µ–Ω–µ–∫–∞. –ê—Å—Ç—Ä–æ–Ω–∞–≤—Ç—ã, –≤–∏–¥–µ–≤—à–∏–µ –ó–µ–º–ª—é –∏–∑ –∫–æ—Å–º–æ—Å–∞, –Ω–∞–∑—ã–≤–∞—é—Ç —ç—Ç–æ "—ç—Ñ—Ñ–µ–∫—Ç–æ–º –æ–±–∑–æ—Ä–∞" ‚Äî –≥–ª—É–±–æ–∫–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Å–æ–∑–Ω–∞–Ω–∏—è.

          *–ì–æ—Ç–æ–≤—ã –∫ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–º—É –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—é –±–µ–∑ —Ä–∞–∫–µ—Ç—ã?*
        MARKDOWN
        
        send_message(text: exercise_text, parse_mode: 'Markdown')
        
        # –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å
        start_exercise_step('select_focus')
      end
      
      # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      def handle_text_input(input_text)
        current_step = get_day_data('current_step')
        
        log_info("Day #{DAY_NUMBER}: Handling text input for step: #{current_step}, text: #{input_text.truncate(50)}")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∂–¥–µ–º –ª–∏ –º—ã –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ñ–æ–∫—É—Å–∞
        if get_day_data('awaiting_custom_focus')
          store_day_data('awaiting_custom_focus', false)
          handle_custom_focus(input_text)
          return true
        end
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∂–¥–µ–º –ª–∏ –º—ã –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —è–∫–æ—Ä—è
        if get_day_data('awaiting_custom_anchor')
          store_day_data('awaiting_custom_anchor', false)
          handle_custom_anchor(input_text)
          return true
        end
        
        case current_step
        when 'intro'
          handle_intro_input(input_text)
        when 'select_focus'
          handle_situation_input(input_text)
        when /^level\d+_/
          handle_level_input(current_step, input_text)
        when 'integration'
          handle_integration_input(input_text)
        when 'anchoring'
          handle_anchoring_input(input_text)
        when 'summary'
          handle_summary_input(input_text)
        else
          log_warn("Unknown step for text input: #{current_step}")
          send_message(text: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ.")
          false
        end
      end
      
      # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫
      def handle_button(callback_data)
        log_info("Day #{DAY_NUMBER}: Handling button: #{callback_data}")
        
        case callback_data
        when 'start_day_25_exercise'
          deliver_exercise
          
        when /^day_25_focus_(\d+)$/
          index = $1.to_i
          handle_focus_category_button(index)
          
        when 'day_25_custom_focus'
          send_message(text: "üìù –û–ø–∏—à–∏—Ç–µ —Å–≤–æ—é —Å–∏—Ç—É–∞—Ü–∏—é –∏–ª–∏ –º—ã—Å–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã:")
          store_day_data('awaiting_custom_focus', true)
          
        when 'day_25_finish_focus'
          finish_focus_selection
          
        when /^day_25_anchor_gesture_(\d+)$/
          index = $1.to_i
          handle_anchor_gesture_button(index)
          
        when 'day_25_custom_anchor'
          send_message(text: "üéØ –ü—Ä–∏–¥—É–º–∞–π—Ç–µ —Å–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —è–∫–æ—Ä—å (–∂–µ—Å—Ç + —Ñ—Ä–∞–∑–∞):")
          store_day_data('awaiting_custom_anchor', true)
          
        when 'day_25_finish_anchor'
          finish_anchor_selection
          
        when 'day_25_complete_exercise'
          complete_exercise
          
        when 'day_25_show_full_journey'
          show_full_journey_summary
          
        when 'day_25_practice_quick'
          practice_quick_version
          
        else
          log_warn("Unknown button callback: #{callback_data}")
          send_message(text: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞.")
        end
      end
      
      # –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
      def complete_exercise
        exercise_data = get_exercise_data
        
        if exercise_data['anchor_phrase'].blank?
          send_message(text: "‚ö†Ô∏è –£ –≤–∞—Å –Ω–µ —Å–æ–∑–¥–∞–Ω —è–∫–æ—Ä—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞. –î–∞–≤–∞–π—Ç–µ –∑–∞–∫–æ–Ω—á–∏–º.")
          start_exercise_step('anchoring')
          return false
        end
        
        @user.set_self_help_step("day_#{DAY_NUMBER}_completed")
        exercise_data['completed_at'] = Time.current
        store_day_data('exercise_data', exercise_data)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
        save_view_from_above_exercise(exercise_data)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç
        show_final_report(exercise_data)
        
        # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å
        propose_next_day
        
        true
      end
      
      private
      
      # ===== –û–°–ù–û–í–ù–´–ï –ú–ï–¢–û–î–´ –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø =====
      
      def start_exercise_step(step_type)
        store_day_data('current_step', step_type)
        
        step = EXERCISE_STEPS[step_type]
        return unless step
        
        send_message(text: step[:title], parse_mode: 'Markdown')
        
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è summary —à–∞–≥–∞
        if step_type == 'summary'
          instruction = format_summary_instruction(step[:instruction])
        else
          instruction = step[:instruction]
        end
        
        send_message(text: instruction)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
        case step_type
        when 'select_focus'
          send_message(
            text: "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–ª–∏ –æ–ø–∏—à–∏—Ç–µ —Å–≤–æ—é —Å–∏—Ç—É–∞—Ü–∏—é:",
            reply_markup: day_25_focus_markup
          )
          
        when /^level\d+_/
          # –î–ª—è —É—Ä–æ–≤–Ω–µ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
          show_level_progress(step_type)
          
        when 'anchoring'
          send_message(
            text: "–í—ã–±–µ—Ä–∏—Ç–µ –∂–µ—Å—Ç-—è–∫–æ—Ä—å –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π:",
            reply_markup: day_25_anchors_markup
          )
          
        when 'summary'
          send_message(
            text: "–í–∞—à '–í–∏–¥ —Å–≤–µ—Ä—Ö—É' –æ—Å–≤–æ–µ–Ω! –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –∏–ª–∏ –ø–æ–ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –±—ã—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.",
            reply_markup: day_25_completion_markup
          )
        end
      end
      
      # –ú–µ—Ç–æ–¥ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ summary
      def format_summary_instruction(base_instruction)
        exercise_data = get_exercise_data
        
        base_instruction
          .gsub('[–≤–∞—à–∞ —Å–∏—Ç—É–∞—Ü–∏—è]', exercise_data['focus'] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ')
          .gsub('[–≤–∞—à–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è]', exercise_data['key_insights']&.truncate(100) || '–ù–µ —É–∫–∞–∑–∞–Ω–æ')
          .gsub('[–≤–∞—à —è–∫–æ—Ä—å]', format_anchor(exercise_data) || '–ù–µ —É–∫–∞–∑–∞–Ω–æ')
      end
      
      def format_anchor(exercise_data)
        if exercise_data['anchor_gesture'] && exercise_data['anchor_phrase']
          "#{exercise_data['anchor_gesture']} + '#{exercise_data['anchor_phrase']}'"
        else
          '–ù–µ —Å–æ–∑–¥–∞–Ω'
        end
      end
      
      # ===== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –®–ê–ì–û–í =====
      
      def handle_intro_input(input_text)
        start_exercise_step('select_focus')
        true
      end
      
      def handle_situation_input(input_text)
        if input_text.present?
          exercise_data = get_exercise_data
          exercise_data['focus'] = "–î—Ä—É–≥–æ–µ: #{input_text}"
          exercise_data['focus_details'] = input_text
          store_day_data('exercise_data', exercise_data)
        end
        
        start_exercise_step('level1_room')
        true
      end
      
      def handle_level_input(level_name, input_text)
        return false if input_text.strip.empty?
        
        exercise_data = get_exercise_data
        exercise_data['level_observations'] ||= {}
        exercise_data['level_observations'][level_name] = input_text
        store_day_data('exercise_data', exercise_data)
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å
        levels = [
          'level1_room', 'level2_building', 'level3_city', 
          'level4_country', 'level5_planet', 'level6_time', 
          'level7_cosmic'
        ]
        
        current_index = levels.index(level_name)
        if current_index && current_index < levels.size - 1
          next_level = levels[current_index + 1]
          start_exercise_step(next_level)
        elsif level_name == 'level7_cosmic'
          start_exercise_step('integration')
        else
          start_exercise_step('integration')
        end
        
        true
      end
      
      def handle_integration_input(input_text)
        return false if input_text.strip.empty?
        
        exercise_data = get_exercise_data
        exercise_data['key_insights'] = input_text
        store_day_data('exercise_data', exercise_data)
        
        start_exercise_step('anchoring')
        true
      end
      
      def handle_anchoring_input(input_text)
        return false if input_text.strip.empty?
        
        exercise_data = get_exercise_data
        exercise_data['anchor_phrase'] = input_text
        store_day_data('exercise_data', exercise_data)
        
        start_exercise_step('summary')
        true
      end
      
      def handle_summary_input(input_text)
        complete_exercise
        true
      end
      
      # ===== –û–ë–†–ê–ë–û–¢–ö–ê –ö–ù–û–ü–û–ö =====
      
      def handle_focus_category_button(index)
        category = FOCUS_CATEGORIES[index]
        
        if category
          exercise_data = get_exercise_data
          exercise_data['focus'] = "#{category[:emoji]} #{category[:name]}"
          exercise_data['focus_details'] = category[:examples].sample
          store_day_data('exercise_data', exercise_data)
          
          send_message(text: "‚úÖ –í—ã–±—Ä–∞–Ω–æ: #{category[:emoji]} #{category[:name]}")
          sleep(1)
          send_message(text: "üí° –ü—Ä–∏–º–µ—Ä: '#{exercise_data['focus_details']}'")
          
          send_message(
            text: "–•–æ—Ç–∏—Ç–µ —É—Ç–æ—á–Ω–∏—Ç—å –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å —ç—Ç–∏–º —Ñ–æ–∫—É—Å–æ–º?",
            reply_markup: day_25_focus_details_markup
          )
        end
      end
      
      def handle_custom_focus(input_text)
        if input_text.present?
          exercise_data = get_exercise_data
          exercise_data['focus'] = "üìù –ú–æ—è —Å–∏—Ç—É–∞—Ü–∏—è"
          exercise_data['focus_details'] = input_text
          store_day_data('exercise_data', exercise_data)
          
          send_message(text: "‚úÖ –§–æ–∫—É—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω: #{input_text.truncate(100)}")
          start_exercise_step('level1_room')
        else
          send_message(text: "‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–ø–∏—à–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é.")
        end
      end
      
      def handle_anchor_gesture_button(index)
        gesture = ANCHOR_GESTURES[index]
        
        if gesture
          exercise_data = get_exercise_data
          exercise_data['anchor_gesture'] = "#{gesture[:emoji]} #{gesture[:name]}"
          store_day_data('exercise_data', exercise_data)
          
          send_message(text: "‚úÖ –ñ–µ—Å—Ç: #{gesture[:emoji]} #{gesture[:name]}")
          send_message(text: "üí° #{gesture[:description]}")
          
          send_message(
            text: "–¢–µ–ø–µ—Ä—å –ø—Ä–∏–¥—É–º–∞–π—Ç–µ —Ñ—Ä–∞–∑—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ '–≤–∏–¥–∞ —Å–≤–µ—Ä—Ö—É':"
          )
        end
      end
      
      def handle_custom_anchor(input_text)
        if input_text.present?
          exercise_data = get_exercise_data
          # –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞–∑–æ–±—Ä–∞—Ç—å –≤–≤–æ–¥ (—Ñ–æ—Ä–º–∞—Ç: "–∂–µ—Å—Ç + —Ñ—Ä–∞–∑–∞")
          parts = input_text.split('+').map(&:strip)
          if parts.size >= 2
            exercise_data['anchor_gesture'] = parts[0]
            exercise_data['anchor_phrase'] = parts[1]
          else
            exercise_data['anchor_gesture'] = "‚ú® –ú–æ–π –∂–µ—Å—Ç"
            exercise_data['anchor_phrase'] = input_text
          end
          store_day_data('exercise_data', exercise_data)
          
          send_message(text: "‚úÖ –Ø–∫–æ—Ä—å —Å–æ–∑–¥–∞–Ω!")
          start_exercise_step('summary')
        else
          send_message(text: "‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–ø–∏—à–∏—Ç–µ —è–∫–æ—Ä—å.")
        end
      end
      
      def finish_focus_selection
        exercise_data = get_exercise_data
        
        if exercise_data['focus'].blank?
          send_message(text: "‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–ª–∏ –æ–ø–∏—à–∏—Ç–µ —Ñ–æ–∫—É—Å.")
          return
        end
        
        start_exercise_step('level1_room')
      end
      
      def finish_anchor_selection
        exercise_data = get_exercise_data
        
        if exercise_data['anchor_gesture'].blank?
          send_message(text: "‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —è–∫–æ—Ä—å.")
          return
        end
        
        send_message(text: "–¢–µ–ø–µ—Ä—å –ø—Ä–∏–¥—É–º–∞–π—Ç–µ —Ñ—Ä–∞–∑—É –¥–ª—è —ç—Ç–æ–≥–æ –∂–µ—Å—Ç–∞:")
        # –ñ–¥—ë–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥
      end
      
      # ===== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ =====
      
      def get_exercise_data
        get_day_data('exercise_data') || {}
      end
      
      def show_level_progress(current_level)
        levels = [
          { name: 'level1_room', emoji: 'üö™', title: '–ö–æ–º–Ω–∞—Ç–∞' },
          { name: 'level2_building', emoji: 'üè¢', title: '–î–æ–º' },
          { name: 'level3_city', emoji: 'üåÜ', title: '–ì–æ—Ä–æ–¥' },
          { name: 'level4_country', emoji: 'üó∫Ô∏è', title: '–°—Ç—Ä–∞–Ω–∞' },
          { name: 'level5_planet', emoji: 'ü™ê', title: '–ü–ª–∞–Ω–µ—Ç–∞' },
          { name: 'level6_time', emoji: '‚è≥', title: '–í—Ä–µ–º—è' },
          { name: 'level7_cosmic', emoji: '‚ú®', title: '–ö–æ—Å–º–æ—Å' }
        ]
        
        current_index = levels.index { |l| l[:name] == current_level }
        return unless current_index
        
        progress_message = "üìä *–ü—Ä–æ–≥—Ä–µ—Å—Å:* "
        levels.each_with_index do |level, index|
          if index < current_index
            progress_message += "‚úÖ"
          elsif index == current_index
            progress_message += "‚è≥"
          else
            progress_message += "‚ö™Ô∏è"
          end
          progress_message += " "
        end
        
        send_message(text: progress_message, parse_mode: 'Markdown')
        
        if current_index > 0
          previous_level = levels[current_index - 1]
          send_message(text: "‚¨ÜÔ∏è *–¢–æ–ª—å–∫–æ —á—Ç–æ:* #{previous_level[:emoji]} #{previous_level[:title]}")
        end
      end
      
      def save_view_from_above_exercise(exercise_data)
        begin
          if defined?(ViewFromAboveExercise)
            ViewFromAboveExercise.create!(
              user: @user,
              exercise_date: Date.current,
              focus: exercise_data['focus'],
              focus_details: exercise_data['focus_details'],
              level_observations: exercise_data['level_observations'] || {},
              key_insights: exercise_data['key_insights'],
              anchor_gesture: exercise_data['anchor_gesture'],
              anchor_phrase: exercise_data['anchor_phrase'],
              completed_at: exercise_data['completed_at']
            )
          end
        rescue => e
          log_error("Failed to save view from above exercise", e)
        end
      end
      
      def show_final_report(exercise_data)
        message = <<~MARKDOWN
          üåü *–í–∞—à "–í–∏–¥ —Å–≤–µ—Ä—Ö—É" –æ—Å–≤–æ–µ–Ω!* üåü

          üöÄ **–ö–æ—Å–º–∏—á–µ—Å–∫–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ**

          üéØ **–ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–æ–∫—É—Å:**
          #{exercise_data['focus']} ‚Äî #{exercise_data['focus_details']}

          ü™ú **–ü—Ä–æ–π–¥–µ–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã:**
          1. üö™ –ö–æ–º–Ω–∞—Ç–∞ ‚Äî #{exercise_data['level_observations']&.dig('level1_room')&.truncate(60) || '...'}
          2. üè¢ –î–æ–º ‚Äî #{exercise_data['level_observations']&.dig('level2_building')&.truncate(60) || '...'}
          3. üåÜ –ì–æ—Ä–æ–¥ ‚Äî #{exercise_data['level_observations']&.dig('level3_city')&.truncate(60) || '...'}
          4. üó∫Ô∏è –°—Ç—Ä–∞–Ω–∞ ‚Äî #{exercise_data['level_observations']&.dig('level4_country')&.truncate(60) || '...'}
          5. ü™ê –ü–ª–∞–Ω–µ—Ç–∞ ‚Äî #{exercise_data['level_observations']&.dig('level5_planet')&.truncate(60) || '...'}
          6. ‚è≥ –í—Ä–µ–º—è ‚Äî #{exercise_data['level_observations']&.dig('level6_time')&.truncate(60) || '...'}
          7. ‚ú® –ö–æ—Å–º–æ—Å ‚Äî #{exercise_data['level_observations']&.dig('level7_cosmic')&.truncate(60) || '...'}

          üí° **–ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã:**
          #{exercise_data['key_insights'] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}

          üéØ **–í–∞—à —è–∫–æ—Ä—å:**
          #{exercise_data['anchor_gesture']} + "#{exercise_data['anchor_phrase']}"

          **–ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å —ç—Ç–æ—Ç –Ω–∞–≤—ã–∫:**
          1. üåÄ **–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —à—Ç–æ—Ä–º** ‚Äî –∫–æ–≥–¥–∞ —á—É–≤—Å—Ç–≤–∞ –∑–∞—Ö–ª—ë—Å—Ç—ã–≤–∞—é—Ç
          2. ü§Ø **–¢—É–Ω–Ω–µ–ª—å–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ** ‚Äî –∫–æ–≥–¥–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∫–∞–∂–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é
          3. üéØ **–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π** ‚Äî –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –º—É–¥—Ä–æ—Å—Ç—å, –∞ –Ω–µ –∏–º–ø—É–ª—å—Å
          4. üòå **–£—Ç—Ä–µ–Ω–Ω–∏–π/–≤–µ—á–µ—Ä–Ω–∏–π —Ä–∏—Ç—É–∞–ª** ‚Äî –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã

          **–ë—ã—Å—Ç—Ä–∞—è –≤–µ—Ä—Å–∏—è (30 —Å–µ–∫—É–Ω–¥):**
          1. #{exercise_data['anchor_gesture']&.split(' ')&.last || '–°–¥–µ–ª–∞–π—Ç–µ –≤–∞—à –∂–µ—Å—Ç'}
          2. –ü—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ: "#{exercise_data['anchor_phrase'] || '–í–∏–¥ —Å–≤–µ—Ä—Ö—É'}"
          3. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –ó–µ–º–ª—é –∏–∑ –∫–æ—Å–º–æ—Å–∞
          4. –í–µ—Ä–Ω–∏—Ç–µ—Å—å —Å –Ω–æ–≤–æ–π –º—É–¥—Ä–æ—Å—Ç—å—é

          **–°—Ç–æ–∏—á–µ—Å–∫–∞—è –º—É–¥—Ä–æ—Å—Ç—å –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å:**
          > *"–ü–æ–º–Ω–∏, —á—Ç–æ —Ç—ã ‚Äî –∞–∫—Ç—ë—Ä –≤ –ø—å–µ—Å–µ, –∫–∞–∫—É—é –±—ã —Ä–æ–ª—å –Ω–∏ –Ω–∞–∑–Ω–∞—á–∏–ª —Ç–µ–±–µ —Ä–µ–∂–∏—Å—Å—ë—Ä. –ë—É–¥—å –∂–µ —Ö–æ—Ä–æ—à–∏–º –∞–∫—Ç—ë—Ä–æ–º."*
          > ‚Äî –≠–ø–∏–∫—Ç–µ—Ç

          –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç!
        MARKDOWN
        
        send_message(text: message, parse_mode: 'Markdown')
      end
      
      def show_full_journey_summary
        exercise_data = get_exercise_data
        show_final_report(exercise_data)
      end
      
      def practice_quick_version
        exercise_data = get_exercise_data
        
        message = <<~MARKDOWN
          üöÄ *–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ "–í–∏–¥ —Å–≤–µ—Ä—Ö—É" (30 —Å–µ–∫—É–Ω–¥)*

          1. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å** –Ω–∞ –º–≥–Ω–æ–≤–µ–Ω–∏–µ
          2. **#{exercise_data['anchor_gesture']&.split(' ')&.last || '–°–¥–µ–ª–∞–π—Ç–µ –≤–∞—à –∂–µ—Å—Ç'}**
          3. **–ü—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ –ø—Ä–æ —Å–µ–±—è:** "#{exercise_data['anchor_phrase'] || '–í–∏–¥ —Å–≤–µ—Ä—Ö—É'}"
          4. **–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ:** –ó–µ–º–ª—è –∏–∑ –∫–æ—Å–º–æ—Å–∞, –∫—Ä–æ—à–µ—á–Ω–∞—è –≥–æ–ª—É–±–∞—è —Ç–æ—á–∫–∞
          5. **–í—Å–ø–æ–º–Ω–∏—Ç–µ:** –í–∞—à–∞ —Å–∏—Ç—É–∞—Ü–∏—è ‚Äî –ª–∏—à—å —á–∞—Å—Ç—å –æ–≥—Ä–æ–º–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω—ã
          6. **–í–µ—Ä–Ω–∏—Ç–µ—Å—å** —Å –º—É–¥—Ä–æ—Å—Ç—å—é –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ–º

          *–ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ 3 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –Ω–∞–≤—ã–∫–∞.*
        MARKDOWN
        
        send_message(text: message, parse_mode: 'Markdown')
      end
      
      # ===== –†–ê–ó–ú–ï–¢–ö–ê =====
      
      def day_25_start_markup
        {
          inline_keyboard: [
            [
              { text: "üöÄ –ù–∞—á–∞—Ç—å –∫–æ—Å–º–∏—á–µ—Å–∫–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ", callback_data: 'start_day_25_exercise' }
            ]
          ]
        }.to_json
      end
      
      def day_25_focus_markup
        keyboard = []
        
        # –ü—Ä–æ—Å—Ç—ã–µ –∫–Ω–æ–ø–∫–∏ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
        FOCUS_CATEGORIES.each_with_index do |category, index|
          keyboard << [
            { 
              text: "#{category[:emoji]} #{category[:name]}", 
              callback_data: "day_25_focus_#{index}" 
            }
          ]
        end
        
        keyboard << [
          { text: "‚úçÔ∏è –°–≤–æ—è —Å–∏—Ç—É–∞—Ü–∏—è", callback_data: 'day_25_custom_focus' }
        ]
        
        keyboard << [
          { text: "‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å", callback_data: 'day_25_finish_focus' }
        ]
        
        { inline_keyboard: keyboard }.to_json
      end
      
      def day_25_focus_details_markup
        {
          inline_keyboard: [
            [
              { text: "‚úçÔ∏è –£—Ç–æ—á–Ω–∏—Ç—å", callback_data: 'day_25_custom_focus' },
              { text: "‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å", callback_data: 'day_25_finish_focus' }
            ]
          ]
        }.to_json
      end
      
      def day_25_anchors_markup
        keyboard = []
        
        ANCHOR_GESTURES.each_with_index do |gesture, index|
          keyboard << [
            { 
              text: "#{gesture[:emoji]} #{gesture[:name]}", 
              callback_data: "day_25_anchor_gesture_#{index}" 
            }
          ]
        end
        
        keyboard << [
          { text: "‚ú® –°–≤–æ–π —è–∫–æ—Ä—å", callback_data: 'day_25_custom_anchor' }
        ]
        
        keyboard << [
          { text: "‚úÖ –ì–æ—Ç–æ–≤–æ", callback_data: 'day_25_finish_anchor' }
        ]
        
        { inline_keyboard: keyboard }.to_json
      end
      
      def day_25_completion_markup
        {
          inline_keyboard: [
            [
              { text: "üìä –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç—á—ë—Ç", callback_data: 'day_25_show_full_journey' },
              { text: "üöÄ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞", callback_data: 'day_25_practice_quick' }
            ],
            [
              { text: "‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å –¥–µ–Ω—å", callback_data: 'day_25_complete_exercise' }
            ]
          ]
        }.to_json
      end
      
      def log_info(message)
        Rails.logger.info "[Day#{DAY_NUMBER}Service] #{message} - User: #{@user.telegram_id}"
      end
      
      def log_error(message, error = nil)
        Rails.logger.error "[Day#{DAY_NUMBER}Service] #{message} - User: #{@user.telegram_id}"
        Rails.logger.error error.message if error
        Rails.logger.error error.backtrace.join("\n") if error
      end
      
      def log_warn(message)
        Rails.logger.warn "[Day#{DAY_NUMBER}Service] #{message} - User: #{@user.telegram_id}"
      end
    end
  end
end