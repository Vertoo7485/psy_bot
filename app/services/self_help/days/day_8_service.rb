# app/services/self_help/days/day_8_service.rb
module SelfHelp
  module Days
    class Day8Service < DayBaseService
      include TelegramMarkupHelper
      DAY_NUMBER = 8
      
      def deliver_intro
        message_text = <<~MARKDOWN
          ðŸŽ¯ *Ð”ÐµÐ½ÑŒ 8: Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¼Ñ‹ÑÐ»ÑÐ¼Ð¸* ðŸŽ¯
          
          **Ð¢ÐµÑ…Ð½Ð¸ÐºÐ° Â«ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¼Ñ‹ÑÐ»ÐµÐ¹Â»**
          
          Ð˜Ð½Ð¾Ð³Ð´Ð° Ð½Ð°Ñˆ ÑƒÐ¼ Ð·Ð°Ñ…Ð²Ð°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ Ð½Ð°Ð²ÑÐ·Ñ‡Ð¸Ð²Ñ‹Ðµ, Ñ‚Ñ€ÐµÐ²Ð¾Ð¶Ð½Ñ‹Ðµ Ð¸Ð»Ð¸ Ð½ÐµÐ³Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð¼Ñ‹ÑÐ»Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ ÐºÑ€ÑƒÑ‚ÑÑ‚ÑÑ Ð¿Ð¾ ÐºÑ€ÑƒÐ³Ñƒ. Ð¢ÐµÑ…Ð½Ð¸ÐºÐ° Â«ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¼Ñ‹ÑÐ»ÐµÐ¹Â» Ð¿Ð¾Ð¼Ð¾Ð³Ð°ÐµÑ‚ Ð²Ð·ÑÑ‚ÑŒ Ð¿Ð¾Ð´ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒ ÑÑ‚Ð¾Ñ‚ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ.
          
          **ÐšÐ°Ðº ÑÑ‚Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚:**
          â€¢ ÐœÑ‹ ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Â«ÑÑ‚Ð¾Ð¿-ÑÐ¸Ð³Ð½Ð°Ð»Â» Ð´Ð»Ñ Ð¼Ñ‹ÑÐ»ÐµÐ¹
          â€¢ Ð£Ñ‡Ð¸Ð¼ÑÑ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÑŒ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ
          â€¢ Ð Ð°Ð·Ñ€Ñ‹Ð²Ð°ÐµÐ¼ Ñ†Ð¸ÐºÐ» Ð½Ð°Ð²ÑÐ·Ñ‡Ð¸Ð²Ð¾Ð³Ð¾ Ð¼Ñ‹ÑˆÐ»ÐµÐ½Ð¸Ñ
          
          **Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ:**
          â€¢ ÐŸÐ¾Ð¼Ð¾Ð³Ð°ÐµÑ‚ Ð¿Ñ€Ð¸ Ñ‚Ñ€ÐµÐ²Ð¾Ð¶Ð½Ñ‹Ñ… Ð¼Ñ‹ÑÐ»ÑÑ…
          â€¢ Ð£Ð¼ÐµÐ½ÑŒÑˆÐ°ÐµÑ‚ Ñ€ÑƒÐ¼Ð¸Ð½Ð°Ñ†Ð¸ÑŽ (Ð¼Ñ‹ÑÐ»ÐµÐ½Ð½ÑƒÑŽ Ð¶Ð²Ð°Ñ‡ÐºÑƒ)
          â€¢ Ð”Ð°ÐµÑ‚ Ñ‡ÑƒÐ²ÑÑ‚Ð²Ð¾ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ñ
        MARKDOWN
        
        send_message(text: message_text, parse_mode: 'Markdown')
        
        @user.set_self_help_step("day_#{DAY_NUMBER}_intro")
        
        send_message(
          text: "Ð“Ð¾Ñ‚Ð¾Ð²Ñ‹ Ð¾ÑÐ²Ð¾Ð¸Ñ‚ÑŒ Ñ‚ÐµÑ…Ð½Ð¸ÐºÑƒ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð¼Ñ‹ÑÐ»ÐµÐ¹?",
          reply_markup: TelegramMarkupHelper.day_8_consent_markup
        )
      end
      
      def deliver_exercise
        @user.set_self_help_step("day_#{DAY_NUMBER}_exercise_in_progress")
        
        exercise_text = <<~MARKDOWN
          ðŸ›‘ *Ð¢ÐµÑ…Ð½Ð¸ÐºÐ° Â«ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¼Ñ‹ÑÐ»ÐµÐ¹Â»* ðŸ›‘

          **Ð¨Ð°Ð³ 1: ÐžÑÐ¾Ð·Ð½Ð°Ð½Ð¸Ðµ Ð¼Ñ‹ÑÐ»Ð¸**
          1. Ð’ÑÐ¿Ð¾Ð¼Ð½Ð¸Ñ‚Ðµ Ð¼Ñ‹ÑÐ»ÑŒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ñ‡Ð°ÑÑ‚Ð¾ Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð±ÐµÑÐ¿Ð¾ÐºÐ¾Ð¹ÑÑ‚Ð²Ð¾
          2. ÐÐµ Ð¿Ð¾Ð³Ñ€ÑƒÐ¶Ð°Ð¹Ñ‚ÐµÑÑŒ Ð² Ð½ÐµÐµ Ð³Ð»ÑƒÐ±Ð¾ÐºÐ¾
          3. ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð¾Ñ‚Ð¼ÐµÑ‚ÑŒÑ‚Ðµ ÐµÐµ Ð¿Ñ€Ð¸ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ

          **Ð¨Ð°Ð³ 2: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÑ‚Ð¾Ð¿-ÑÐ¸Ð³Ð½Ð°Ð»Ð°**
          1. ÐŸÑ€ÐµÐ´ÑÑ‚Ð°Ð²ÑŒÑ‚Ðµ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð¹ ÐºÑ€Ð°ÑÐ½Ñ‹Ð¹ Ð·Ð½Ð°Ðº Â«Ð¡Ð¢ÐžÐŸÂ»
          2. ÐœÑ‹ÑÐ»ÐµÐ½Ð½Ð¾ Ð¸Ð»Ð¸ Ð²ÑÐ»ÑƒÑ… ÑÐºÐ°Ð¶Ð¸Ñ‚Ðµ Â«Ð¡Ð¢ÐžÐŸ!Â»
          3. ÐœÐ¾Ð¶Ð½Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ€ÐµÐ·ÐºÐ¸Ð¹ Ð·Ð²ÑƒÐº Ð¸Ð»Ð¸ Ð¶ÐµÑÑ‚

          **Ð¨Ð°Ð³ 3: ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ñ**
          1. Ð¡Ñ€Ð°Ð·Ñƒ Ð¿Ð¾ÑÐ»Ðµ Â«Ð¡Ð¢ÐžÐŸÂ» Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÐµÑÑŒ Ð½Ð°:
            â€¢ Ð”Ñ‹Ñ…Ð°Ð½Ð¸Ðµ (ÑÐ¾ÑÑ‡Ð¸Ñ‚Ð°Ð¹Ñ‚Ðµ 10 Ð²Ð´Ð¾Ñ…Ð¾Ð²-Ð²Ñ‹Ð´Ð¾Ñ…Ð¾Ð²)
            â€¢ ÐžÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ (Ð½Ð°Ð·Ð¾Ð²Ð¸Ñ‚Ðµ 5 Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² Ð²Ð¾ÐºÑ€ÑƒÐ³)
            â€¢ Ð¢ÐµÐ»ÐµÑÐ½Ñ‹Ðµ Ð¾Ñ‰ÑƒÑ‰ÐµÐ½Ð¸Ñ (Ð¿Ñ€Ð¾ÑÐºÐ°Ð½Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ‚ÐµÐ»Ð¾)

          **Ð¨Ð°Ð³ 4: ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ°**
          ÐŸÐ¾Ñ‚Ñ€ÐµÐ½Ð¸Ñ€ÑƒÐ¹Ñ‚ÐµÑÑŒ ÑÐµÐ¹Ñ‡Ð°Ñ Ñ Ð»ÑŽÐ±Ð¾Ð¹ Ð½ÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¼Ñ‹ÑÐ»ÑŒÑŽ
        MARKDOWN
        
        send_message(text: exercise_text, parse_mode: 'Markdown')
        
        send_message(
          text: "ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ñ‚ÐµÑ…Ð½Ð¸ÐºÑƒ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ. ÐšÐ¾Ð³Ð´Ð° ÑÐ´ÐµÐ»Ð°ÐµÑ‚Ðµ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÑƒ, Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ:",
          reply_markup: TelegramMarkupHelper.day_8_stopped_thought_first_try_markup
        )
      end
      
      # Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð• 1: Ð­Ñ‚Ð¾Ñ‚ Ð¼ÐµÑ‚Ð¾Ð´ Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¿Ð¾ÑÐ»Ðµ Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ñ "Ð¯ Ð¿Ð¾Ð¿Ñ€Ð¾Ð±Ð¾Ð²Ð°Ð»(Ð°) Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¼Ñ‹ÑÐ»ÑŒ"
      def handle_stopped_thought
        # ÐœÐµÐ½ÑÐµÐ¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð½Ð° "ÑƒÐ¿Ñ€Ð°Ð¶Ð½ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾, Ð½Ð¾ Ð´ÐµÐ½ÑŒ Ð½Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½"
        @user.set_self_help_step("day_#{DAY_NUMBER}_exercise_done")
        
        message = <<~MARKDOWN
          ðŸŒŸ *ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð¾!* ðŸŒŸ

          Ð’Ñ‹ Ð¿Ð¾Ð¿Ñ€Ð¾Ð±Ð¾Ð²Ð°Ð»Ð¸ Ñ‚ÐµÑ…Ð½Ð¸ÐºÑƒ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð¼Ñ‹ÑÐ»ÐµÐ¹.

          **Ð’Ð°Ð¶Ð½Ñ‹Ð¹ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ ÑˆÐ°Ð³:**
          ÐŸÐ¾ÑÐ»Ðµ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð¼Ñ‹ÑÐ»Ð¸ ÐšÐ Ð˜Ð¢Ð˜Ð§Ð•Ð¡ÐšÐ˜ Ð²Ð°Ð¶Ð½Ð¾ ÑÑ€Ð°Ð·Ñƒ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ Ð½Ð° Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð´Ñ€ÑƒÐ³Ð¾Ðµ. 
          Ð˜Ð½Ð°Ñ‡Ðµ Ð¼Ñ‹ÑÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ.

          **Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ¿Ð¾ÑÐ¾Ð± Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ñ:**
        MARKDOWN
        
        send_message(text: message, parse_mode: 'Markdown')
        
        # Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð• 2: Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°ÐµÐ¼ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ñ‹ Ð¾Ñ‚Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ
        propose_distractions
      end
      
      # Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð• 3: ÐœÐµÑ‚Ð¾Ð´ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð² Ð¾Ñ‚Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ
      def propose_distractions
        # ÐÐµ Ð¼ÐµÐ½ÑÐµÐ¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ, Ð¾ÑÑ‚Ð°ÐµÐ¼ÑÑ Ð² day_8_exercise_done
        send_message(
          text: "ÐšÐ°ÐºÐ¾Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð± Ð¾Ñ‚Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¿Ð¾Ð¿Ñ€Ð¾Ð±Ð¾Ð²Ð°Ñ‚ÑŒ?",
          reply_markup: TelegramMarkupHelper.day_8_distraction_options_markup
        )
      end
      
      # Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð• 4: ÐœÐµÑ‚Ð¾Ð´ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð¾Ñ‚Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ
      def handle_distraction_choice(distraction_type)
        distraction_text = case distraction_type
                          when 'music'
                            <<~MARKDOWN
                              ðŸŽµ **ÐžÑ‚Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð¼ÑƒÐ·Ñ‹ÐºÐ¾Ð¹**

                              â€¢ Ð’ÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ðµ Ð»ÑŽÐ±Ð¸Ð¼Ñ‹Ð¹ Ð¿Ð»ÐµÐ¹Ð»Ð¸ÑÑ‚
                              â€¢ Ð¡Ð¾ÑÑ€ÐµÐ´Ð¾Ñ‚Ð¾Ñ‡ÑŒÑ‚ÐµÑÑŒ Ð½Ð° Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ…
                              â€¢ ÐŸÐ¾Ð¹Ñ‚Ðµ Ð¸Ð»Ð¸ Ð½Ð°Ð¿ÐµÐ²Ð°Ð¹Ñ‚Ðµ
                              â€¢ Ð¢Ð°Ð½Ñ†ÑƒÐ¹Ñ‚Ðµ, ÐµÑÐ»Ð¸ Ñ…Ð¾Ñ‡ÐµÑ‚ÑÑ
                            MARKDOWN
                          when 'video'
                            <<~MARKDOWN
                              ðŸŽ¬ **ÐžÑ‚Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð²Ð¸Ð´ÐµÐ¾**

                              â€¢ ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾Ðµ ÑÐ¼ÐµÑˆÐ½Ð¾Ðµ Ð²Ð¸Ð´ÐµÐ¾
                              â€¢ Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ„Ð¸Ð»ÑŒÐ¼ Ð¾ Ð¿Ñ€Ð¸Ñ€Ð¾Ð´Ðµ
                              â€¢ ÐžÐ±Ñ€Ð°Ð·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚
                              â€¢ Ð’Ð¸Ð´ÐµÐ¾ Ñ Ð¶Ð¸Ð²Ð¾Ñ‚Ð½Ñ‹Ð¼Ð¸
                            MARKDOWN
                          when 'friend'
                            <<~MARKDOWN
                              ðŸ‘¥ **ÐžÐ±Ñ‰ÐµÐ½Ð¸Ðµ Ñ Ð´Ñ€ÑƒÐ³Ð¾Ð¼**

                              â€¢ ÐŸÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚Ðµ Ð±Ð»Ð¸Ð·ÐºÐ¾Ð¼Ñƒ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÑƒ
                              â€¢ ÐžÐ±ÑÑƒÐ´Ð¸Ñ‚Ðµ Ð½ÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚ÐµÐ¼Ñ‹
                              â€¢ Ð Ð°ÑÑÐ¿Ñ€Ð¾ÑÐ¸Ñ‚Ðµ Ð¾ ÐµÐ³Ð¾ Ð´ÐµÐ»Ð°Ñ…
                              â€¢ Ð’ÑÑ‚Ñ€ÐµÑ‚ÑŒÑ‚ÐµÑÑŒ Ð»Ð¸Ñ‡Ð½Ð¾, ÐµÑÐ»Ð¸ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾
                            MARKDOWN
                          when 'exercise'
                            <<~MARKDOWN
                              ðŸƒ **Ð¤Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ**

                              â€¢ Ð¡Ð´ÐµÐ»Ð°Ð¹Ñ‚Ðµ 10 Ð¿Ñ€Ð¸ÑÐµÐ´Ð°Ð½Ð¸Ð¹
                              â€¢ ÐŸÑ€Ð¾Ð¹Ð´Ð¸Ñ‚ÐµÑÑŒ Ð¿Ð¾ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ðµ
                              â€¢ Ð Ð°ÑÑ‚ÑÐ½Ð¸Ñ‚Ðµ Ð¼Ñ‹ÑˆÑ†Ñ‹
                              â€¢ ÐŸÐ¾Ð¿Ñ€Ñ‹Ð³Ð°Ð¹Ñ‚Ðµ Ð½Ð° Ð¼ÐµÑÑ‚Ðµ
                            MARKDOWN
                          when 'book'
                            <<~MARKDOWN
                              ðŸ“š **Ð§Ñ‚ÐµÐ½Ð¸Ðµ**

                              â€¢ ÐŸÑ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð¹Ñ‚Ðµ 10 ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ† ÐºÐ½Ð¸Ð³Ð¸
                              â€¢ Ð¡Ñ‚Ð°Ñ‚ÑŒÑŽ Ð² Ð¶ÑƒÑ€Ð½Ð°Ð»Ðµ
                              â€¢ Ð¦Ð¸Ñ‚Ð°Ñ‚Ñ‹ Ð¸Ð»Ð¸ Ð°Ñ„Ð¾Ñ€Ð¸Ð·Ð¼Ñ‹
                              â€¢ Ð¡Ñ‚Ð¸Ñ…Ð¸ Ð¸Ð»Ð¸ Ð¿Ñ€Ð¾Ð·Ñƒ
                            MARKDOWN
                          end
        
        send_message(text: distraction_text, parse_mode: 'Markdown')
        
        send_message(
          text: "ÐŸÐ¾Ñ‚Ñ€Ð°Ñ‚ÑŒÑ‚Ðµ 5-10 Ð¼Ð¸Ð½ÑƒÑ‚ Ð½Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ Ð·Ð°Ð½ÑÑ‚Ð¸Ðµ, Ð·Ð°Ñ‚ÐµÐ¼ Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ:",
          reply_markup: TelegramMarkupHelper.day_8_exercise_completed_markup
        )
      end
      
      # Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð• 5: ÐœÐµÑ‚Ð¾Ð´ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð´Ð½Ñ ÐŸÐžÐ¡Ð›Ð• Ð¾Ñ‚Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ
      def complete_day_after_distraction
        # Ð—Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÐ¼ Ð´ÐµÐ½ÑŒ
        @user.set_self_help_step("day_#{DAY_NUMBER}_completed")
        
        completion_text = <<~MARKDOWN
          âœ… *Ð”ÐµÐ½ÑŒ 8 ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½!* âœ…

          Ð’Ñ‹ Ð¾ÑÐ²Ð¾Ð¸Ð»Ð¸:
          1. Ð¢ÐµÑ…Ð½Ð¸ÐºÑƒ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð¼Ñ‹ÑÐ»ÐµÐ¹
          2. Ð¡Ð¿Ð¾ÑÐ¾Ð±Ñ‹ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ñ
          3. ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð½Ð°Ð²ÑÐ·Ñ‡Ð¸Ð²Ñ‹Ð¼Ð¸ Ð¼Ñ‹ÑÐ»ÑÐ¼Ð¸

          **ÐšÐ¾Ð³Ð´Ð° Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÑ‚ÑŒ:**
          â€¢ ÐŸÑ€Ð¸ Ð¿Ð¾ÑÐ²Ð»ÐµÐ½Ð¸Ð¸ Ñ‚Ñ€ÐµÐ²Ð¾Ð¶Ð½Ñ‹Ñ… Ð¼Ñ‹ÑÐ»ÐµÐ¹
          â€¢ ÐŸÐµÑ€ÐµÐ´ ÑÐ½Ð¾Ð¼, ÐµÑÐ»Ð¸ ÑƒÐ¼ Ð¿ÐµÑ€ÐµÐ³Ñ€ÑƒÐ¶ÐµÐ½
          â€¢ Ð’ ÑÑ‚Ñ€ÐµÑÑÐ¾Ð²Ñ‹Ñ… ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸ÑÑ…
          
          **ÐŸÐ¾Ð¼Ð½Ð¸Ñ‚Ðµ:** ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° Ð´ÐµÐ»Ð°ÐµÑ‚ ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ð¼!
        MARKDOWN
        
        send_message(text: completion_text, parse_mode: 'Markdown')
        
        # ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÐµÐ¼ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ Ð´ÐµÐ½ÑŒ
        propose_next_day
      end
      
      # Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð• 6: Ð¡Ñ‚Ð°Ñ€Ñ‹Ð¹ Ð¼ÐµÑ‚Ð¾Ð´ complete_exercise Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ
      # Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÐµÐ³Ð¾ Ð¸Ð»Ð¸ Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÐ¼ Ð¿ÑƒÑÑ‚Ñ‹Ð¼ Ð´Ð»Ñ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸
      def complete_exercise
        # Ð­Ñ‚Ð¾Ñ‚ Ð¼ÐµÑ‚Ð¾Ð´ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ
        # Ð’ÑÑ Ð»Ð¾Ð³Ð¸ÐºÐ° Ð¿ÐµÑ€ÐµÐ½ÐµÑÐµÐ½Ð° Ð² handle_stopped_thought Ð¸ complete_day_after_distraction
      end
      
      def should_deliver_exercise_immediately?
        false
      end
      
      def handle_exercise_consent
        deliver_exercise
      end
    end
  end
end