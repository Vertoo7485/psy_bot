# app/services/self_help/days/day_8_service.rb
module SelfHelp
  module Days
    class Day8Service < DayBaseService
      include TelegramMarkupHelper
      
      # ĞšĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹
      DAY_NUMBER = 8
      
      # Ğ¨Ğ°Ğ³Ğ¸ Ğ´Ğ½Ñ 8
      DAY_STEPS = {
        'intro' => {
          title: "ğŸ‰ *Ğ’Ğ¢ĞĞ ĞĞ¯ ĞĞ•Ğ”Ğ•Ğ›Ğ¯: ĞœĞĞ¡Ğ¢Ğ•Ğ Ğ¡Ğ¢Ğ’Ğ Ğ ĞĞ‘ĞĞ¢Ğ« Ğ¡ ĞœĞ«Ğ¡Ğ›Ğ¯ĞœĞ˜* ğŸ§ ",
          instruction: <<~MARKDOWN
            *Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²Ğ¾ Ğ²Ñ‚Ğ¾Ñ€ÑƒÑ Ğ½ĞµĞ´ĞµĞ»Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ ÑĞ°Ğ¼Ğ¾Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ¸!* ğŸŒŸ

            **ĞĞµĞ´ĞµĞ»Ñ 1:** Ğ’Ñ‹ Ğ¾ÑĞ²Ğ¾Ğ¸Ğ»Ğ¸ Ğ¾ÑĞ½Ğ¾Ğ²Ñ‹ Ğ¾ÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾ÑÑ‚Ğ¸, Ğ±Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¸ Ğ¾Ñ‚Ğ´Ñ‹Ñ…Ğ°.  
            **ĞĞµĞ´ĞµĞ»Ñ 2:** ĞœÑ‹ ÑƒĞ³Ğ»ÑƒĞ±Ğ¸Ğ¼ÑÑ Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ Ñ Ğ¼Ñ‹ÑĞ»ÑĞ¼Ğ¸ Ğ¸ ÑĞ¼Ğ¾Ñ†Ğ¸ÑĞ¼Ğ¸.

            ğŸ¯ **Ğ§ĞµĞ¼Ñƒ Ğ²Ñ‹ Ğ½Ğ°ÑƒÑ‡Ğ¸Ñ‚ĞµÑÑŒ Ğ½Ğ° ÑÑ‚Ğ¾Ğ¹ Ğ½ĞµĞ´ĞµĞ»Ğµ:**
            1. ğŸ›‘ **Ğ”ĞµĞ½ÑŒ 8:** Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ° Â«ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¼Ñ‹ÑĞ»ĞµĞ¹Â» - ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ¸Ñ€ÑƒĞµĞ¼ Ğ½Ğ°Ğ²ÑĞ·Ñ‡Ğ¸Ğ²Ñ‹Ğµ Ğ¼Ñ‹ÑĞ»Ğ¸
            2. ğŸ§  **Ğ”ĞµĞ½ÑŒ 9:** ĞšĞ¾Ğ³Ğ½Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ° - Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ¼Ñ‹ÑĞ»Ğ¸
            3. ğŸ’– **Ğ”ĞµĞ½ÑŒ 10:** Ğ­Ğ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚ - Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°ĞµĞ¼ ÑĞ²Ğ¾Ğ¸ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¸
            4. ğŸŒ **Ğ”ĞµĞ½ÑŒ 11:** Ğ—Ğ°Ğ·ĞµĞ¼Ğ»ĞµĞ½Ğ¸Ğµ - Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ÑÑ Ğ² Ğ½Ğ°ÑÑ‚Ğ¾ÑÑ‰ĞµĞµ
            5. ğŸ¤— **Ğ”ĞµĞ½ÑŒ 12:** Ğ”Ğ¾Ğ±Ñ€Ğ¾Ñ‚Ğ° Ğº ÑĞµĞ±Ğµ - Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° ÑĞ°Ğ¼Ğ¾ÑĞ¾ÑÑ‚Ñ€Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
            6. ğŸš€ **Ğ”ĞµĞ½ÑŒ 13:** ĞŸÑ€ĞµĞ¾Ğ´Ğ¾Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞºÑ€Ğ°ÑÑ‚Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ - Ğ´ĞµĞ¹ÑÑ‚Ğ²ÑƒĞµĞ¼ Ğ±ĞµĞ· Ğ¾Ñ‚ĞºĞ»Ğ°Ğ´Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ

            ğŸ“Š **ĞĞ°ÑƒÑ‡Ğ½Ñ‹Ğµ Ñ„Ğ°ĞºÑ‚Ñ‹ Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ Ñ Ğ¼Ñ‹ÑĞ»ÑĞ¼Ğ¸:**
            â€¢ ğŸ§  80% Ğ½Ğ°ÑˆĞ¸Ñ… Ğ¼Ñ‹ÑĞ»ĞµĞ¹ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€ÑÑÑ‚ÑÑ Ğ¸Ğ·Ğ¾ Ğ´Ğ½Ñ Ğ² Ğ´ĞµĞ½ÑŒ
            â€¢ ğŸ˜Œ ĞÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ½Ğ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¼Ñ‹ÑĞ»ÑĞ¼Ğ¸ ÑĞ½Ğ¸Ğ¶Ğ°ĞµÑ‚ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ½Ğ° 40-60%
            â€¢ ğŸ’¡ Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¼Ñ‹ÑĞ»ĞµĞ¹ Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ¼Ğ¾Ğ·Ğ³Ğ¾Ğ²ÑƒÑ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ·Ğ° 6-8 Ğ½ĞµĞ´ĞµĞ»ÑŒ
            â€¢ ğŸ›¡ï¸ Ğ ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ğ°Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ½ĞµĞ¹Ñ€Ğ¾Ğ½Ğ½Ñ‹Ğµ Ğ¿ÑƒÑ‚Ğ¸
            â€¢ ğŸ”„ ĞœÑ‹ÑĞ»Ğ¸ - ÑÑ‚Ğ¾ Ğ½Ğ°Ğ²Ñ‹Ğº, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ñ€Ğ°Ğ·Ğ²Ğ¸Ğ²Ğ°Ñ‚ÑŒ

            **Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ: Ğ”ĞµĞ½ÑŒ 8 - Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ° Â«ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¼Ñ‹ÑĞ»ĞµĞ¹Â»** ğŸ›‘
          MARKDOWN
        },
        'day_intro' => {
          title: "ğŸ§  *Ğ”ĞµĞ½ÑŒ 8: Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ° Â«ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¼Ñ‹ÑĞ»ĞµĞ¹Â»* ğŸ›‘",
          instruction: <<~MARKDOWN
            **Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Ğ¼Ğ¸Ñ€ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¼Ñ‹ÑˆĞ»ĞµĞ½Ğ¸ĞµĞ¼!** ğŸ’­

            Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ²Ñ‹ Ğ¾ÑĞ²Ğ¾Ğ¸Ñ‚Ğµ Ğ¼Ğ¾Ñ‰Ğ½ÑƒÑ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºÑƒ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ñ Ğ½Ğ°Ğ´ Ğ½Ğ°Ğ²ÑĞ·Ñ‡Ğ¸Ğ²Ñ‹Ğ¼Ğ¸ Ğ¸ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ¶Ğ½Ñ‹Ğ¼Ğ¸ Ğ¼Ñ‹ÑĞ»ÑĞ¼Ğ¸.

            ğŸ“Š **ĞĞ°ÑƒÑ‡Ğ½Ñ‹Ğµ Ñ„Ğ°ĞºÑ‚Ñ‹ Ğ¾ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞµ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹:**
            â€¢ ğŸ§  Ğ¡Ğ½Ğ¸Ğ¶Ğ°ĞµÑ‚ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¼Ğ¸Ğ½Ğ´Ğ°Ğ»Ğ¸Ğ½Ñ‹ (Ñ†ĞµĞ½Ñ‚Ñ€ ÑÑ‚Ñ€Ğ°Ñ…Ğ°) Ğ½Ğ° 25-30%
            â€¢ ğŸ˜Œ Ğ£Ğ¼ĞµĞ½ÑŒÑˆĞ°ĞµÑ‚ Ñ€ÑƒĞ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ (Ğ¼Ñ‹ÑĞ»ĞµĞ½Ğ½ÑƒÑ Ğ¶Ğ²Ğ°Ñ‡ĞºÑƒ) Ğ½Ğ° 40-50%
            â€¢ ğŸ’¡ ĞŸĞ¾Ğ²Ñ‹ÑˆĞ°ĞµÑ‚ ĞºĞ¾Ğ½Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ Ğ½Ğ° 20-25%
            â€¢ ğŸ›¡ï¸ Ğ­Ñ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ° Ğ¿Ñ€Ğ¸ ĞĞšĞ , Ñ‚Ñ€ĞµĞ²Ğ¾Ğ³Ğµ Ğ¸ ĞŸĞ¢Ğ¡Ğ  Ğ¿Ğ¾ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹
            â€¢ ğŸ”„ ĞŸĞµÑ€ĞµĞ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ Ğ½ĞµĞ¹Ñ€Ğ¾Ğ½Ğ½Ñ‹Ğµ Ğ¿ÑƒÑ‚Ğ¸ Ğ·Ğ° 6-8 Ğ½ĞµĞ´ĞµĞ»ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
            â€¢ â±ï¸ ĞŸĞµÑ€Ğ²Ñ‹Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ·Ğ°Ğ¼ĞµÑ‚Ğ½Ñ‹ ÑƒĞ¶Ğµ Ñ‡ĞµÑ€ĞµĞ· 2-3 Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ

            ğŸ¯ **Ğ§Ñ‚Ğ¾ Ğ²Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚Ğµ Ğ¾Ñ‚ ÑĞµĞ³Ğ¾Ğ´Ğ½ÑÑˆĞ½ĞµĞ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:**
            1. ğŸ›‘ ĞĞ°Ğ²Ñ‹Ğº Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ½ĞµĞ³Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ¼Ñ‹ÑĞ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°
            2. ğŸ”„ Ğ£Ğ¼ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°Ñ‚ÑŒ Ñ„Ğ¾ĞºÑƒÑ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğµ
            3. ğŸ˜Œ Ğ§ÑƒĞ²ÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ñ Ğ½Ğ°Ğ´ ÑĞ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ¼Ñ‹ÑĞ»ÑĞ¼Ğ¸
            4. ğŸ’ª Ğ£ĞºÑ€ĞµĞ¿Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ³Ğ½Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğ¹ Ğ³Ğ¸Ğ±ĞºĞ¾ÑÑ‚Ğ¸
            5. ğŸ›¡ï¸ Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ñƒ Ğ¾Ñ‚ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¸ÑÑ‚Ğ¾Ñ‰ĞµĞ½Ğ¸Ñ
          MARKDOWN
        },
        'exercise_explanation' => {
          title: "ğŸ›‘ *Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ° Â«ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¼Ñ‹ÑĞ»ĞµĞ¹Â»: ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼* ğŸ“‹",
          instruction: <<~MARKDOWN
            **ĞšĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ° Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹?** ğŸ”„

            ĞšĞ¾Ğ³Ğ´Ğ° Ğ¼Ñ‹ ÑĞ¾Ğ·Ğ½Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ¿Ñ€ĞµÑ€Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ½ĞµĞ³Ğ°Ñ‚Ğ¸Ğ²Ğ½ÑƒÑ Ğ¼Ñ‹ÑĞ»ÑŒ, Ğ¼Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ½ĞµĞ¹Ñ€Ğ¾Ğ½Ğ½Ñ‹Ğµ ÑĞ²ÑĞ·Ğ¸:

            â€¢ ğŸ§  **ĞĞµĞ¹Ñ€Ğ¾Ğ±Ğ¸Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ„Ñ„ĞµĞºÑ‚:** ĞĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ñ€ĞµÑ„Ñ€Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½ÑƒÑ ĞºĞ¾Ñ€Ñƒ (ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ) Ğ¸ Ğ¿Ğ¾Ğ´Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¼Ğ¸Ğ½Ğ´Ğ°Ğ»Ğ¸Ğ½Ñ‹
            â€¢ ğŸ”„ **ĞšĞ¾Ğ³Ğ½Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ°:** ĞŸÑ€ĞµÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½ Ñ€ÑƒĞ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¾ÑÑ‚Ñ€Ğ°Ğ½ÑÑ‚Ğ²Ğ¾ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° Ñ€ĞµĞ°ĞºÑ†Ğ¸Ğ¸
            â€¢ ğŸ˜Œ **Ğ­Ğ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ:** Ğ¡Ğ½Ğ¸Ğ¶Ğ°ĞµÑ‚ Ğ¸Ğ½Ñ‚ĞµĞ½ÑĞ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ½ĞµĞ³Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¹
            â€¢ ğŸ’¡ **ĞŸĞ¾Ğ²ĞµĞ´ĞµĞ½Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ„Ñ„ĞµĞºÑ‚:** ĞŸÑ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑÑĞºĞ°Ğ»Ğ°Ñ†Ğ¸Ñ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ³Ğ¸
            â€¢ â±ï¸ **ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ:** Ğ—Ğ°Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ²ÑĞµĞ³Ğ¾ 30-60 ÑĞµĞºÑƒĞ½Ğ´

            **4-ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹:**
            1. ğŸ‘ï¸ **ĞÑĞ¾Ğ·Ğ½Ğ°Ğ½Ğ¸Ğµ** - Ğ—Ğ°Ğ¼ĞµÑ‡Ğ°ĞµĞ¼ Ğ¼Ñ‹ÑĞ»ÑŒ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
            2. ğŸ›‘ **ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°** - Ğ”Ğ°ĞµĞ¼ Ñ‡ĞµÑ‚ĞºĞ¸Ğ¹ ÑĞ¸Ğ³Ğ½Ğ°Ğ» "Ğ¡Ğ¢ĞĞŸ!"
            3. ğŸ”„ **ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ** - ĞĞµĞ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ğ¾ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ¸Ğ¼ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ
            4. ğŸ¯ **Ğ—Ğ°ĞºÑ€ĞµĞ¿Ğ»ĞµĞ½Ğ¸Ğµ** - Ğ£Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ñ„Ğ¾ĞºÑƒÑĞ½Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ

            **Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½ÑÑˆĞ½ĞµĞµ ÑƒĞ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ:** ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ³Ğ¾ 4-ÑˆĞ°Ğ³Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ°.
            Ğ¦ĞµĞ»ÑŒ â€” Ğ½Ğµ Ğ¿Ğ¾Ğ´Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼Ñ‹ÑĞ»Ğ¸, Ğ° Ğ½Ğ°ÑƒÑ‡Ğ¸Ñ‚ÑŒÑÑ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ¸Ğ¼Ğ¸.
          MARKDOWN
        },
        'practice_guidance' => {
          title: "ğŸ“‹ *ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğº Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹* ğŸ§˜",
          instruction: <<~MARKDOWN
            **ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:**

            ğŸ§  **ĞœĞµĞ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°:**
            â€¢ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ½ĞµĞ¹Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½ÑƒÑ Ğ¸Ğ»Ğ¸ ÑƒĞ¼ĞµÑ€ĞµĞ½Ğ½Ğ¾ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ¶Ğ½ÑƒÑ Ğ¼Ñ‹ÑĞ»ÑŒ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
            â€¢ ĞĞµ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°Ğ¹Ñ‚Ğµ Ñ ÑĞ°Ğ¼Ñ‹Ñ… Ğ¿ÑƒĞ³Ğ°ÑÑ‰Ğ¸Ñ… Ğ¼Ñ‹ÑĞ»ĞµĞ¹
            â€¢ Ğ‘ÑƒĞ´ÑŒÑ‚Ğµ Ğ´Ğ¾Ğ±Ñ€Ñ‹ Ğº ÑĞµĞ±Ğµ â€” ÑÑ‚Ğ¾ Ğ½Ğ°Ğ²Ñ‹Ğº, Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
            â€¢ ĞÑ‚ĞºĞ°Ğ¶Ğ¸Ñ‚ĞµÑÑŒ Ğ¾Ñ‚ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ ÑĞ¾Ğ²ĞµÑ€ÑˆĞµĞ½ÑÑ‚Ğ²Ğ°

            ğŸ›‘ **Ğ¡Ñ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ñ‹ (Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ğ´Ğ¸Ğ½):**
            â€¢ Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾Ğµ Ğ¼Ñ‹ÑĞ»ĞµĞ½Ğ½Ğ¾Ğµ "Ğ¡Ğ¢ĞĞŸ!" 
            â€¢ ĞŸÑ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºÑ€Ğ°ÑĞ½Ğ¾Ğ³Ğ¾ ÑÑ‚Ğ¾Ğ¿-Ğ·Ğ½Ğ°ĞºĞ°
            â€¢ Ğ©ĞµĞ»Ñ‡Ğ¾Ğº Ğ¿Ğ°Ğ»ÑŒÑ†Ğ°Ğ¼Ğ¸ Ğ¸Ğ»Ğ¸ Ñ…Ğ»Ğ¾Ğ¿Ğ¾Ğº Ğ² Ğ»Ğ°Ğ´Ğ¾ÑˆĞ¸
            â€¢ Ğ ĞµĞ·ĞºĞ¸Ğ¹ Ğ·Ğ²ÑƒĞº (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ±ÑƒĞ´Ğ¸Ğ»ÑŒĞ½Ğ¸Ğº)
            â€¢ Ğ›ÑĞ±Ğ¾Ğ¹ Ñ‡ĞµÑ‚ĞºĞ¸Ğ¹, Ğ¾Ğ´Ğ½Ğ¾Ğ·Ğ½Ğ°Ñ‡Ğ½Ñ‹Ğ¹ ÑĞ¸Ğ³Ğ½Ğ°Ğ»

            ğŸ”„ **Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ (Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ÑŒÑ‚Ğµ Ğ·Ğ°Ñ€Ğ°Ğ½ĞµĞµ):**
            â€¢ Ğ”Ñ‹Ñ…Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ
            â€¢ Ğ¤Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ
            â€¢ Ğ¡ĞµĞ½ÑĞ¾Ñ€Ğ½Ğ¾Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ (5-4-3-2-1)
            â€¢ ĞšĞ¾Ğ³Ğ½Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° (ÑÑ‡ĞµÑ‚, Ğ°Ğ»Ñ„Ğ°Ğ²Ğ¸Ñ‚)

            **Ğ’Ğ°Ğ¶Ğ½Ğ¾:** Ğ£ÑĞ¿ĞµÑ… Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚Ğ¸ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ÑĞ»Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ "Ğ¡Ğ¢ĞĞŸ!"
          MARKDOWN
        },
        'post_practice_reflection' => {
          title: "ğŸ“ *Ğ ĞµÑ„Ğ»ĞµĞºÑĞ¸Ñ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸* ğŸ’­",
          instruction: <<~MARKDOWN
            **ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°! Ğ’Ñ‹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹!** ğŸŒŸ

            **Ğ’Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ´Ğ»Ñ Ñ€ĞµÑ„Ğ»ĞµĞºÑĞ¸Ğ¸:**

            ğŸ›‘ **1. Ğ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞµ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸:**
            â€¢ ĞĞ°ÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ñ‡ĞµÑ‚ĞºĞ¾ ÑÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ»Ğ° ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° "Ğ¡Ğ¢ĞĞŸ"?
            â€¢ ĞšĞ°Ğº Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ?
            â€¢ Ğ§Ñ‚Ğ¾ Ñ‡ÑƒĞ²ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ»Ğ¸ Ğ² Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»Ğ¸?
            â€¢ Ğ‘Ñ‹Ğ»Ğ¾ Ğ»Ğ¸ ÑĞ¾Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¸Ğ»Ğ¸ Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚Ğ¸?

            ğŸ”„ **2. Ğ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ:**
            â€¢ ĞĞ°ÑĞºĞ¾Ğ»ÑŒĞºĞ¾ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ ÑÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ»Ğ¾ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ?
            â€¢ Ğ£Ğ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ»Ğ¸ ÑƒĞ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ñ„Ğ¾ĞºÑƒÑĞ½Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ?
            â€¢ ĞšĞ°Ğº Ğ´Ğ¾Ğ»Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ»Ğ¾ÑÑŒ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ?
            â€¢ ĞšĞ°ĞºĞ¸Ğµ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ±Ñ‹Ğ»Ğ¸ Ğ½Ğ°Ğ¸Ğ±Ğ¾Ğ»ĞµĞµ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹?

            ğŸ§  **3. ĞĞ± Ğ¾Ğ±Ñ‰ĞµĞ¼ ÑÑ„Ñ„ĞµĞºÑ‚Ğµ:**
            â€¢ ĞšĞ°Ğº Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»Ğ¾ÑÑŒ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸?
            â€¢ Ğ§ÑƒĞ²ÑÑ‚Ğ²ÑƒĞµÑ‚Ğµ Ğ»Ğ¸ Ğ²Ñ‹ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ñ Ğ½Ğ°Ğ´ Ğ¼Ñ‹ÑĞ»ÑĞ¼Ğ¸?
            â€¢ ĞšĞ°ĞºĞ¸Ğµ Ğ¸Ğ½ÑĞ°Ğ¹Ñ‚Ñ‹ Ğ¿Ñ€Ğ¸ÑˆĞ»Ğ¸ Ğ² Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞµ?
            â€¢ Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğ»Ğ¸ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºÑƒ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞ¸Ñ‚ÑƒĞ°Ñ†Ğ¸ÑÑ…?
          MARKDOWN
        }
      }.freeze
      
      # Ğ¢Ğ¸Ğ¿Ñ‹ ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ¾Ğ²
      STOP_SIGNALS = [
        {
          name: "ĞœÑ‹ÑĞ»ĞµĞ½Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°",
          emoji: "ğŸ—£ï¸",
          description: "Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾Ğµ Ğ¸ Ñ‡ĞµÑ‚ĞºĞ¾Ğµ Ğ¼Ñ‹ÑĞ»ĞµĞ½Ğ½Ğ¾Ğµ Â«Ğ¡Ğ¢ĞĞŸ!Â». ĞŸÑ€Ğ¾ÑÑ‚Ğ¾, ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾, Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ Ğ²ÑĞµĞ³Ğ´Ğ°.",
          instructions: "ĞœÑ‹ÑĞ»ĞµĞ½Ğ½Ğ¾ Ğ¿Ñ€Ğ¾ĞºÑ€Ğ¸Ñ‡Ğ¸Ñ‚Ğµ Â«Ğ¡Ğ¢ĞĞŸ!Â» ĞºĞ°Ğº Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ³Ñ€Ğ¾Ğ¼Ñ‡Ğµ Ğ¸ ÑƒĞ²ĞµÑ€ĞµĞ½Ğ½ĞµĞµ"
        },
        {
          name: "Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ·",
          emoji: "ğŸ›‘",
          description: "ĞŸÑ€ĞµĞ´ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¹ Ğ·Ğ½Ğ°Ğº Â«Ğ¡Ğ¢ĞĞŸÂ» Ğ¸Ğ»Ğ¸ Ğ²Ğ¾Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµĞ¼ÑƒÑ ÑÑ‚ĞµĞ½Ñƒ.",
          instructions: "Ğ¯Ñ€ĞºĞ¾ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¾Ğ¿-Ğ·Ğ½Ğ°Ğº, Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒÑÑ‰Ğ¸Ğ¹ Ğ¼Ñ‹ÑĞ»ÑŒ"
        },
        {
          name: "Ğ¤Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑĞ¸Ğ³Ğ½Ğ°Ğ»",
          emoji: "ğŸ‘",
          description: "Ğ¥Ğ»Ğ¾Ğ¿Ğ¾Ğº Ğ² Ğ»Ğ°Ğ´Ğ¾ÑˆĞ¸, Ñ‰ĞµĞ»Ñ‡Ğ¾Ğº Ğ¿Ğ°Ğ»ÑŒÑ†Ğ°Ğ¼Ğ¸, Ğ»ĞµĞ³ĞºĞ¸Ğ¹ Ñ‰Ğ¸Ğ¿Ğ¾Ğº ÑĞµĞ±Ñ Ğ·Ğ° Ñ€ÑƒĞºÑƒ.",
          instructions: "Ğ¡Ğ´ĞµĞ»Ğ°Ğ¹Ñ‚Ğµ Ñ€ĞµĞ·ĞºĞ¸Ğ¹ Ñ„Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¶ĞµÑÑ‚ Ğ¾Ğ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾ Ñ Ğ¼Ñ‹ÑĞ»ĞµĞ½Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¾Ğ¹"
        },
        {
          name: "Ğ—Ğ²ÑƒĞºĞ¾Ğ²Ğ¾Ğ¹ ÑĞ¸Ğ³Ğ½Ğ°Ğ»",
          emoji: "ğŸ”Š",
          description: "Ğ ĞµĞ·ĞºĞ¸Ğ¹ Ğ·Ğ²ÑƒĞº (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ±ÑƒĞ´Ğ¸Ğ»ÑŒĞ½Ğ¸Ğº, Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€ Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ ÑĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ²ÑĞ»ÑƒÑ…).",
          instructions: "Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ğ·Ğ²ÑƒĞº ĞºĞ°Ğº Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€ Ğ´Ğ»Ñ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°"
        },
        {
          name: "Ğ”Ñ‹Ñ…Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¾Ğ¿",
          emoji: "ğŸŒ¬ï¸",
          description: "Ğ ĞµĞ·ĞºĞ¸Ğ¹ Ğ²Ğ´Ğ¾Ñ… Ğ¸ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ´Ñ‹Ñ…Ğ°Ğ½Ğ¸Ñ Ğ½Ğ° 2-3 ÑĞµĞºÑƒĞ½Ğ´Ñ‹.",
          instructions: "Ğ¡Ğ´ĞµĞ»Ğ°Ğ¹Ñ‚Ğµ Ñ€ĞµĞ·ĞºĞ¸Ğ¹ Ğ²Ğ´Ğ¾Ñ… Ğ¸ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚Ğµ Ğ´Ñ‹Ñ…Ğ°Ğ½Ğ¸Ğµ, Ñ„Ğ¾ĞºÑƒÑĞ¸Ñ€ÑƒÑÑÑŒ Ğ½Ğ° Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞµ"
        },
        {
          name: "Ğ”Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ-ÑÑ‚Ğ¾Ğ¿",
          emoji: "âœ‹",
          description: "Ğ ĞµĞ·ĞºĞ¸Ğ¹ Ğ¶ĞµÑÑ‚ Ñ€ÑƒĞºĞ¾Ğ¹ Â«ÑÑ‚Ğ¾Ğ¿Â» Ğ¸Ğ»Ğ¸ Ğ²ÑÑ‚Ğ°Ğ²Ğ°Ğ½Ğ¸Ğµ/ÑĞ¼ĞµĞ½Ğ° Ğ¿Ğ¾Ğ·Ñ‹.",
          instructions: "Ğ¡Ğ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ñ‚Ğµ Ğ¼Ñ‹ÑĞ»ĞµĞ½Ğ½ÑƒÑ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñƒ Ñ Ñ€ĞµĞ·ĞºĞ¸Ğ¼ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸ĞµĞ¼ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ñ‚ĞµĞ»Ğ°"
        }
      ].freeze
      
      # Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ
      DISTRACTION_STRATEGIES = [
        {
          name: "Ğ”Ñ‹Ñ…Ğ°Ğ½Ğ¸Ğµ 4-7-8",
          emoji: "ğŸŒ¬ï¸",
          description: "4 ÑĞµĞºÑƒĞ½Ğ´Ñ‹ Ğ²Ğ´Ğ¾Ñ… â†’ 7 ÑĞµĞºÑƒĞ½Ğ´ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° â†’ 8 ÑĞµĞºÑƒĞ½Ğ´ Ğ²Ñ‹Ğ´Ğ¾Ñ….",
          duration: "2-3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹",
          effectiveness: "Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ, ÑƒÑĞ¿Ğ¾ĞºĞ°Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ½ĞµÑ€Ğ²Ğ½ÑƒÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ"
        },
        {
          name: "Ğ¡ĞµĞ½ÑĞ¾Ñ€Ğ½Ğ¾Ğµ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ",
          emoji: "ğŸ‘ï¸",
          description: "5 Ğ²ĞµÑ‰ĞµĞ¹ Ğ²Ğ¸Ğ¶Ñƒ â†’ 4 Ğ²ĞµÑ‰Ğ¸ ÑĞ»Ñ‹ÑˆÑƒ â†’ 3 Ğ²ĞµÑ‰Ğ¸ Ñ‡ÑƒĞ²ÑÑ‚Ğ²ÑƒÑ â†’ 2 Ğ·Ğ°Ğ¿Ğ°Ñ…Ğ° â†’ 1 Ğ²ĞºÑƒÑ.",
          duration: "1-2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹",
          effectiveness: "ĞÑ‡ĞµĞ½ÑŒ Ğ²Ñ‹ÑĞ¾ĞºĞ°Ñ, Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Ñ„Ğ¾ĞºÑƒÑ"
        },
        {
          name: "Ğ¤Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ",
          emoji: "ğŸƒ",
          description: "10 Ğ¿Ñ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ğ¹, Ğ¿Ñ€Ñ‹Ğ¶ĞºĞ¸, Ñ€Ğ°ÑÑ‚ÑĞ¶ĞºĞ°, Ğ¿Ñ€Ğ¾Ğ³ÑƒĞ»ĞºĞ° Ğ¿Ğ¾ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğµ.",
          duration: "2-3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹",
          effectiveness: "Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ğ¼Ñ‹ÑˆĞµÑ‡Ğ½ÑƒÑ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ"
        },
        {
          name: "Ğ¡Ñ‡ĞµÑ‚ Ğ¸Ğ»Ğ¸ Ğ°Ğ»Ñ„Ğ°Ğ²Ğ¸Ñ‚",
          emoji: "ğŸ”¢",
          description: "Ğ¡Ñ‡ĞµÑ‚ Ğ¾Ñ‚ 100 Ğ½Ğ°Ğ·Ğ°Ğ´ Ñ‡ĞµÑ€ĞµĞ· 3, Ğ¿ĞµÑ€ĞµÑ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ğ³Ğ¾Ñ€Ğ¾Ğ´Ğ¾Ğ² Ğ½Ğ° Ğ±ÑƒĞºĞ²Ñƒ Ğ Ğ¸ Ñ‚.Ğ´.",
          duration: "1-2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹",
          effectiveness: "Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ, Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ ĞºĞ¾Ğ³Ğ½Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ÑƒÑĞ¸Ğ»Ğ¸Ğ¹"
        },
        {
          name: "ĞšÑ€ĞµĞ°Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°",
          emoji: "ğŸ¨",
          description: "ĞĞ°Ñ€Ğ¸ÑĞ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾, ÑĞ¾Ñ‡Ğ¸Ğ½Ğ¸Ñ‚ÑŒ Ñ€Ğ¸Ñ„Ğ¼Ñƒ, Ğ¿Ñ€Ğ¸Ğ´ÑƒĞ¼Ğ°Ñ‚ÑŒ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ.",
          duration: "3-5 Ğ¼Ğ¸Ğ½ÑƒÑ‚",
          effectiveness: "Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ, Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¿Ğ¾Ğ³Ğ»Ğ¾Ñ‰Ğ°ĞµÑ‚ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ"
        },
        {
          name: "Ğ’Ğ½ĞµÑˆĞ½Ğ¸Ğ¹ Ñ„Ğ¾ĞºÑƒÑ",
          emoji: "ğŸŒ³",
          description: "Ğ Ğ°ÑÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ÑƒĞ·Ğ¾Ñ€ Ğ½Ğ° Ğ¾Ğ±Ğ¾ÑÑ…, Ğ¾Ğ±Ğ»Ğ°ĞºĞ°, Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ¼ĞµÑ‚Ğ°.",
          duration: "1-2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹",
          effectiveness: "Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ, Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ"
        }
      ].freeze
      
      # Ğ¢Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚Ğ¸
      COMMON_CHALLENGES = [
        {
          challenge: "ĞœÑ‹ÑĞ»ÑŒ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ ÑÑ€Ğ°Ğ·Ñƒ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸",
          emoji: "ğŸŒ€",
          solution: "Ğ­Ñ‚Ğ¾ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾! Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡ÑŒÑ‚Ğµ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ. ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ÑŒÑ‚Ğµ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ—ĞĞ ĞĞĞ•Ğ•, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑÑ€Ğ°Ğ·Ñƒ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ."
        },
        {
          challenge: "Ğ§ÑƒĞ²ÑÑ‚Ğ²ÑƒÑ ÑĞµĞ±Ñ Ğ³Ğ»ÑƒĞ¿Ğ¾, Ğ³Ğ¾Ğ²Ğ¾Ñ€Ñ Â«Ğ¡Ğ¢ĞĞŸÂ»",
          emoji: "ğŸ˜³",
          solution: "ĞĞ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ Ñ Ğ¼Ñ‹ÑĞ»ĞµĞ½Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°. ĞŸĞ¾Ğ¼Ğ½Ğ¸Ñ‚Ğµ: ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ²Ğ°Ğ¶Ğ½ĞµĞµ, Ñ‡ĞµĞ¼ Ñ‚Ğ¾, ĞºĞ°Ğº ÑÑ‚Ğ¾ Ğ²Ñ‹Ğ³Ğ»ÑĞ´Ğ¸Ñ‚ ÑĞ¾ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñ‹."
        },
        {
          challenge: "ĞĞµ Ğ¼Ğ¾Ğ³Ñƒ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ÑƒÑ Ğ¼Ñ‹ÑĞ»ÑŒ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸",
          emoji: "ğŸ¤”",
          solution: "ĞĞ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ Ñ Ğ½ĞµĞ¹Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¼Ñ‹ÑĞ»Ğ¸ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, Â«Ğ§Ñ‚Ğ¾ Ñ Ğ±ÑƒĞ´Ñƒ ĞµÑÑ‚ÑŒ Ğ½Ğ° ÑƒĞ¶Ğ¸Ğ½?Â»). ĞĞµ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°Ñ‚ÑŒ Ñ ÑĞ°Ğ¼Ñ‹Ñ… Ñ‚Ñ€ÑƒĞ´Ğ½Ñ‹Ñ…."
        },
        {
          challenge: "Ğ¡Ñ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ» Ğ½Ğµ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚",
          emoji: "ğŸ”„",
          solution: "ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ñ‚Ğ¸Ğ¿ ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ°. Ğ˜Ğ½Ğ¾Ğ³Ğ´Ğ° Ñ„Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¶ĞµÑÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ»ÑƒÑ‡ÑˆĞµ, Ñ‡ĞµĞ¼ Ğ¼Ñ‹ÑĞ»ĞµĞ½Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°."
        }
      ].freeze
      
      # ===== ĞŸĞ£Ğ‘Ğ›Ğ˜Ğ§ĞĞ«Ğ• ĞœĞ•Ğ¢ĞĞ”Ğ« =====
      
      def deliver_intro
        # Ğ¨Ğ°Ğ³ 1: Ğ’ÑÑ‚ÑƒĞ¿Ğ»ĞµĞ½Ğ¸Ğµ Ğ²Ğ¾ Ğ²Ñ‚Ğ¾Ñ€ÑƒÑ Ğ½ĞµĞ´ĞµĞ»Ñ
        send_message(text: DAY_STEPS['intro'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['intro'][:instruction], parse_mode: 'Markdown')
        
        # Ğ¨Ğ°Ğ³ 2: Ğ’ÑÑ‚ÑƒĞ¿Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ½Ñ 8
        send_message(text: DAY_STEPS['day_intro'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['day_intro'][:instruction], parse_mode: 'Markdown')
        
        # Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ´Ğ»Ñ Ğ¼Ğ¾Ñ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ğ¸
        send_message(
          text: statistics_message,
          parse_mode: 'Markdown'
        )
        
        @user.set_self_help_step("day_#{DAY_NUMBER}_intro")
        store_day_data('current_step', 'intro')
        
        send_message(
          text: "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğ¾ÑĞ²Ğ¾Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºÑƒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¼Ñ‹ÑĞ»ÑĞ¼Ğ¸ Ğ¸ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ²Ñ‚Ğ¾Ñ€ÑƒÑ Ğ½ĞµĞ´ĞµĞ»Ñ?",
          reply_markup: day_8_content_markup
        )
      end
      
      def deliver_exercise
        @user.set_self_help_step("day_#{DAY_NUMBER}_exercise_in_progress")
        store_day_data('current_step', 'exercise_explanation')
        
        send_message(text: DAY_STEPS['exercise_explanation'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['exercise_explanation'][:instruction], parse_mode: 'Markdown')
        
        send_message(
          text: "ğŸ›‘ **Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ‚Ğ¸Ğ¿ ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ° Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:**",
          parse_mode: 'Markdown',
          reply_markup: day_8_stop_signals_markup
        )
      end
      
      # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ°
      def handle_stop_signal_selection(signal_index)
        signal = STOP_SIGNALS[signal_index.to_i]
        
        if signal
          store_day_data('selected_stop_signal', signal)
          
          send_message(
            text: "âœ… Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½ ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»: #{signal[:emoji]} *#{signal[:name]}*\n\n#{signal[:description]}",
            parse_mode: 'Markdown'
          )
          
          send_message(
            text: "ğŸ“‹ **Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ:** #{signal[:instructions]}",
            parse_mode: 'Markdown'
          )
          
          # ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¸Ğ¼ Ğº Ğ²Ñ‹Ğ±Ğ¾Ñ€Ñƒ Ğ¼Ñ‹ÑĞ»Ğ¸
          sleep(1)
          show_thought_selection_guidance
        else
          send_message(text: "âš ï¸ ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ğ¹ ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ». ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¸Ğ· Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ½Ñ‹Ñ….")
        end
      end
      
      def show_thought_selection_guidance
        store_day_data('current_step', 'thought_selection')
        
        guidance_text = <<~MARKDOWN
          ğŸ¤” *Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¼Ñ‹ÑĞ»Ğ¸ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸*

          **Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ñƒ:**

          ğŸŸ¢ **Ğ”Ğ»Ñ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ÑÑ‰Ğ¸Ñ… (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ):**
          â€¢ ĞĞµĞ¹Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¼Ñ‹ÑĞ»ÑŒ (Â«Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¸Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ° ÑƒĞ¶Ğ¸Ğ½?Â»)
          â€¢ ĞŸĞ¾Ğ²ÑĞµĞ´Ğ½ĞµĞ²Ğ½Ğ°Ñ Ğ·Ğ°Ğ±Ğ¾Ñ‚Ğ° (Â«ĞĞµ Ğ·Ğ°Ğ±Ñ‹Ñ‚ÑŒ ĞºÑƒĞ¿Ğ¸Ñ‚ÑŒ Ğ¼Ğ¾Ğ»Ğ¾ĞºĞ¾Â»)
          â€¢ Ğ›ĞµĞ³ĞºĞ¾Ğµ Ğ±ĞµÑĞ¿Ğ¾ĞºĞ¾Ğ¹ÑÑ‚Ğ²Ğ¾ (Â«ĞĞ¿Ğ¾Ğ·Ğ´Ğ°Ñ Ğ»Ğ¸ Ñ Ğ½Ğ° Ğ²ÑÑ‚Ñ€ĞµÑ‡Ñƒ?Â»)

          ğŸŸ¡ **Ğ”Ğ»Ñ ÑÑ€ĞµĞ´Ğ½ĞµĞ³Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ:**
          â€¢ Ğ£Ğ¼ĞµÑ€ĞµĞ½Ğ½Ğ¾ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ¶Ğ½Ğ°Ñ Ğ¼Ñ‹ÑĞ»ÑŒ
          â€¢ ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€ÑÑÑ‰Ğ°ÑÑÑ, Ğ½Ğ¾ Ğ½Ğµ Ñ€Ğ°Ğ·Ñ€ÑƒÑˆĞ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¼Ñ‹ÑĞ»ÑŒ
          â€¢ ĞœÑ‹ÑĞ»ÑŒ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ»ĞµĞ³ĞºĞ¾Ğµ Ğ±ĞµÑĞ¿Ğ¾ĞºĞ¾Ğ¹ÑÑ‚Ğ²Ğ¾

          ğŸ”´ **ĞĞµ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:**
          â€¢ Ğ¢Ñ€Ğ°Ğ²Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ²Ğ¾ÑĞ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ½Ğ¸Ñ
          â€¢ Ğ¡Ğ¸Ğ»ÑŒĞ½Ğ¾ Ğ¿ÑƒĞ³Ğ°ÑÑ‰Ğ¸Ğµ Ğ¼Ñ‹ÑĞ»Ğ¸
          â€¢ ĞœÑ‹ÑĞ»Ğ¸, Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ÑÑ‰Ğ¸Ğµ Ğ¿Ğ°Ğ½Ğ¸ĞºÑƒ

          *Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¼Ñ‹ÑĞ»ÑŒ Ğ¸Ğ· ğŸŸ¢ Ğ¸Ğ»Ğ¸ ğŸŸ¡ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ´Ğ»Ñ ÑĞµĞ³Ğ¾Ğ´Ğ½ÑÑˆĞ½ĞµĞ¹ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸.*
        MARKDOWN
        
        send_message(text: guidance_text, parse_mode: 'Markdown')
        
        send_message(
          text: "ğŸ’­ *ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ¼Ñ‹ÑĞ»ÑŒ, ĞºĞ¾Ñ‚Ğ¾Ñ€ÑƒÑ Ğ±ÑƒĞ´ĞµÑ‚Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:*",
          parse_mode: 'Markdown'
        )
        
        # Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ Ğ²Ğ²Ğ¾Ğ´Ğ° Ğ¼Ñ‹ÑĞ»Ğ¸
        @user.set_self_help_step("day_#{DAY_NUMBER}_waiting_for_thought")
      end
      
      def handle_thought_input(thought_text)
        return false if thought_text.blank?
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ğ½Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ» Ğ»Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ÑƒĞ¶Ğµ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ
        if get_day_data('practice_completed') == true
          send_message(
            text: "âš ï¸ Ğ’Ñ‹ ÑƒĞ¶Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹. Ğ§Ñ‚Ğ¾Ğ±Ñ‹ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¼Ñ‹ÑĞ»ÑŒ, Ğ½Ğ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾.",
            reply_markup: day_8_final_completion_markup
          )
          return false
        end
        
        store_day_data('practice_thought', thought_text)
        store_day_data('thought_received_at', Time.current)
        
        send_message(
          text: "âœ… ĞœÑ‹ÑĞ»ÑŒ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ°: \"#{thought_text.truncate(50)}...\"",
          parse_mode: 'Markdown'
        )
        
        # ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¸Ğ¼ Ğº Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ
        sleep(1)
        start_practice_session
        
        true
      end
      
      def start_practice_session
        store_day_data('current_step', 'practice_session')
        selected_signal = get_day_data('selected_stop_signal') || {}
        practice_thought = get_day_data('practice_thought') || "Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ğ°Ñ Ğ¼Ñ‹ÑĞ»ÑŒ"
        
        practice_instructions = <<~MARKDOWN
          ğŸ¬ *ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹!*

          **ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ°:**
          1. ğŸ§  Ğ’ÑĞ¿Ğ¾Ğ¼Ğ½Ğ¸Ñ‚Ğµ Ğ¼Ñ‹ÑĞ»ÑŒ: "#{practice_thought.truncate(30)}..."
          2. ğŸ›‘ ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ÑŒÑ‚Ğµ ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»: #{selected_signal[:emoji]} #{selected_signal[:name]}
          3. ğŸ”„ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ (ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³)

          **ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:**
          1. ĞŸĞ¾Ğ·Ğ²Ğ¾Ğ»ÑŒÑ‚Ğµ Ğ¼Ñ‹ÑĞ»Ğ¸ Ğ¿Ğ¾ÑĞ²Ğ¸Ñ‚ÑŒÑÑ (5-10 ÑĞµĞºÑƒĞ½Ğ´)
          2. ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»
          3. ĞĞ•ĞœĞ•Ğ”Ğ›Ğ•ĞĞĞ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ
          4. Ğ£Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ 1-2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹

          **Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ?**
        MARKDOWN
        
        send_message(text: practice_instructions, parse_mode: 'Markdown')
        
        send_message(
          text: "ğŸ”„ **Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ:**",
          parse_mode: 'Markdown',
          reply_markup: day_8_distraction_strategies_markup
        )
      end
      
      def handle_distraction_selection(strategy_index)
        strategy = DISTRACTION_STRATEGIES[strategy_index.to_i]
        
        if strategy
          store_day_data('selected_distraction_strategy', strategy)
          
          send_message(
            text: "âœ… Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ° ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ: #{strategy[:emoji]} *#{strategy[:name]}*\n\n#{strategy[:description]}",
            parse_mode: 'Markdown'
          )
          
          send_message(
            text: "â±ï¸ **Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ:** #{strategy[:duration]}\n**Ğ­Ñ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ:** #{strategy[:effectiveness]}",
            parse_mode: 'Markdown'
          )
          
          # ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
          start_practice_timer
        else
          send_message(text: "âš ï¸ ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¸Ğ· Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ½Ñ‹Ñ….")
        end
      end
      
      def start_practice_timer
        selected_strategy = get_day_data('selected_distraction_strategy') || {}
        duration = selected_strategy[:duration] || "2-3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹"
        
        timer_message = <<~MARKDOWN
          â±ï¸ *ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ÑÑ!*

          **ĞŸÑ€Ğ¾Ñ†ĞµÑÑ:**
          1. ğŸ’­ ĞŸĞ¾Ğ·Ğ²Ğ¾Ğ»ÑŒÑ‚Ğµ Ğ¼Ñ‹ÑĞ»Ğ¸ Ğ¿Ğ¾ÑĞ²Ğ¸Ñ‚ÑŒÑÑ (5-10 ÑĞµĞºÑƒĞ½Ğ´)
          2. ğŸ›‘ ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»
          3. ğŸ”„ ĞĞµĞ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ğ¾ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚ĞµÑÑŒ Ğ½Ğ° ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ
          4. â° ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒĞ¹Ñ‚Ğµ #{duration}

          **Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ñ‹:**
          â€¢ ĞĞµ Ğ¾Ñ†ĞµĞ½Ğ¸Ğ²Ğ°Ğ¹Ñ‚Ğµ, Ğ½Ğ°ÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¾ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ÑÑ
          â€¢ ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ° ÑƒĞºÑ€ĞµĞ¿Ğ»ÑĞµÑ‚ Ğ½Ğ°Ğ²Ñ‹Ğº
          â€¢ Ğ•ÑĞ»Ğ¸ Ğ¼Ñ‹ÑĞ»ÑŒ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ â€” ÑĞ½Ğ¾Ğ²Ğ° Â«Ğ¡Ğ¢ĞĞŸ!Â»
          â€¢ Ğ¤Ğ¾ĞºÑƒÑ Ğ½Ğ° Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞµ, Ğ° Ğ½Ğµ Ğ½Ğ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğµ
          
          ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ, ĞºĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚Ğµ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ.
        MARKDOWN
        
        send_message(text: timer_message, parse_mode: 'Markdown')
        
        send_message(
          text: "ğŸ”„ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒĞ¹Ñ‚Ğµ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½ÑƒÑ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ...",
          reply_markup: day_8_practice_completion_markup
        )
      end
      
      def complete_practice
        store_day_data('practice_completed', true)
        store_day_data('completion_time', Time.current)
        
        # ĞœĞ•ĞĞ¯Ğ•Ğœ Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
        @user.set_self_help_step("day_#{DAY_NUMBER}_practice_completed")
        
        # ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ€ĞµÑ„Ğ»ĞµĞºÑĞ¸Ñ
        show_post_practice_reflection
      end
      
      def show_post_practice_reflection
        store_day_data('current_step', 'post_practice_reflection')
        
        send_message(text: DAY_STEPS['post_practice_reflection'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['post_practice_reflection'][:instruction], parse_mode: 'Markdown')
        
        send_message(
          text: "ğŸ¤” *Ğ¡ ĞºĞ°ĞºĞ¸Ğ¼Ğ¸ Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚ÑĞ¼Ğ¸ ÑÑ‚Ğ¾Ğ»ĞºĞ½ÑƒĞ»Ğ¸ÑÑŒ Ğ² Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ?*",
          parse_mode: 'Markdown',
          reply_markup: day_8_challenges_markup
        )
      end
      
      def handle_challenge_selection(challenge_index)
        challenge = COMMON_CHALLENGES[challenge_index.to_i]
        
        if challenge
          send_message(
            text: "ğŸŒ€ **#{challenge[:challenge]}**\n\n#{challenge[:solution]}",
            parse_mode: 'Markdown'
          )
        end
        
        # ĞœĞ•ĞĞ¯Ğ•Ğœ Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• Ğ¿Ğ¾ÑĞ»Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚Ğ¸
        @user.set_self_help_step("day_#{DAY_NUMBER}_reflection_done")
        
        send_message(
          text: "ğŸŒŸ ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾! Ğ’Ñ‹ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹!\n\nĞ¥Ğ¾Ñ‚Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ğ”ĞµĞ½ÑŒ 8?",
          reply_markup: day_8_final_completion_markup
        )
      end
      
      def complete_exercise
        selected_signal = get_day_data('selected_stop_signal') || {}
        selected_strategy = get_day_data('selected_distraction_strategy') || {}
        practice_thought = get_day_data('practice_thought') || "Ğ½Ğµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ°"
        
        # Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ· Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‹)
        signal_name = extract_name(selected_signal)
        strategy_name = extract_name(selected_strategy)
        
        # ĞÑ‚Ğ¼ĞµÑ‡Ğ°ĞµĞ¼ Ğ´ĞµĞ½ÑŒ ĞºĞ°Ğº Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ğ¹ Ğ² Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğµ
        @user.complete_day_program(DAY_NUMBER)
        @user.complete_self_help_day(DAY_NUMBER)
        
        # ĞœĞ•ĞĞ¯Ğ•Ğœ Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• Ğ½Ğ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ğ¾Ğµ
        @user.set_self_help_step("day_#{DAY_NUMBER}_completed")
        
        # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸ Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸ÑĞ¼Ğ¸
        save_thought_stopping_stats(signal_name, strategy_name)
        
        completion_message = <<~MARKDOWN
          ğŸŠ *Ğ”ĞµĞ½ÑŒ 8 Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½!* ğŸŠ

          **Ğ’Ğ°ÑˆĞ¸ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ:**
          
          ğŸ›‘ **ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹:**
          â€¢ ğŸ¯ Ğ¡Ñ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»: #{signal_name || "ĞĞµ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½"}
          â€¢ ğŸ”„ Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ: #{strategy_name || "ĞĞµ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ°"}
          â€¢ ğŸ’­ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¼Ñ‹ÑĞ»ÑŒ: "#{practice_thought.truncate(30)}..."
          â€¢ ğŸ§  ĞŸÑ€Ğ¸Ğ¾Ğ±Ñ€ĞµÑ‚ĞµĞ½Ğ¸Ğµ: ĞĞ°Ğ²Ñ‹Ğº ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¼Ñ‹ÑĞ»ĞµĞ½Ğ½Ñ‹Ğ¼ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ¼
          
          ğŸ“Š **ĞĞ°ÑƒÑ‡Ğ½Ñ‹Ğ¹ Ñ„Ğ°ĞºÑ‚:**
          Ğ ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ğ°Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹ ÑĞ½Ğ¸Ğ¶Ğ°ĞµÑ‚ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ½Ğ° 35-45% Ğ¸ ÑƒĞ»ÑƒÑ‡ÑˆĞ°ĞµÑ‚ ĞºĞ¾Ğ³Ğ½Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ½Ğ° 25-30%.
          
          ğŸ¯ **Ğ§Ñ‚Ğ¾ Ğ´Ğ°Ğ»ÑŒÑˆĞµ:**
          Ğ—Ğ°Ğ²Ñ‚Ñ€Ğ° - Ğ”ĞµĞ½ÑŒ 9: ĞšĞ¾Ğ³Ğ½Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ¶Ğ½Ñ‹Ğ¼Ğ¸ Ğ¼Ñ‹ÑĞ»ÑĞ¼Ğ¸
          
          â° **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ±ÑƒĞ´ĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ñ‡ĞµÑ€ĞµĞ· 12 Ñ‡Ğ°ÑĞ¾Ğ²**
          
          Ğ’Ğ°Ñˆ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ: #{@user.progress_percentage}%
        MARKDOWN
        
        send_message(text: completion_message, parse_mode: 'Markdown')
        
        # ĞŸÑ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµĞ¼ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ
        propose_next_day_with_restriction
      end
      
      # ===== ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ ĞšĞĞĞŸĞĞš =====
      
      def handle_button(callback_data)
        case callback_data
        when 'start_day_8_content', 'start_day_8_from_proposal'
          deliver_exercise
          
        when 'continue_day_8_content'
          current_step = get_day_data('current_step')
          handle_resume_from_step(current_step || 'intro')
          
        when /^day_8_stop_signal_(\d+)$/
          handle_stop_signal_selection($1)
          
        when /^day_8_distraction_(\d+)$/
          handle_distraction_selection($1)
          
        when 'day_8_practice_complete'
          complete_practice
          
        when 'day_8_practice_restart'
          deliver_exercise
          
        when /^day_8_challenge_(\d+)$/
          handle_challenge_selection($1)
          
        when 'day_8_no_challenges'
          # ĞœĞ•ĞĞ¯Ğ•Ğœ Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• Ğ¿Ğ¾ÑĞ»Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° "Ğ½ĞµÑ‚ Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚ĞµĞ¹"
          @user.set_self_help_step("day_#{DAY_NUMBER}_reflection_done")
          send_message(text: "ğŸŒŸ ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾! Ğ£ Ğ²Ğ°Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ»Ğ°ÑÑŒ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ°!")
          send_message(
            text: "Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµĞ¼ Ğ”ĞµĞ½ÑŒ 8?",
            reply_markup: day_8_final_completion_markup
          )
          
        when 'day_8_complete_exercise', 'day_8_exercise_completed'
          complete_exercise
          
        when 'day_8_restart_practice'
          deliver_exercise
          
        when 'day_8_change_thought'
          show_thought_selection_guidance
          
        when 'day_8_help_choose_signal'
          send_message(
            text: "ğŸ¯ **Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ñƒ ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ°:**\n\nâ€¢ ĞĞ¾Ğ²Ğ¸Ñ‡ĞºĞ¸: ĞœÑ‹ÑĞ»ĞµĞ½Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ğ¸Ğ»Ğ¸ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ·\nâ€¢ Ğ•ÑĞ»Ğ¸ Ğ¼Ñ‹ÑĞ»ÑŒ ÑĞ¸Ğ»ÑŒĞ½Ğ°Ñ: Ğ¤Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑĞ¸Ğ³Ğ½Ğ°Ğ» Ğ¸Ğ»Ğ¸ Ğ·Ğ²ÑƒĞº\nâ€¢ Ğ”Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ: Ğ”Ñ‹Ñ…Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¾Ğ¿\nâ€¢ Ğ’ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¼ĞµÑÑ‚Ğ°Ñ…: ĞœÑ‹ÑĞ»ĞµĞ½Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°\nâ€¢ ĞŸÑ€Ğ¸ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ³Ğµ: Ğ¡Ğ¾Ñ‡ĞµÑ‚Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ°",
            parse_mode: 'Markdown'
          )
          
        else
          log_warn("Unknown button callback: #{callback_data}")
          send_message(text: "ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°.")
        end
      end
      
      # ===== ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ Ğ¢Ğ•ĞšĞ¡Ğ¢ĞĞ’ĞĞ“Ğ Ğ’Ğ’ĞĞ”Ğ =====
      
      def handle_text_input(input_text)
        log_info("Handling text input for day 8: #{input_text}")
        
        current_state = @user.self_help_state
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµĞ¼ Ğ»Ğ¸ Ğ¼Ñ‹ Ğ²Ğ²Ğ¾Ğ´ Ğ¼Ñ‹ÑĞ»Ğ¸ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
        if current_state == "day_8_waiting_for_thought"
          return handle_thought_input(input_text)
        elsif current_state == "day_8_practice_completed" || 
              current_state == "day_8_reflection_done" ||
              current_state == "day_8_completed"
          # Ğ•ÑĞ»Ğ¸ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° ÑƒĞ¶Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°, Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµĞ¼ Ğ²Ğ²Ğ¾Ğ´ Ğ¼Ñ‹ÑĞ»Ğ¸
          send_message(
            text: "âš ï¸ Ğ’Ñ‹ ÑƒĞ¶Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹. Ğ§Ñ‚Ğ¾Ğ±Ñ‹ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¼Ñ‹ÑĞ»ÑŒ, Ğ½Ğ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾.",
            reply_markup: day_8_final_completion_markup
          )
          return true
        end
        
        log_warn("No text input handler for current state: #{current_state}")
        false
      end
      
      # ĞœĞµÑ‚Ğ¾Ğ´ Ğ´Ğ»Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ñ SelfHelpFacade
      def handle_smart_input(text)
        handle_text_input(text)
      end
      
      # ĞœĞµÑ‚Ğ¾Ğ´ Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ñ€ĞµÑ„Ğ»ĞµĞºÑĞ¸Ğ¸ (Ğ´Ğ»Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸)
      def handle_reflection_input(text)
        log_info("Handling reflection input: #{text}")
        store_day_data('reflection_note', text)
        send_message(text: "âœ… Ğ’Ğ°ÑˆĞ° Ğ·Ğ°Ğ¼ĞµÑ‚ĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ°!")
        true
      end
      
      # ===== Ğ’ĞĞ¡Ğ¡Ğ¢ĞĞĞĞ’Ğ›Ğ•ĞĞ˜Ğ• Ğ¡Ğ•Ğ¡Ğ¡Ğ˜Ğ˜ =====
      
      def handle_exercise_completion
        # ĞŸĞµÑ€ĞµĞ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ½Ğ° Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ
        complete_exercise
      end

      def resume_session
        current_state = @user.self_help_state
        
        case current_state
        when "day_#{DAY_NUMBER}_intro"
          # Ğ•ÑĞ»Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ°Ñ‡Ğ°Ğ» Ğ´ĞµĞ½ÑŒ, Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑƒĞ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ
          deliver_exercise
        when "day_#{DAY_NUMBER}_exercise_in_progress"
          # Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ ÑˆĞ°Ğ³Ğ°
          current_step = get_day_data('current_step')
          if current_step.present?
            handle_resume_from_step(current_step)
          else
            # Ğ•ÑĞ»Ğ¸ ÑˆĞ°Ğ³ Ğ½Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½, Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ ÑƒĞ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ
            deliver_exercise
          end
        when "day_#{DAY_NUMBER}_waiting_for_thought"
          # Ğ•ÑĞ»Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµÑ‚ Ğ²Ğ²Ğ¾Ğ´Ğ° Ğ¼Ñ‹ÑĞ»Ğ¸
          show_thought_selection_guidance
        when "day_#{DAY_NUMBER}_practice_completed"
          # Ğ•ÑĞ»Ğ¸ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°, Ğ½Ğ¾ Ñ€ĞµÑ„Ğ»ĞµĞºÑĞ¸Ñ ĞµÑ‰Ğµ Ğ½ĞµÑ‚
          show_post_practice_reflection
        when "day_#{DAY_NUMBER}_reflection_done"
          # Ğ•ÑĞ»Ğ¸ Ñ€ĞµÑ„Ğ»ĞµĞºÑĞ¸Ñ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ°, Ğ¿Ñ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµĞ¼ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ğ´ĞµĞ½ÑŒ
          send_message(
            text: "ğŸŒŸ Ğ’Ñ‹ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹!\n\nĞ¥Ğ¾Ñ‚Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ğ”ĞµĞ½ÑŒ 8?",
            reply_markup: day_8_final_completion_markup
          )
        else
          # Ğ•ÑĞ»Ğ¸ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ½Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¾ Ğ¸Ğ»Ğ¸ Ğ½Ğµ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ´Ğ½Ñ 8
          log_warn("Unknown or invalid state for resume: #{current_state}")
          # ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ²Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµĞ¼ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ
          show_intro_without_state
        end
      end

      def handle_resume_from_step(step)
        case step
        when 'intro'
          deliver_intro
        when 'exercise_explanation'
          deliver_exercise
        when 'thought_selection'
          show_thought_selection_guidance
        when 'practice_session'
          start_practice_session
        when 'post_practice_reflection'
          show_post_practice_reflection
        else
          deliver_intro
        end
      end

      def show_intro_without_state
        send_message(text: DAY_STEPS['intro'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['intro'][:instruction], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['day_intro'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['day_intro'][:instruction], parse_mode: 'Markdown')
        send_message(
          text: statistics_message,
          parse_mode: 'Markdown'
        )
        send_message(
          text: "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğ¾ÑĞ²Ğ¾Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºÑƒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¼Ñ‹ÑĞ»ÑĞ¼Ğ¸ Ğ¸ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ²Ñ‚Ğ¾Ñ€ÑƒÑ Ğ½ĞµĞ´ĞµĞ»Ñ?",
          reply_markup: day_8_content_markup
        )
      end

      def propose_next_day_with_restriction
        next_day = 9
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ»Ğ¸ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ
        can_start_result = @user.can_start_day?(next_day)
        
        if can_start_result == true
          message = <<~MARKDOWN
            ğŸ¯ **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³: Ğ”ĞµĞ½ÑŒ #{next_day} - ĞšĞ¾Ğ³Ğ½Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°** ğŸ§ 
            
            âœ… *Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ ÑĞµĞ¹Ñ‡Ğ°Ñ!*
            
            **Ğ§Ñ‚Ğ¾ Ğ²Ğ°Ñ Ğ¶Ğ´ĞµÑ‚:**
            â€¢ ğŸ§  ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‚Ñ€ĞµĞ²Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ¼Ñ‹ÑĞ»ĞµĞ¹
            â€¢ ğŸ“ Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ ĞºĞ¾Ğ³Ğ½Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¼Ğ¸ Ğ¸ÑĞºĞ°Ğ¶ĞµĞ½Ğ¸ÑĞ¼Ğ¸  
            â€¢ ğŸ’¡ ĞŸĞµÑ€ĞµÑ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½ĞµĞ³Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ¼Ñ‹ÑĞ»ĞµĞ¹
            â€¢ ğŸŒŸ Ğ£ĞºÑ€ĞµĞ¿Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿ÑĞ¸Ñ…Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ ÑƒÑÑ‚Ğ¾Ğ¹Ñ‡Ğ¸Ğ²Ğ¾ÑÑ‚Ğ¸
            
            Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ¿Ñ€ÑĞ¼Ğ¾ ÑĞµĞ¹Ñ‡Ğ°Ñ.
          MARKDOWN
          
          button_text = "ğŸ§  ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ”ĞµĞ½ÑŒ #{next_day}"
          callback_data = "start_day_#{next_day}_from_proposal"
        else
          error_message = can_start_result.is_a?(Array) ? can_start_result.join("\n") : can_start_result
          
          message = <<~MARKDOWN
            ğŸ¯ **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³: Ğ”ĞµĞ½ÑŒ #{next_day}**
            
            â±ï¸ *ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ:* #{error_message}
            
            **ĞŸĞ¾ĞºĞ° Ğ¶Ğ´ĞµÑ‚Ğµ, Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ:**
            â€¢ ğŸ›‘ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºÑƒ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹
            â€¢ ğŸ”„ Ğ­ĞºÑĞ¿ĞµÑ€Ğ¸Ğ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼Ğ¸ ÑÑ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ°Ğ¼Ğ¸
            â€¢ ğŸ§  ĞĞ°Ğ±Ğ»ÑĞ´Ğ°Ñ‚ÑŒ, ĞºĞ°Ğº Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ° Ğ²Ğ»Ğ¸ÑĞµÑ‚ Ğ½Ğ° Ğ²Ğ°Ñˆ Ğ¼Ñ‹ÑĞ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº
            â€¢ ğŸ“Š ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ (/progress)
            
            *Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ±ÑƒĞ´ĞµÑ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½, ĞºĞ¾Ğ³Ğ´Ğ° Ğ¿Ñ€Ğ¾Ğ¹Ğ´ĞµÑ‚ Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸.*
          MARKDOWN
          
          # Ğ•ÑĞ»Ğ¸ Ğ´ĞµĞ½ÑŒ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½, ĞĞ• Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½ÑƒÑ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ
          button_text = "â±ï¸ ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ Ğ”Ğ½Ñ #{next_day}"
          callback_data = "start_day_#{next_day}_from_proposal"  # ĞÑÑ‚Ğ°Ğ²Ğ»ÑĞµĞ¼ Ñ‚Ñƒ Ğ¶Ğµ, Ğ½Ğ¾ Day9Handler Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚
        end
        
        # ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
        send_message(text: message, parse_mode: 'Markdown')
        
        # ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ’Ğ¡Ğ•Ğ“Ğ”Ğ, Ğ½Ğ¾ Day9Handler Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ
        send_message(
          text: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ:",
          reply_markup: {
            inline_keyboard: [
              [
                { 
                  text: button_text, 
                  callback_data: callback_data
                }
              ]
            ]
          }
        )
      end
      
      private

      def extract_name(data)
        return nil if data.blank?
        
        # ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‹ ĞºĞ»ÑÑ‡ĞµĞ¹
        if data.is_a?(Hash)
          # ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ ÑÑ‚Ñ€Ğ¾ĞºĞ¾Ğ²Ñ‹Ğµ ĞºĞ»ÑÑ‡Ğ¸
          return data['name'] if data['name'].present?
          
          # ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»ÑŒĞ½Ñ‹Ğµ ĞºĞ»ÑÑ‡Ğ¸
          return data[:name] if data[:name].present?
          
          # ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ ĞºĞ»ÑÑ‡ Ñ Ğ¿Ñ€ĞµÑ„Ğ¸ĞºÑĞ¾Ğ¼ name
          return data['Name'] if data['Name'].present?
        elsif data.is_a?(String)
          # Ğ•ÑĞ»Ğ¸ ÑÑ‚Ğ¾ ÑƒĞ¶Ğµ ÑÑ‚Ñ€Ğ¾ĞºĞ°, Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ ĞºĞ°Ğº ĞµÑÑ‚ÑŒ
          return data
        end
        
        nil
      end
      
      # Ğ’ÑĞ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‚ĞºĞ¸
      def day_8_content_markup
        {
          inline_keyboard: [
            [
              { text: "ğŸ›‘ ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹", callback_data: 'start_day_8_content' }
            ],
            [
              { text: "#{EMOJI[:back]} Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒÑÑ Ğ² Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ", callback_data: 'back_to_main_menu' }
            ]
          ]
        }.to_json
      end
      
      def day_8_stop_signals_markup
        {
          inline_keyboard: [
            [
              { text: "ğŸ—£ï¸ ĞœÑ‹ÑĞ»ĞµĞ½Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°", callback_data: 'day_8_stop_signal_0' },
              { text: "ğŸ›‘ Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ·", callback_data: 'day_8_stop_signal_1' }
            ],
            [
              { text: "ğŸ‘ Ğ¤Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑĞ¸Ğ³Ğ½Ğ°Ğ»", callback_data: 'day_8_stop_signal_2' },
              { text: "ğŸ”Š Ğ—Ğ²ÑƒĞºĞ¾Ğ²Ğ¾Ğ¹ ÑĞ¸Ğ³Ğ½Ğ°Ğ»", callback_data: 'day_8_stop_signal_3' }
            ],
            [
              { text: "ğŸŒ¬ï¸ Ğ”Ñ‹Ñ…Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¾Ğ¿", callback_data: 'day_8_stop_signal_4' },
              { text: "âœ‹ Ğ”Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ-ÑÑ‚Ğ¾Ğ¿", callback_data: 'day_8_stop_signal_5' }
            ],
            [
              { text: "â“ ĞŸĞ¾Ğ¼Ğ¾Ğ³Ğ¸Ñ‚Ğµ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ", callback_data: 'day_8_help_choose_signal' }
            ]
          ]
        }.to_json
      end
      
      def day_8_distraction_strategies_markup
        {
          inline_keyboard: [
            [
              { text: "ğŸŒ¬ï¸ Ğ”Ñ‹Ñ…Ğ°Ğ½Ğ¸Ğµ 4-7-8", callback_data: 'day_8_distraction_0' },
              { text: "ğŸ‘ï¸ Ğ¡ĞµĞ½ÑĞ¾Ñ€Ğ½Ğ¾Ğµ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ", callback_data: 'day_8_distraction_1' }
            ],
            [
              { text: "ğŸƒ Ğ¤Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ", callback_data: 'day_8_distraction_2' },
              { text: "ğŸ”¢ Ğ¡Ñ‡ĞµÑ‚ Ğ¸Ğ»Ğ¸ Ğ°Ğ»Ñ„Ğ°Ğ²Ğ¸Ñ‚", callback_data: 'day_8_distraction_3' }
            ],
            [
              { text: "ğŸ¨ ĞšÑ€ĞµĞ°Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°", callback_data: 'day_8_distraction_4' },
              { text: "ğŸŒ³ Ğ’Ğ½ĞµÑˆĞ½Ğ¸Ğ¹ Ñ„Ğ¾ĞºÑƒÑ", callback_data: 'day_8_distraction_5' }
            ]
          ]
        }.to_json
      end
      
      def day_8_practice_completion_markup
        {
          inline_keyboard: [
            [
              { text: "âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ", callback_data: 'day_8_practice_complete' }
            ],
            [
              { text: "ğŸ”„ ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾", callback_data: 'day_8_practice_restart' },
              { text: "ğŸ’­ Ğ¡Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¼Ñ‹ÑĞ»ÑŒ", callback_data: 'day_8_change_thought' }
            ]
          ]
        }.to_json
      end
      
      def day_8_challenges_markup
        {
          inline_keyboard: [
            [
              { text: "ğŸŒ€ ĞœÑ‹ÑĞ»ÑŒ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ", callback_data: 'day_8_challenge_0' }
            ],
            [
              { text: "ğŸ˜³ Ğ§ÑƒĞ²ÑÑ‚Ğ²ÑƒÑ ÑĞµĞ±Ñ Ğ³Ğ»ÑƒĞ¿Ğ¾", callback_data: 'day_8_challenge_1' }
            ],
            [
              { text: "ğŸ¤” ĞĞµ Ğ¼Ğ¾Ğ³Ñƒ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¼Ñ‹ÑĞ»ÑŒ", callback_data: 'day_8_challenge_2' }
            ],
            [
              { text: "ğŸ”„ Ğ¡Ñ‚Ğ¾Ğ¿-ÑĞ¸Ğ³Ğ½Ğ°Ğ» Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚", callback_data: 'day_8_challenge_3' }
            ],
            [
              { text: "âœ… ĞĞ¸ĞºĞ°ĞºĞ¸Ñ… Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾ÑÑ‚ĞµĞ¹", callback_data: 'day_8_no_challenges' }
            ]
          ]
        }.to_json
      end
      
      def day_8_final_completion_markup
        {
          inline_keyboard: [
            [
              { text: "ğŸ¯ Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ğ”ĞµĞ½ÑŒ 8", callback_data: 'day_8_complete_exercise' },
              { text: "ğŸ”„ ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºÑƒ", callback_data: 'day_8_restart_practice' }
            ]
          ]
        }.to_json
      end
      
      def statistics_message
        <<~MARKDOWN
          ğŸ“Š *ĞĞ°ÑƒÑ‡Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞµ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ¼Ñ‹ÑĞ»ĞµĞ¹:*
          
          â€¢ ğŸ§  **35-45%** â€” ÑĞ½Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±Ñ‰ĞµĞ¹ Ñ‚Ñ€ĞµĞ²Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¿Ğ¾ÑĞ»Ğµ 4 Ğ½ĞµĞ´ĞµĞ»ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
          â€¢ ğŸ˜Œ **40-50%** â€” ÑƒĞ¼ĞµĞ½ÑŒÑˆĞµĞ½Ğ¸Ğµ Ğ½Ğ°Ğ²ÑĞ·Ñ‡Ğ¸Ğ²Ñ‹Ñ… Ğ¼Ñ‹ÑĞ»ĞµĞ¹ (Ñ€ÑƒĞ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸)
          â€¢ ğŸ’¡ **25-30%** â€” ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¸ ĞºĞ¾Ğ³Ğ½Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ñ
          â€¢ ğŸ›¡ï¸ **50-60%** â€” ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ñ€Ğ¸ Ğ»ĞµĞ³ĞºĞ¸Ñ… Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ… ĞĞšĞ 
          â€¢ ğŸ”„ **6-8 Ğ½ĞµĞ´ĞµĞ»ÑŒ** â€” Ğ²Ñ€ĞµĞ¼Ñ Ñ„Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ÑƒÑÑ‚Ğ¾Ğ¹Ñ‡Ğ¸Ğ²Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ²Ñ‹Ğº
          â€¢ â±ï¸ **2-3 Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ** â€” Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ´Ğ»Ñ Ğ¿ĞµÑ€Ğ²Ñ‹Ñ… Ğ·Ğ°Ğ¼ĞµÑ‚Ğ½Ñ‹Ñ… Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
          
          *Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº: Ğ˜ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Cognitive Therapy and Research, Journal of Anxiety Disorders*
        MARKDOWN
      end
      
      def save_thought_stopping_stats(signal_name, strategy_name)
        begin
          log_info("Saving thought stopping stats - Signal: #{signal_name}, Strategy: #{strategy_name}")
          
          store_day_data('thought_stopping_stats', {
            date: Date.current.to_s,
            stop_signal: signal_name || "ĞĞµ ÑƒĞºĞ°Ğ·Ğ°Ğ½",
            distraction_strategy: strategy_name || "ĞĞµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ°",
            completed: true,
            saved_at: Time.current.to_s
          })
          
          log_info("Successfully saved thought stopping stats")
        rescue => e
          log_error("Failed to save thought stopping stats", e)
          
          # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ñ…Ğ¾Ñ‚Ñ Ğ±Ñ‹ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½ÑƒÑ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ
          begin
            store_day_data('thought_stopping_stats_fallback', {
              date: Date.current.to_s,
              completed: true,
              error: e.message
            })
          rescue => e2
            log_error("Failed to save fallback stats", e2)
          end
        end
      end
      
      def log_info(message)
        Rails.logger.info "[#{self.class}] #{message} - User: #{@user.telegram_id}"
      end
      
      def log_warn(message)
        Rails.logger.warn "[#{self.class}] #{message} - User: #{@user.telegram_id}"
      end
      
      def log_error(message, error = nil)
        Rails.logger.error "[#{self.class}] #{message} - User: #{@user.telegram_id}"
        Rails.logger.error error.message if error
      end
    end
  end
end