# app/services/self_help/days/day_26_service.rb
module SelfHelp
  module Days
    class Day26Service < DayBaseService
      include TelegramMarkupHelper
      
      # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
      DAY_NUMBER = 26
      
      # –®–∞–≥–∏ –¥–Ω—è 26
      DAY_STEPS = {
        'intro' => {
          title: "üîó *–î–µ–Ω—å 26: –ö–ü–¢ '–¶–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π' (Values Chain)* üîó",
          instruction: <<~MARKDOWN
            **–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä –≥–ª—É–±–∏–Ω–Ω—ã—Ö —Å–º—ã—Å–ª–æ–≤ –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–π –º–æ—Ç–∏–≤–∞—Ü–∏–∏!** ‚ú®

            –°–µ–≥–æ–¥–Ω—è –≤—ã –æ—Å–≤–æ–∏—Ç–µ –æ–¥–Ω—É –∏–∑ —Å–∞–º—ã—Ö –º–æ—â–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫ ACT (Acceptance and Commitment Therapy) ‚Äî —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –Ω–∞—Ö–æ–¥–∏—Ç—å –∏ —É—Å–∏–ª–∏–≤–∞—Ç—å —Å–≤—è–∑—å –º–µ–∂–¥—É –≤–∞—à–∏–º–∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –∏ –≥–ª—É–±–∏–Ω–Ω—ã–º–∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º–∏ —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏.

            üìä **–ù–∞—É—á–Ω—ã–µ —Ñ–∞–∫—Ç—ã –æ —Å–≤—è–∑–∏ –¥–µ–π—Å—Ç–≤–∏–π –∏ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π:**
            ‚Ä¢ üß† –î–µ–π—Å—Ç–≤–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏, –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç –¥–æ—Ñ–∞–º–∏–Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –Ω–∞ 35-50% —Å–∏–ª—å–Ω–µ–µ
            ‚Ä¢ üòå –û—Å–æ–∑–Ω–∞–Ω–∏–µ —Å–≤—è–∑–∏ —Å —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏ —Å–Ω–∏–∂–∞–µ—Ç –≤—ã–≥–æ—Ä–∞–Ω–∏–µ –Ω–∞ 40-60%
            ‚Ä¢ üéØ –õ—é–¥–∏, –∂–∏–≤—É—â–∏–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏, –∏–º–µ—é—Ç –Ω–∞ 45% –≤—ã—à–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å –∂–∏–∑–Ω—å—é
            ‚Ä¢ ‚è≥ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ "–¶–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π" –ø–æ–≤—ã—à–∞–µ—Ç –º–æ—Ç–∏–≤–∞—Ü–∏—é –Ω–∞ 65% –∑–∞ —Å—á—ë—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Å–º—ã—Å–ª–æ–≤—ã—Ö –º–æ—Å—Ç–æ–≤
            ‚Ä¢ üîÑ ACT-—Ç–µ—Ä–∞–ø–∏—è —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ —Å–Ω–∏–∂–∞–µ—Ç –¥–µ–ø—Ä–µ—Å—Å–∏—é –Ω–∞ 50% –∏ —Ç—Ä–µ–≤–æ–≥—É –Ω–∞ 40%
            ‚Ä¢ üí° 87% –ª—é–¥–µ–π, –ø—Ä–∞–∫—Ç–∏–∫—É—é—â–∏—Ö —Ç–µ—Ö–Ω–∏–∫—É, –æ—Ç–º–µ—á–∞—é—Ç –ø–æ–≤—ã—à–µ–Ω–∏–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
            ‚Ä¢ üå± –ù–µ–π—Ä–æ–ø–ª–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å: —Ä–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ –ø—É—Ç–∏ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è

            üéØ **–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –æ—Ç —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π –ø—Ä–∞–∫—Ç–∏–∫–∏:**
            1. üîó –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –Ω–∞—Ö–æ–¥–∏—Ç—å —Å–º—ã—Å–ª –≤ –æ–±—ã—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö
            2. üí™ –ú–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –±–æ—Ä—å–±—ã —Å –≤—ã–≥–æ—Ä–∞–Ω–∏–µ–º –∏ —Ä—É—Ç–∏–Ω–æ–π
            3. üß≠ –ß—ë—Ç–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤–∞—à–∏—Ö –∏—Å—Ç–∏–Ω–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
            4. üåâ –ù–∞–≤—ã–∫ —Å–æ–∑–¥–∞–Ω–∏—è "–º–æ—Å—Ç–æ–≤" –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –∏ —Å–º—ã—Å–ª–∞–º–∏
            5. üé≠ –¢–µ—Ö–Ω–∏–∫—É –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏—è —Ä—É—Ç–∏–Ω—ã –≤ –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–µ —Ä–∏—Ç—É–∞–ª—ã
            6. üìà –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –º–æ—Ç–∏–≤–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–æ—Å–º—ã—Å–ª–µ–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞—á
          MARKDOWN
        },
        'exercise_explanation' => {
          title: "‚öôÔ∏è *–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–º—ã—Å–ª–∞* üèóÔ∏è",
          instruction: <<~MARKDOWN
            **–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ '–¶–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π'?** ü§î

            –ö–æ–≥–¥–∞ –º—ã –æ—Å–æ–∑–Ω–∞—ë–º —Å–≤—è–∑—å –º–µ–∂–¥—É –Ω–∞—à–∏–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –∏ –≥–ª—É–±–∏–Ω–Ω—ã–º–∏ —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–æ—â–Ω–∞—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è:

            ‚Ä¢ üß† **–ù–µ–π—Ä–æ–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç:** –ê–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è –ø—Ä–µ—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–æ—Ä–∞ –∏ —Å–∏—Å—Ç–µ–º–∞ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è
            ‚Ä¢ üí™ **–ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ—Ä—ã–≤:** –î–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—É—á–∞—é—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é "–ø–æ–¥–ø–∏—Ç–∫—É" –æ—Ç —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
            ‚Ä¢ üîÑ **–ö–æ–≥–Ω–∏—Ç–∏–≤–Ω–∞—è –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞:** –†—É—Ç–∏–Ω–∞ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ø—É—Ç—å –∫ –≤–∞–∂–Ω—ã–º —Ü–µ–ª—è–º
            ‚Ä¢ üòå **–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–ª–µ–≥—á–µ–Ω–∏–µ:** –ò—Å—á–µ–∑–∞–µ—Ç —á—É–≤—Å—Ç–≤–æ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏–π
            ‚Ä¢ üå± **–≠–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ:** –ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ—Å—Ç—å –æ–±—Ä–µ—Ç–∞–µ—Ç –≥–ª—É–±–∏–Ω—É –∏ –∑–Ω–∞—á–∏–º–æ—Å—Ç—å

            **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ—Ö–Ω–∏–∫–∞ ACT:**
            1. üîß –í—ã–±–∏—Ä–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
            2. üéØ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Ä–∞—Å–∫—Ä—É—á–∏–≤–∞–µ–º 6 —É—Ä–æ–≤–Ω–µ–π —Å–º—ã—Å–ª–∞
            3. üîç –ù–∞—Ö–æ–¥–∏–º –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º "—Ä–∞–∑—Ä—ã–≤—ã" –≤ —Ü–µ–ø–æ—á–∫–µ
            4. üåâ –°–æ–∑–¥–∞—ë–º "–º–æ—Å—Ç—ã" –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è —Å–≤—è–∑–∏
            5. üé≠ –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ –≤ –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π —Ä–∏—Ç—É–∞–ª

            **–°–µ–≥–æ–¥–Ω—è—à–Ω–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:** –ì–ª—É–±–∏–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ–¥–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ 6 —É—Ä–æ–≤–Ω–µ–π ‚Äî –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç—É–ø–∫–∞ –¥–æ —ç–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–º—ã—Å–ª–∞.
            –¶–µ–ª—å ‚Äî –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ, –∞ –∏–∑–º–µ–Ω–∏—Ç—å –≤–∞—à–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –Ω–µ–º—É —á–µ—Ä–µ–∑ –æ—Å–æ–∑–Ω–∞–Ω–∏–µ –µ–≥–æ —Å–≤—è–∑–∏ —Å —Ç–µ–º, —á—Ç–æ –¥–ª—è –≤–∞—Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω–æ.
          MARKDOWN
        },
        'practice_guidance' => {
          title: "üìã *–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∞—Ä—Ö–µ–æ–ª–æ–≥–∏–∏ —Å–º—ã—Å–ª–æ–≤* üß≠",
          instruction: <<~MARKDOWN
            **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏:**

            üß† **–ú–µ–Ω—Ç–∞–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**
            ‚Ä¢ –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è, –∫–æ–≥–¥–∞ –º–æ–∂–µ—Ç–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è 20-25 –º–∏–Ω—É—Ç
            ‚Ä¢ –û—Ç–ª–æ–∂–∏—Ç–µ –≤—Å–µ –æ—Ç–≤–ª–µ–∫–∞—é—â–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã
            ‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ—Å—å –Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ª–∞–¥
            ‚Ä¢ –ë—É–¥—å—Ç–µ –æ—Ç–∫—Ä—ã—Ç—ã –∏–Ω—Å–∞–π—Ç–∞–º –∏ –æ—Ç–∫—Ä—ã—Ç–∏—è–º

            üìù **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**
            ‚Ä¢ –ú–æ–∂–µ—Ç–µ –¥–µ–ª–∞—Ç—å –∑–∞–º–µ—Ç–∫–∏ –Ω–∞ –±—É–º–∞–≥–µ –∏–ª–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
            ‚Ä¢ –ì–æ—Ç–æ–≤—å—Ç–µ—Å—å –∫ —á–µ—Å—Ç–Ω–æ–º—É –¥–∏–∞–ª–æ–≥—É —Å —Å–æ–±–æ–π
            ‚Ä¢ –†–∞–∑—Ä–µ—à–∏—Ç–µ —Å–µ–±–µ –º—ã—Å–ª–∏—Ç—å –º–∞—Å—à—Ç–∞–±–Ω–æ –∏ –≥–ª—É–±–æ–∫–æ
            ‚Ä¢ –ü–æ–º–Ω–∏—Ç–µ: –Ω–µ—Ç "–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö" –∏–ª–∏ "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö" –æ—Ç–≤–µ—Ç–æ–≤

            üéØ **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫—É:**
            ‚Ä¢ –ë—É–¥—å—Ç–µ –ª—é–±–æ–ø—ã—Ç–Ω—ã, –∫–∞–∫ –∞—Ä—Ö–µ–æ–ª–æ–≥, —Ä–∞—Å–∫–∞–ø—ã–≤–∞—é—â–∏–π –¥—Ä–µ–≤–Ω–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç
            ‚Ä¢ –ù–µ —Å–ø–µ—à–∏—Ç–µ ‚Äî –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å —Ç—Ä–µ–±—É–µ—Ç –æ—Å–º—ã—Å–ª–µ–Ω–∏—è
            ‚Ä¢ –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç —Å–æ–º–Ω–µ–Ω–∏—è ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ
            ‚Ä¢ –ü–æ–º–Ω–∏—Ç–µ: —ç—Ç–∞ —Ç–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ—Ä–∞–ø–∏–∏ —É–∂–µ 30 –ª–µ—Ç!

            **–í–∞–∂–Ω–æ:** '–¶–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π' ‚Äî —ç—Ç–æ –Ω–∞–≤—ã–∫, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä–∞–∫—Ç–∏–∫—É. –ß–µ–º —á–∞—â–µ –≤—ã –µ—ë –ø—Ä–∏–º–µ–Ω—è–µ—Ç–µ, —Ç–µ–º –ª–µ–≥—á–µ –Ω–∞—Ö–æ–¥–∏—Ç–µ —Å–º—ã—Å–ª—ã.
          MARKDOWN
        },
        'post_practice_reflection' => {
          title: "üìù *–†–µ—Ñ–ª–µ–∫—Å–∏—è –ø–æ—Å–ª–µ —Ä–∞—Å–∫–æ–ø–æ–∫ —Å–º—ã—Å–ª–æ–≤* üíé",
          instruction: <<~MARKDOWN
            **–ü–æ—Ç—Ä—è—Å–∞—é—â–∞—è —Ä–∞–±–æ—Ç–∞! –í—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–≤–µ—Ä—à–∏–ª–∏ –∞—Ä—Ö–µ–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é —ç–∫—Å–ø–µ–¥–∏—Ü–∏—é –∫ –≤–∞—à–∏–º –≥–ª—É–±–∏–Ω–Ω—ã–º —Ü–µ–Ω–Ω–æ—Å—Ç—è–º!** üåü

            **–í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏:**

            üîó **1. –û–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã:**
            ‚Ä¢ –ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤–∞—à–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞?
            ‚Ä¢ –ù–∞ –∫–∞–∫–æ–º —É—Ä–æ–≤–Ω–µ –≤—ã –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞–ª–∏ –Ω–∞–∏–±–æ–ª—å—à–∏–π –ø—Ä–æ—Ä—ã–≤ –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏?
            ‚Ä¢ –ö–∞–∫–∏–µ –∏–Ω—Å–∞–π—Ç—ã –æ –≤–∞—à–∏—Ö —Ü–µ–Ω–Ω–æ—Å—Ç—è—Ö –ø—Ä–∏—à–ª–∏ –∫ –≤–∞–º?
            ‚Ä¢ –ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å "–∑–Ω–∞—á–∏–º–æ—Å—Ç—å" —ç—Ç–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞?

            üß† **2. –û–± —É–º–µ –∏ —ç–º–æ—Ü–∏—è—Ö:**
            ‚Ä¢ –ö–∞–∫–∏–µ –º—ã—Å–ª–∏ –∏–ª–∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –≤–æ–∑–Ω–∏–∫–∞–ª–∏ –≤–æ –≤—Ä–µ–º—è –ø—Ä–∞–∫—Ç–∏–∫–∏?
            ‚Ä¢ –ö–∞–∫ –º–µ–Ω—è–ª–æ—Å—å –≤–∞—à–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–µ —É—Ä–æ–≤–Ω–∏?
            ‚Ä¢ –ë—ã–ª–∏ –ª–∏ –º–æ–º–µ–Ω—Ç—ã —É–¥–∏–≤–ª–µ–Ω–∏—è –∏–ª–∏ –æ–∑–∞—Ä–µ–Ω–∏—è?
            ‚Ä¢ –ö–∞–∫ –ø–æ–≤–ª–∏—è–ª–æ –æ—Å–æ–∑–Ω–∞–Ω–∏–µ —Å–≤—è–∑–∏ —Å —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏ –Ω–∞ –º–æ—Ç–∏–≤–∞—Ü–∏—é?

            üòå **3. –û —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ—Å–ª–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:**
            ‚Ä¢ –ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤–∞—à–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ —ç—Ç–æ–º—É –¥–µ–π—Å—Ç–≤–∏—é?
            ‚Ä¢ –ß—É–≤—Å—Ç–≤—É–µ—Ç–µ –ª–∏ –≤—ã –±–æ–ª—å—à–µ —Å–º—ã—Å–ª–∞ –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏?
            ‚Ä¢ –ì–æ—Ç–æ–≤—ã –ª–∏ –≤—ã –ø—Ä–∏–º–µ–Ω—è—Ç—å —ç—Ç—É —Ç–µ—Ö–Ω–∏–∫—É –∫ –¥—Ä—É–≥–∏–º –¥–µ–π—Å—Ç–≤–∏—è–º?
            ‚Ä¢ –ö–∞–∫–æ–µ –≤–ª–∏—è–Ω–∏–µ –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å —ç—Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ –Ω–∞ –≤–∞—à—É –∂–∏–∑–Ω—å –≤ —Ü–µ–ª–æ–º?
          MARKDOWN
        }
      }.freeze
      
      # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–µ–π—Å—Ç–≤–∏—è
      ACTION_CATEGORIES = [
        {
          name: "–†–∞–±–æ—Ç–∞/—É—á–µ–±–∞",
          emoji: "üíº",
          description: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏, –ø—Ä–æ–µ–∫—Ç—ã, –æ–±—É—á–µ–Ω–∏–µ, –∫–∞—Ä—å–µ—Ä–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ.",
          examples: ["–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞", "–£—á–∞—Å—Ç–∏–µ –≤ —Å–æ–≤–µ—â–∞–Ω–∏–∏", "–ò–∑—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –Ω–∞–≤—ã–∫–∞", "–†–∞–±–æ—Ç–∞ –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º"],
          recommended_for: "–ö–æ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞ –∫–∞–∂–µ—Ç—Å—è —Ä—É—Ç–∏–Ω–æ–π –∏–ª–∏ —Ç–µ—Ä—è–µ—Ç —Å–º—ã—Å–ª"
        },
        {
          name: "–ë—ã—Ç–æ–≤—ã–µ –¥–µ–ª–∞",
          emoji: "üè†",
          description: "–ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–µ –¥–æ–º–∞—à–Ω–∏–µ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏, —É—Ö–æ–¥ –∑–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º.",
          examples: ["–£–±–æ—Ä–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã", "–ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ –µ–¥—ã", "–ü–æ—Ö–æ–¥ –≤ –º–∞–≥–∞–∑–∏–Ω", "–û–ø–ª–∞—Ç–∞ —Å—á–µ—Ç–æ–≤"],
          recommended_for: "–ö–æ–≥–¥–∞ –¥–æ–º–∞—à–Ω–∏–µ –¥–µ–ª–∞ –∫–∞–∂—É—Ç—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –∏ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ–π —Ä—É—Ç–∏–Ω–æ–π"
        },
        {
          name: "–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ",
          emoji: "üë•",
          description: "–û–±—â–µ–Ω–∏–µ —Å –ª—é–¥—å–º–∏, –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π, —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞.",
          examples: ["–†–∞–∑–≥–æ–≤–æ—Ä —Å –∫–æ–ª–ª–µ–≥–æ–π", "–í—Å—Ç—Ä–µ—á–∞ —Å –¥—Ä—É–≥–æ–º", "–°–µ–º–µ–π–Ω—ã–π –æ–±–µ–¥", "–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ"],
          recommended_for: "–ö–æ–≥–¥–∞ –æ–±—â–µ–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º –∏–ª–∏ —ç–Ω–µ—Ä–≥–æ–∑–∞—Ç—Ä–∞—Ç–Ω—ã–º"
        },
        {
          name: "–ó–¥–æ—Ä–æ–≤—å–µ",
          emoji: "üèÉ",
          description: "–ó–∞–±–æ—Ç–∞ –æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º –∏ –º–µ–Ω—Ç–∞–ª—å–Ω–æ–º –∑–¥–æ—Ä–æ–≤—å–µ, –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞.",
          examples: ["–£—Ç—Ä–µ–Ω–Ω—è—è –∑–∞—Ä—è–¥–∫–∞", "–ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤–æ–π –µ–¥—ã", "–ú–µ–¥–∏—Ç–∞—Ü–∏—è", "–í–∏–∑–∏—Ç –∫ –≤—Ä–∞—á—É"],
          recommended_for: "–ö–æ–≥–¥–∞ –∑–∞–±–æ—Ç–∞ –æ —Å–µ–±–µ –∫–∞–∂–µ—Ç—Å—è –æ–±—É–∑–æ–π –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–¥–∞—á–µ–π"
        },
        {
          name: "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∑–∞–¥–∞—á–∏",
          emoji: "üí∞",
          description: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–Ω—å–≥–∞–º–∏, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞, —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞.",
          examples: ["–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞", "–û–ø–ª–∞—Ç–∞ –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã—Ö —É—Å–ª—É–≥", "–ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ", "–§–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"],
          recommended_for: "–ö–æ–≥–¥–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –≤—ã–∑—ã–≤–∞—é—Ç —Å—Ç—Ä–µ—Å—Å –∏–ª–∏ –∫–∞–∂—É—Ç—Å—è –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º–∏"
        },
        {
          name: "–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ —Ö–æ–±–±–∏",
          emoji: "üé®",
          description: "–¢–≤–æ—Ä—á–µ—Å–∫–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —É–≤–ª–µ—á–µ–Ω–∏—è, –ª–∏—á–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã.",
          examples: ["–†–∏—Å–æ–≤–∞–Ω–∏–µ", "–ò–≥—Ä–∞ –Ω–∞ –º—É–∑—ã–∫–∞–ª—å–Ω–æ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ", "–ü–∏—Å–∞—Ç–µ–ª—å—Å—Ç–≤–æ", "–†—É–∫–æ–¥–µ–ª–∏–µ"],
          recommended_for: "–ö–æ–≥–¥–∞ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º –∏–ª–∏ —Ç–µ—Ä—è–µ—Ç —Ä–∞–¥–æ—Å—Ç—å"
        }
      ].freeze
      
      # –£—Ä–æ–≤–Ω–∏ —Ä–∞—Å–∫—Ä—É—Ç–∫–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
      VALUE_LEVELS = [
        {
          name: "level1_action",
          emoji: "üîß",
          title: "–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ",
          instruction: <<~MARKDOWN,
            **–û–ø–∏—à–∏—Ç–µ –≤–∞—à–µ –¥–µ–π—Å—Ç–≤–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –∏ –¥–µ—Ç–∞–ª—å–Ω–æ.** üéØ

            **–§–æ—Ä–º–∞—Ç –æ–ø–∏—Å–∞–Ω–∏—è:**
            ‚Ä¢ üè∑Ô∏è **–ß—Ç–æ –∏–º–µ–Ω–Ω–æ:** [–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ]
            ‚Ä¢ üï∞Ô∏è **–ö–æ–≥–¥–∞:** [–í—Ä–µ–º—è/—É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è]
            ‚Ä¢ üìÖ **–ö–∞–∫ —á–∞—Å—Ç–æ:** [–†–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å/–ø–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å]
            ‚Ä¢ üë• **–° –∫–µ–º:** [–ï—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ ‚Äî –¥—Ä—É–≥–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏]
            ‚Ä¢ üåç **–ì–¥–µ:** [–ú–µ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è]

            **–ü—Ä–∏–º–µ—Ä –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è:**
            "–ö–∞–∂–¥—ã–π –±—É–¥–Ω–∏–π –¥–µ–Ω—å –≤ 17:00 —è —Å–æ—Å—Ç–∞–≤–ª—è—é –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∑–∞ –¥–µ–Ω—å. –î–µ–ª–∞—é —ç—Ç–æ –∑–∞ —Ä–∞–±–æ—á–∏–º —Å—Ç–æ–ª–æ–º –≤ –æ—Ñ–∏—Å–µ, –∏—Å–ø–æ–ª—å–∑—É—è Excel –∏ CRM-—Å–∏—Å—Ç–µ–º—É. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç –æ–∫–æ–ª–æ 45 –º–∏–Ω—É—Ç. –†–∞–±–æ—Ç–∞—é –æ–¥–∏–Ω."

            **–ß–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ ‚Äî —Ç–µ–º –≥–ª—É–±–∂–µ –∞–Ω–∞–ª–∏–∑.**
            
            **–í–∞—à–µ –¥–µ–π—Å—Ç–≤–∏–µ:** üìù
          MARKDOWN
          prompt: "–û–ø–∏—à–∏—Ç–µ –≤–∞—à–µ –¥–µ–π—Å—Ç–≤–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ:"
        },
        {
          name: "level2_immediate_goal",
          emoji: "üéØ",
          title: "–ù–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è —Ü–µ–ª—å",
          instruction: <<~MARKDOWN,
            **–¢–µ–ø–µ—Ä—å –∑–∞–¥–∞–π—Ç–µ –∫–ª—é—á–µ–≤–æ–π –≤–æ–ø—Ä–æ—Å: *–ó–∞—á–µ–º?*** ü§î

            **–ö–∞–∫–∞—è –±–ª–∏–∂–∞–π—à–∞—è, –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ü–µ–ª—å —É —ç—Ç–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è?**
            
            **–ü—Ä–∏–º–µ—Ä—ã –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π:**
            ‚Ä¢ "–ß—Ç–æ–±—ã –æ—Ç—á–∏—Ç–∞—Ç—å—Å—è –ø–µ—Ä–µ–¥ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–º –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –¥–Ω—è"
            ‚Ä¢ "–ß—Ç–æ–±—ã –¥–æ–º –±—ã–ª —á–∏—Å—Ç—ã–º –∏ –≥–æ—Ç–æ–≤—ã–º –∫ –ø—Ä–∏—ë–º—É –≥–æ—Å—Ç–µ–π"
            ‚Ä¢ "–ß—Ç–æ–±—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–π –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏"
            ‚Ä¢ "–ß—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤–∑—è—Ç–æ–µ –Ω–∞ —Å–µ–±—è –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ"

            **–ö—Ä–∏—Ç–µ—Ä–∏–∏ —Ö–æ—Ä–æ—à–µ–π —Ü–µ–ª–∏:**
            ‚Ä¢ ‚úÖ **–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è:** –ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ –ª–∏
            ‚Ä¢ ‚è≥ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏:** –ò–º–µ–µ—Ç —Å—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            ‚Ä¢ üéØ **–ò–∑–º–µ—Ä–∏–º–∞—è:** –ú–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —Å—Ç–µ–ø–µ–Ω—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            ‚Ä¢ üß† **–†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è:** –ò–º–µ–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

            **–ö–∞–∫–∞—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è —Ü–µ–ª—å —É –≤–∞—à–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è?**
            
            **–û–ø–∏—à–∏—Ç–µ —Ü–µ–ª—å:** üìù
          MARKDOWN
          prompt: "–ö–∞–∫–∞—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è —Ü–µ–ª—å —É —ç—Ç–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è?"
        },
        {
          name: "level3_functional_value",
          emoji: "‚öôÔ∏è",
          title: "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å",
          instruction: <<~MARKDOWN,
            **–ü–æ–¥–Ω–∏–º–∞–µ–º—Å—è –≤—ã—à–µ: *–ß—Ç–æ –¥–∞—ë—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —ç—Ç–æ–π —Ü–µ–ª–∏?*** üöÄ

            **–ö–∞–∫–∞—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–ª—å–∑–∞ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è?**
            
            **–ü—Ä–∏–º–µ—Ä—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π:**
            ‚Ä¢ üí∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É / –ø–æ–ª—É—á–∏—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—É / –ø—Ä–µ–º–∏—é"
            ‚Ä¢ üè† "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≥–∏–≥–∏–µ–Ω—É –∏ –ø–æ—Ä—è–¥–æ–∫ –≤ –∂–∏–ª–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ"
            ‚Ä¢ üìä "–ë—ã—Ç—å –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –≤ —Ä–∞–±–æ—Ç–µ"
            ‚Ä¢ üõ°Ô∏è "–ò–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º, —à—Ç—Ä–∞—Ñ–æ–≤ –∏–ª–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π"
            ‚Ä¢ ‚è∞ "–°—ç–∫–æ–Ω–æ–º–∏—Ç—å –≤—Ä–µ–º—è –≤ –±—É–¥—É—â–µ–º —á–µ—Ä–µ–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"

            **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å** ‚Äî —ç—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π:
            ‚Ä¢ –£–ª—É—á—à–∞–µ—Ç –≤–∞—à—É –∂–∏–∑–Ω—å –∏–ª–∏ —Å–∏—Ç—É–∞—Ü–∏—é
            ‚Ä¢ –†–µ—à–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
            ‚Ä¢ –°–æ–∑–¥–∞—ë—Ç —Ä–µ—Å—É—Ä—Å—ã –∏–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
            ‚Ä¢ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏

            **–ö–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å —É —ç—Ç–æ–π —Ü–µ–ª–∏?**
            
            **–û–ø–∏—à–∏—Ç–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫—É—é –ø–æ–ª—å–∑—É:** üìù
          MARKDOWN
          prompt: "–ö–∞–∫–∞—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–ª—å–∑–∞ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è?"
        },
        {
          name: "level4_personal_value",
          emoji: "‚ù§Ô∏è",
          title: "–õ–∏—á–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å",
          instruction: <<~MARKDOWN,
            **–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –ª–∏—á–Ω–æ—Å—Ç–∏: *–ö–∞–∫–∏–µ –≤–∞—à–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ—è–≤–ª—è—é—Ç—Å—è?*** üíñ

            **–ö–∞–∫–∏–µ –ª–∏—á–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –≤—ã –≤—ã—Ä–∞–∂–∞–µ—Ç–µ —á–µ—Ä–µ–∑ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ?**
            
            **–ü—Ä–∏–º–µ—Ä—ã –ª–∏—á–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π:**
            ‚Ä¢ üõ°Ô∏è **–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å** ‚Äî –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤–∑—è—Ç—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞
            ‚Ä¢ üå± **–ó–∞–±–æ—Ç–∞** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–≤–æ—ë –∑–¥–æ—Ä–æ–≤—å–µ –∏ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ
            ‚Ä¢ ‚≠ê **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º** ‚Äî –¥–µ–ª–∞—Ç—å —Ä–∞–±–æ—Ç—É –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏ –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ
            ‚Ä¢ ü§ù **–ß–µ—Å—Ç–Ω–æ—Å—Ç—å** ‚Äî –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–±–µ—â–∞–Ω–∏—è –∏ –±—ã—Ç—å –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º
            ‚Ä¢ üß† **–õ—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî —É—á–∏—Ç—å—Å—è –∏ —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è

            **–õ–∏—á–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏** ‚Äî —ç—Ç–æ:
            ‚Ä¢ –ü—Ä–∏–Ω—Ü–∏–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç –≤–∞—à–∏ —Ä–µ—à–µ–Ω–∏—è
            ‚Ä¢ –ö–∞—á–µ—Å—Ç–≤–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø—Ä–æ—è–≤–ª—è–µ—Ç–µ
            ‚Ä¢ –¢–æ, —á—Ç–æ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ –≤–∞–∂–Ω—ã–º –≤ —Å–µ–±–µ –∫–∞–∫ –ª–∏—á–Ω–æ—Å—Ç–∏
            ‚Ä¢ –í–∞—à –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–æ—Ä–∞–ª—å–Ω—ã–π –∫–æ–º–ø–∞—Å

            **–ö–∞–∫–∏–µ –ª–∏—á–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –≤—ã –≤—ã—Ä–∞–∂–∞–µ—Ç–µ —á–µ—Ä–µ–∑ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ?**
            
            **–û–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏:** üìù
          MARKDOWN
          prompt: "–ö–∞–∫–∏–µ –ª–∏—á–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∏–ª–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –≤—ã –ø—Ä–æ—è–≤–ª—è–µ—Ç–µ?"
        },
        {
          name: "level5_relational_value",
          emoji: "ü§ù",
          title: "–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å",
          instruction: <<~MARKDOWN,
            **–†–∞—Å—à–∏—Ä—è–µ–º –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—É: *–ö–∞–∫ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –¥—Ä—É–≥–∏–º–∏?*** üåç

            **–ö–∞–∫ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å –≤–∞—à–µ–π —Ä–æ–ª—å—é –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –∏–ª–∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ?**
            
            **–ü—Ä–∏–º–µ—Ä—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π:**
            ‚Ä¢ üë®‚Äçüë©‚Äçüëß **"–ë—ã—Ç—å –∑–∞–±–æ—Ç–ª–∏–≤—ã–º —Ä–æ–¥–∏—Ç–µ–ª–µ–º"** ‚Äî —á–µ—Ä–µ–∑ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤–æ–π –µ–¥—ã
            ‚Ä¢ üíº **"–ë—ã—Ç—å –Ω–∞–¥—ë–∂–Ω—ã–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–º"** ‚Äî —á–µ—Ä–µ–∑ —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω—É—é —Å–¥–∞—á—É –æ—Ç—á—ë—Ç–æ–≤
            ‚Ä¢ ü§ù **"–ë—ã—Ç—å —Ö–æ—Ä–æ—à–∏–º –¥—Ä—É–≥–æ–º"** ‚Äî —á–µ—Ä–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤ —Ç—Ä—É–¥–Ω—É—é –º–∏–Ω—É—Ç—É
            ‚Ä¢ üèòÔ∏è **"–ë—ã—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º –≥—Ä–∞–∂–¥–∞–Ω–∏–Ω–æ–º"** ‚Äî —á–µ—Ä–µ–∑ —É—á–∞—Å—Ç–∏–µ –≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∂–∏–∑–Ω–∏
            ‚Ä¢ üë• **"–ë—ã—Ç—å —á–∞—Å—Ç—å—é –∫–æ–º–∞–Ω–¥—ã"** ‚Äî —á–µ—Ä–µ–∑ –≤–∫–ª–∞–¥ –≤ –æ–±—â–∏–π –ø—Ä–æ–µ–∫—Ç

            **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏** –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç:
            ‚Ä¢ –í–∞—à—É —Ä–æ–ª—å –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö —Å –¥—Ä—É–≥–∏–º–∏ –ª—é–¥—å–º–∏
            ‚Ä¢ –í–∞—à–µ –º–µ—Å—Ç–æ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞—Ö –∏ –≥—Ä—É–ø–ø–∞—Ö
            ‚Ä¢ –í–∫–ª–∞–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –¥–µ–ª–∞–µ—Ç–µ –≤ –∂–∏–∑–Ω—å –¥—Ä—É–≥–∏—Ö
            ‚Ä¢ –°–≤—è–∑—å –≤–∞—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

            **–ö–∞–∫ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å –≤–∞—à–∏–º–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º–∏ –∏–ª–∏ —Ä–æ–ª—å—é?**
            
            **–û–ø–∏—à–∏—Ç–µ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç:** üìù
          MARKDOWN
          prompt: "–ö–∞–∫ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å –≤–∞—à–µ–π —Ä–æ–ª—å—é —Å—Ä–µ–¥–∏ –¥—Ä—É–≥–∏—Ö –ª—é–¥–µ–π?"
        },
        {
          name: "level6_existential_value",
          emoji: "üåü",
          title: "–≠–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å",
          instruction: <<~MARKDOWN,
            **–§–∏–Ω–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å: *–ö–∞–∫–æ–π —Å–∞–º—ã–π –≥–ª—É–±–æ–∫–∏–π —Å–º—ã—Å–ª?*** ü™ê

            **–ö–∞–∫ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω—ã–º –≤ –∂–∏–∑–Ω–∏?**
            
            **–ü—Ä–∏–º–µ—Ä—ã —ç–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π:**
            ‚Ä¢ üå± **"–í–Ω–æ—Å–∏—Ç—å –≤–∫–ª–∞–¥ –≤ —Ä–∞–∑–≤–∏—Ç–∏–µ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å"**
            ‚Ä¢ üé≠ **"–í—ã—Ä–∞–∂–∞—Ç—å —Å–≤–æ—é —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª"**
            ‚Ä¢ ü§≤ **"–°–æ–∑–¥–∞–≤–∞—Ç—å –∫—Ä–∞—Å–æ—Ç—É, –ø–æ—Ä—è–¥–æ–∫ –∏–ª–∏ –≥–∞—Ä–º–æ–Ω–∏—é"**
            ‚Ä¢ üë• **"–ü–æ–º–æ–≥–∞—Ç—å –¥—Ä—É–≥–∏–º —Ä–∞—Å—Ç–∏ –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –ª—É—á—à–µ"**
            ‚Ä¢ üß≠ **"–ñ–∏—Ç—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å–≤–æ–∏–º–∏ –≥–ª—É–±–∏–Ω–Ω—ã–º–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏"**
            ‚Ä¢ üåç **"–û—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Å–ª–µ–¥ –≤ –º–∏—Ä–µ"**

            **–≠–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏** ‚Äî —ç—Ç–æ:
            ‚Ä¢ –°–∞–º—ã–µ –≥–ª—É–±–æ–∫–∏–µ —Å–º—ã—Å–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç –∂–∏–∑–Ω—å –∑–Ω–∞—á–∏–º–æ–π
            ‚Ä¢ –¢–æ, —Ä–∞–¥–∏ —á–µ–≥–æ —Å—Ç–æ–∏—Ç –ø—Ä–æ—Å—ã–ø–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
            ‚Ä¢ –í–∞—à –ª–∏—á–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å "–ó–∞—á–µ–º —è –∂–∏–≤—É?"
            ‚Ä¢ –ò—Å—Ç–æ—á–Ω–∏–∫ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –≤ —Ç—Ä—É–¥–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞

            **–ö–∞–∫–æ–π —Å–∞–º—ã–π –≥–ª—É–±–æ–∫–∏–π —Å–º—ã—Å–ª –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ –≤ —ç—Ç–æ–º –¥–µ–π—Å—Ç–≤–∏–∏?**
            
            **–û–ø–∏—à–∏—Ç–µ —ç–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Å–º—ã—Å–ª:** üìù
          MARKDOWN
          prompt: "–ö–∞–∫–æ–π —Å–∞–º—ã–π –≥–ª—É–±–æ–∫–∏–π —Å–º—ã—Å–ª –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–µ—Ç —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ?"
        }
      ].freeze
      
      # –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã—Ö —Ä–∏—Ç—É–∞–ª–æ–≤
      RITUAL_ELEMENTS = [
        {
          name: "–ó–∞–∂–∂–µ–Ω–∏–µ —Å–≤–µ—á–∏",
          emoji: "üïØÔ∏è",
          description: "–ó–∞–∂–µ—á—å —Å–≤–µ—á—É –∫–∞–∫ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–æ–µ –Ω–∞—á–∞–ª–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è",
          duration: "10 —Å–µ–∫—É–Ω–¥",
          benefits: "–°–æ–∑–¥–∞—ë—Ç —Å–∞–∫—Ä–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ"
        },
        {
          name: "–û—Å–æ–±–∞—è –º—É–∑—ã–∫–∞",
          emoji: "üéµ",
          description: "–í–∫–ª—é—á–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø–ª–µ–π–ª–∏—Å—Ç –¥–ª—è —ç—Ç–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è",
          duration: "–ù–∞ –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è",
          benefits: "–°–æ–∑–¥–∞—ë—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—É—é —Å–≤—è–∑—å"
        },
        {
          name: "–ú–∞–Ω—Ç—Ä–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏—è",
          emoji: "üìø",
          description: "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ —Å–µ–±—è –∑–Ω–∞—á–∏–º—É—é —Ñ—Ä–∞–∑—É –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º",
          duration: "15-30 —Å–µ–∫—É–Ω–¥",
          benefits: "–§–æ–∫—É—Å–∏—Ä—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≥–ª—É–±–∏–Ω–Ω–æ–π —Ü–µ–ª–∏"
        },
        {
          name: "–ú–∏–Ω—É—Ç–∞ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏",
          emoji: "üôè",
          description: "–ü–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç—å —Å–µ–±—è –∏–ª–∏ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è",
          duration: "1 –º–∏–Ω—É—Ç–∞",
          benefits: "–ó–∞–∫—Ä–µ–ø–ª—è–µ—Ç –ø–æ–∑–∏—Ç–∏–≤–Ω—É—é –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—é —Å –¥–µ–π—Å—Ç–≤–∏–µ–º"
        },
        {
          name: "–§–∏–∑–∏—á–µ—Å–∫–∏–π —Å–∏–º–≤–æ–ª",
          emoji: "üíé",
          description: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–µ–¥–º–µ—Ç –∫–∞–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Ü–µ–Ω–Ω–æ—Å—Ç–∏",
          duration: "–ü–æ—Å—Ç–æ—è–Ω–Ω–æ",
          benefits: "–°–æ–∑–¥–∞—ë—Ç —Ñ–∏–∑–∏—á–µ—Å–∫—É—é —Å–≤—è–∑—å —Å –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç—å—é"
        },
        {
          name: "–î—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥",
          emoji: "üå¨Ô∏è",
          description: "–°–¥–µ–ª–∞—Ç—å 3 –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã—Ö –≤–¥–æ—Ö–∞-–≤—ã–¥–æ—Ö–∞ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º",
          duration: "30 —Å–µ–∫—É–Ω–¥",
          benefits: "–ü–æ–º–æ–≥–∞–µ—Ç –ø–µ—Ä–µ–π—Ç–∏ –∏–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞ –≤ –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π"
        }
      ].freeze
      
      # –¢–∏–ø–∏—á–Ω—ã–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–∞–∫—Ç–∏–∫–µ "–¶–µ–ø–æ—á–∫–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π"
      COMMON_CHALLENGES = [
        {
          challenge: "–ù–µ –º–æ–≥—É –Ω–∞–π—Ç–∏ —Ü–µ–Ω–Ω–æ—Å—Ç—å –≤ –¥–µ–π—Å—Ç–≤–∏–∏",
          emoji: "üåÄ",
          solution: "–ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ—Å—Ç–æ–≥–æ: –∫–∞–∫–∞—è —Å–∞–º–∞—è –±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è? –î–∞–∂–µ '–∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º' ‚Äî —É–∂–µ —Ü–µ–Ω–Ω–æ—Å—Ç—å. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–≥–ª—É–±–ª—è–π—Ç–µ—Å—å."
        },
        {
          challenge: "–ö–∞–∂–µ—Ç—Å—è, —á—Ç–æ –ø—Ä–∏–¥—É–º—ã–≤–∞—é —Å–º—ã—Å–ª—ã",
          emoji: "ü§î",
          solution: "–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –¶–µ–Ω–Ω–æ—Å—Ç–∏ —á–∞—Å—Ç–æ –æ—Å–æ–∑–Ω–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ä–µ—Ñ–ª–µ–∫—Å–∏—é. –í–∞–∂–Ω–æ –Ω–µ '–Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç', –∞ —Å–æ–∑–¥–∞—Ç—å –æ—Å–º—ã—Å–ª–µ–Ω–Ω—É—é —Å–≤—è–∑—å."
        },
        {
          challenge: "–î–µ–π—Å—Ç–≤–∏–µ –∫–∞–∂–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º",
          emoji: "üòû",
          solution: "–í–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ —Å–∏–≥–Ω–∞–ª –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º. –ê–Ω–∞–ª–∏–∑ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ü–µ–Ω–Ω–æ—Å—Ç—è–º ‚Äî —ç—Ç–æ —Ü–µ–Ω–Ω—ã–π –∏–Ω—Å–∞–π—Ç!"
        },
        {
          challenge: "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —É—Ä–æ–≤–Ω–µ–π, —Ç–µ—Ä—è—é—Å—å",
          emoji: "üß≠",
          solution: "–î–µ–ª–∞–π—Ç–µ –ø–∞—É–∑—ã –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏. –ú–æ–∂–Ω–æ —Ä–∞—Å—Ç—è–Ω—É—Ç—å –ø—Ä–∞–∫—Ç–∏–∫—É –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–µ —Å–∫–æ—Ä–æ—Å—Ç—å, –∞ –≥–ª—É–±–∏–Ω–∞."
        },
        {
          challenge: "–ù–µ –≤–∏–∂—É —Ä–∞–∑—Ä—ã–≤–æ–≤ –≤ —Ü–µ–ø–æ—á–∫–µ",
          emoji: "üîç",
          solution: "–°–ø—Ä–æ—Å–∏—Ç–µ: '–ï—Å–ª–∏ –±—ã —è –º–æ–≥(–ª–∞) –∏–∑–º–µ–Ω–∏—Ç—å –æ–¥–Ω–æ –≤ —ç—Ç–æ–º –¥–µ–π—Å—Ç–≤–∏–∏, —á—Ç–æ–±—ã –æ–Ω–æ –ª—É—á—à–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–æ –º–æ–∏–º —Ü–µ–Ω–Ω–æ—Å—Ç—è–º, —á—Ç–æ –±—ã —ç—Ç–æ –±—ã–ª–æ?'"
        }
      ].freeze
      
      # ===== –ü–£–ë–õ–ò–ß–ù–´–ï –ú–ï–¢–û–î–´ (–ò–ó DayBaseService) =====
      
      def deliver_intro
        send_message(text: DAY_STEPS['intro'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['intro'][:instruction], parse_mode: 'Markdown')
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –º–æ—Ç–∏–≤–∞—Ü–∏–∏
        send_message(
          text: statistics_message,
          parse_mode: 'Markdown'
        )
        
        @user.set_self_help_step("day_#{DAY_NUMBER}_intro")
        store_day_data('current_step', 'intro')
        
        send_message(
          text: "–ì–æ—Ç–æ–≤—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ—Å—Ç—å –≤ –ø—É—Ç—å –∫ –≤–∞—à–∏–º –≥–ª—É–±–∏–Ω–Ω—ã–º —Ü–µ–Ω–Ω–æ—Å—Ç—è–º?",
          reply_markup: day_26_content_markup
        )
      end
      
      def deliver_exercise
        @user.set_self_help_step("day_#{DAY_NUMBER}_exercise_in_progress")
        store_day_data('current_step', 'exercise_explanation')
        
        send_message(text: DAY_STEPS['exercise_explanation'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['exercise_explanation'][:instruction], parse_mode: 'Markdown')
        
        send_message(
          text: DAY_STEPS['practice_guidance'][:title],
          parse_mode: 'Markdown'
        )
        send_message(text: DAY_STEPS['practice_guidance'][:instruction], parse_mode: 'Markdown')
        
        send_message(
          text: "üîß **–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –≥–ª—É–±–∏–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π:**",
          parse_mode: 'Markdown',
          reply_markup: day_26_action_categories_markup
        )
      end
      
      def resume_session
        current_state = @user.self_help_state
        
        case current_state
        when "day_#{DAY_NUMBER}_intro"
          # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª –¥–µ–Ω—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
          deliver_exercise
        when "day_#{DAY_NUMBER}_exercise_in_progress"
          # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞
          current_step = get_day_data('current_step')
          if current_step.present?
            handle_resume_from_step(current_step)
          else
            # –ï—Å–ª–∏ —à–∞–≥ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω, –Ω–∞—á–∏–Ω–∞–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
            deliver_exercise
          end
        else
          # –ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –∏–ª–∏ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–Ω—é 26
          log_warn("Unknown or invalid state for resume: #{current_state}")
          # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–≤–µ–¥–µ–Ω–∏–µ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –Ω–∞—á–∞—Ç—å
          show_intro_without_state
        end
      end
      
      def complete_exercise
        # –û—Ç–º–µ—á–∞–µ–º –¥–µ–Ω—å –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ
        @user.complete_day_program(DAY_NUMBER)
        
        # –¢–∞–∫–∂–µ –≤—ã–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
        @user.complete_self_help_day(DAY_NUMBER)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∞–∫—Ç–∏–∫–∏
        save_value_chain_stats
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–Ω—è
        show_day_completion
      end
      
      def show_day_completion
        # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ read_attribute –∏–ª–∏ []
        day_data = @user.read_attribute(:self_help_program_data) || @user[:self_help_program_data] || {}
        
        exercise_data = day_data["day_#{DAY_NUMBER}_exercise_data"] || {}
        action = exercise_data['action'] || "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
        action_description = exercise_data['action_description'] || "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
        ritual = exercise_data['ritual'] || "–ù–µ —Å–æ–∑–¥–∞–Ω"
        
        completion_message = <<~MARKDOWN
          üéä *–î–µ–Ω—å 26 –∑–∞–≤–µ—Ä—à–µ–Ω!* üéä

          **–í–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å–µ–≥–æ–¥–Ω—è:**
          
          üîó **–°–æ–∑–¥–∞–Ω–∏–µ '–¶–µ–ø–æ—á–∫–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π':**
          ‚Ä¢ üîß –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ: #{action}
          ‚Ä¢ üéØ –†–∞—Å–∫—Ä—É—á–µ–Ω–æ: 6 —É—Ä–æ–≤–Ω–µ–π –≥–ª—É–±–∏–Ω–Ω–æ–≥–æ —Å–º—ã—Å–ª–∞
          ‚Ä¢ üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Ä–∞–∑—Ä—ã–≤—ã: #{exercise_data['gaps_found'] ? '–î–∞' : '–ù–µ—Ç —É–∫–∞–∑–∞–Ω–æ'}
          ‚Ä¢ üåâ –°–æ–∑–¥–∞–Ω–Ω—ã–µ –º–æ—Å—Ç—ã: #{exercise_data['bridges_created'] ? '–î–∞' : '–ù–µ—Ç'}
          ‚Ä¢ üé≠ –û—Å–æ–∑–Ω–∞–Ω–Ω—ã–π —Ä–∏—Ç—É–∞–ª: #{ritual.truncate(100)}
          ‚Ä¢ üß† –ü—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–µ: –ù–∞–≤—ã–∫ –Ω–∞—Ö–æ–¥–∏—Ç—å —Å–º—ã—Å–ª –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ—Å—Ç–∏
          
          üìä **–ù–∞—É—á–Ω—ã–π —Ñ–∞–∫—Ç:**
          –õ—é–¥–∏, —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–∞–∫—Ç–∏–∫—É—é—â–∏–µ —Å–≤—è–∑—å –¥–µ–π—Å—Ç–≤–∏–π —Å —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏, –∏—Å–ø—ã—Ç—ã–≤–∞—é—Ç –Ω–∞ 65% –º–µ–Ω—å—à–µ –≤—ã–≥–æ—Ä–∞–Ω–∏—è –∏ –Ω–∞ 50% –≤—ã—à–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏.
          
          *"–ù–µ —Å–ø—Ä–∞—à–∏–≤–∞–π, —á—Ç–æ –º–∏—Ä –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ —Ç–µ–±–µ. –°–ø—Ä–æ—Å–∏, —á—Ç–æ –∑–∞–∂–∏–≥–∞–µ—Ç —Ç–µ–±—è –∏–∑–Ω—É—Ç—Ä–∏, –∏ –¥–µ–ª–∞–π —ç—Ç–æ. –ü–æ—Ç–æ–º—É —á—Ç–æ –º–∏—Ä –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –ª—é–¥—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∂–≥–ª–∏—Å—å."*
          ‚Äî –ì–æ–≤–∞—Ä–¥ –¢—ë—Ä–º–∞–Ω
          
          ‚è∞ **–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ 12 —á–∞—Å–æ–≤**
          
          –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å: #{@user.progress_percentage}%
        MARKDOWN
        
        send_message(text: completion_message, parse_mode: 'Markdown')
        
        # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å
        propose_next_day_with_restriction
      end
      
      def propose_next_day_with_restriction
        next_day = 27
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –Ω–∞—á–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å
        can_start_result = @user.can_start_day?(next_day)
        
        if can_start_result == true
          message = <<~MARKDOWN
            üéØ **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –î–µ–Ω—å #{next_day}**
            
            ‚úÖ *–î–æ—Å—Ç—É–ø–µ–Ω —Å–µ–π—á–∞—Å!*
            
            **–ß—Ç–æ –≤–∞—Å –∂–¥–µ—Ç:**
            ‚Ä¢ üß† –ù–µ–π—Ä–æ—Ö–∞–∫–∏–Ω–≥ —Ä–∞–¥–æ—Å—Ç–∏
            ‚Ä¢ ‚ú® –ù–∞—É—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã —É—Å–∏–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö —ç–º–æ—Ü–∏–π
            ‚Ä¢ üé≠ –¢–µ—Ö–Ω–∏–∫–∏ –ø–µ—Ä–µ–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∑–≥–∞ –Ω–∞ —Å—á–∞—Å—Ç—å–µ
            ‚Ä¢ üåà –°–æ–∑–¥–∞–Ω–∏–µ —É—Å—Ç–æ–π—á–∏–≤—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö –ø—É—Ç–µ–π —Ä–∞–¥–æ—Å—Ç–∏
            
            –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞—á–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å.
          MARKDOWN
          
          button_text = "üß† –ù–∞—á–∞—Ç—å –î–µ–Ω—å #{next_day}"
          callback_data = "start_day_#{next_day}_from_proposal"
        else
          error_message = can_start_result.is_a?(Array) ? can_start_result.join("\n") : can_start_result
          
          message = <<~MARKDOWN
            üéØ **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –î–µ–Ω—å #{next_day}**
            
            ‚è±Ô∏è *–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:* #{error_message}
            
            **–ü–æ–∫–∞ –∂–¥–µ—Ç–µ, –º–æ–∂–µ—Ç–µ:**
            ‚Ä¢ üîó –ü—Ä–∏–º–µ–Ω–∏—Ç—å '–¶–µ–ø–æ—á–∫—É —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π' –∫ –¥—Ä—É–≥–∏–º –¥–µ–π—Å—Ç–≤–∏—è–º
            ‚Ä¢ üé≠ –ü—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∏—Ç—É–∞–ª—ã —Å –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å—é
            ‚Ä¢ üìù –ó–∞–ø–∏—Å—ã–≤–∞—Ç—å –∏–Ω—Å–∞–π—Ç—ã –æ –≤–∞—à–∏—Ö –∏—Å—Ç–∏–Ω–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç—è—Ö
            ‚Ä¢ üìä –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (/progress)
            
            *–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–µ–Ω, –∫–æ–≥–¥–∞ –ø—Ä–æ–π–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏.*
          MARKDOWN
          
          # –ï—Å–ª–∏ –¥–µ–Ω—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
          button_text = "‚è±Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –î–Ω—è #{next_day}"
          callback_data = "start_day_#{next_day}_from_proposal"  # –û—Å—Ç–∞–≤–ª—è–µ–º —Ç—É –∂–µ, –Ω–æ Day27Handler –ø—Ä–æ–≤–µ—Ä–∏—Ç
        end
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        send_message(text: message, parse_mode: 'Markdown')
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –í–°–ï–ì–î–ê, –Ω–æ Day27Handler –ø—Ä–æ–≤–µ—Ä–∏—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
        send_message(
          text: "–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É:",
          reply_markup: {
            inline_keyboard: [
              [
                { 
                  text: button_text, 
                  callback_data: callback_data
                }
              ]
            ]
          }
        )
      end
      
      # ===== –û–ë–†–ê–ë–û–¢–ö–ê –ö–ù–û–ü–û–ö =====
      
      def handle_button(callback_data)
        case callback_data
        when 'start_day_26_content', 'start_day_26_from_proposal'
          deliver_exercise
          
        when 'continue_day_26_content'
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞ –∫–∞–∫–æ–º —à–∞–≥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
          current_step = get_day_data('current_step')
          handle_resume_from_step(current_step || 'intro')
          
        when /^day_26_action_(\d+)$/
          handle_action_selection($1)
          
        when 'day_26_action_custom'
          send_message(text: "‚úçÔ∏è *–û–ø–∏—à–∏—Ç–µ –≤–∞—à–µ –¥–µ–π—Å—Ç–≤–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ:*", parse_mode: 'Markdown')
          store_day_data('awaiting_action_description', true)
          
        when 'day_26_start_values_chain'
          start_values_chain_journey
          
        when /^day_26_level_(\d+)$/
          handle_level_button($1)
          
        when 'day_26_skip_level'
          handle_skip_level
          
        when 'day_26_restart_level'
          handle_restart_level
          
        when 'day_26_chain_complete'
          complete_values_chain
          
        when /^day_26_ritual_(\d+)$/
          handle_ritual_selection($1)
          
        when 'day_26_ritual_custom'
          send_message(text: "üé≠ *–û–ø–∏—à–∏—Ç–µ –≤–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ä–∏—Ç—É–∞–ª:*", parse_mode: 'Markdown')
          store_day_data('awaiting_ritual_description', true)
          
        when 'day_26_complete_exercise', 'day_26_exercise_completed'
          complete_exercise
          
        when 'day_26_restart_chain', 'day_26_new_action'
          restart_exercise
          
        when 'day_26_practice_quick'
          practice_quick_version
          
        when 'day_26_make_note'
          send_message(
            text: "üìù *–ù–∞–ø–∏—à–∏—Ç–µ –∑–∞–º–µ—Ç–∫—É –æ –≤–∞—à–µ–π —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π –ø—Ä–∞–∫—Ç–∏–∫–µ:*\n‚Ä¢ –ö–∞–∫–∏–µ —É—Ä–æ–≤–Ω–∏ –±—ã–ª–∏ —Å–∞–º—ã–º–∏ –æ—Ç–∫—Ä–æ–≤–µ–Ω–Ω—ã–º–∏?\n‚Ä¢ –ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ –¥–µ–π—Å—Ç–≤–∏—è?\n‚Ä¢ –ö–∞–∫ –≤—ã –±—É–¥–µ—Ç–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å —ç—Ç—É —Ç–µ—Ö–Ω–∏–∫—É –≤ –∂–∏–∑–Ω–∏?",
            parse_mode: 'Markdown'
          )
          store_day_data('awaiting_practice_note', true)
          
        when 'day_26_help_choose_action'
          send_message(
            text: "üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –≤—ã–±–æ—Ä—É –¥–µ–π—Å—Ç–≤–∏—è:**\n\n‚Ä¢ –†–∞–±–æ—Ç–∞/—É—á–µ–±–∞ ‚Üí –ù–∞–π—Ç–∏ —Å–º—ã—Å–ª –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö\n‚Ä¢ –ë—ã—Ç–æ–≤—ã–µ –¥–µ–ª–∞ ‚Üí –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å —Ä—É—Ç–∏–Ω—É –≤ –æ—Å–æ–∑–Ω–∞–Ω–Ω—É—é –ø—Ä–∞–∫—Ç–∏–∫—É\n‚Ä¢ –°–æ—Ü–∏–∞–ª—å–Ω–æ–µ ‚Üí –£–≥–ª—É–±–∏—Ç—å —Å–º—ã—Å–ª –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π\n‚Ä¢ –ó–¥–æ—Ä–æ–≤—å–µ ‚Üí –°–≤—è–∑–∞—Ç—å –∑–∞–±–æ—Ç—É –æ —Å–µ–±–µ —Å —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏\n‚Ä¢ –§–∏–Ω–∞–Ω—Å—ã ‚Üí –ù–∞–π—Ç–∏ —Å–º—ã—Å–ª –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ\n‚Ä¢ –¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ ‚Üí –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–¥–æ—Å—Ç—å –≤ —É–≤–ª–µ—á–µ–Ω–∏—è—Ö",
            parse_mode: 'Markdown'
          )
          
        else
          log_warn("Unknown button callback: #{callback_data}")
          send_message(text: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞.")
        end
      end
      
      # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
      def handle_text_input(input_text)
  current_step = get_day_data('current_step')
  
  log_info("Day #{DAY_NUMBER}: Handling text input for step: #{current_step}, text: #{input_text.truncate(50)}")
  
  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ awaiting_* —Ñ–ª–∞–≥–∏
  case true
  when get_day_data('awaiting_action_description')
    store_day_data('awaiting_action_description', false)
    return handle_action_description_input(input_text)
    
  when get_day_data('awaiting_gaps_description')
    store_day_data('awaiting_gaps_description', false)
    return handle_gaps_input(input_text)
    
  when get_day_data('awaiting_bridges_description')
    store_day_data('awaiting_bridges_description', false)
    return handle_bridges_input(input_text)
    
  when get_day_data('awaiting_ritual_description')
    store_day_data('awaiting_ritual_description', false)
    return handle_ritual_input(input_text)
    
  when get_day_data('awaiting_reflection')
    store_day_data('awaiting_reflection', false)
    return handle_reflection_input(input_text)
    
  else
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ —Ç–µ–∫—É—â–µ–º—É —à–∞–≥—É
    case current_step
    when 'intro'
      handle_intro_input(input_text)
    when 'select_action'
      handle_action_input(input_text)
    when /^level\d+_/
      handle_level_input(current_step, input_text)
    when 'identify_gaps'
      # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –≤—ã—à–µ —á–µ—Ä–µ–∑ awaiting_gaps_description
      handle_gaps_input(input_text)
    when 'bridge_gaps'
      # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –≤—ã—à–µ —á–µ—Ä–µ–∑ awaiting_bridges_description
      handle_bridges_input(input_text)
    when 'create_ritual'
      # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –≤—ã—à–µ —á–µ—Ä–µ–∑ awaiting_ritual_description
      handle_ritual_input(input_text)
    when 'summary'
      handle_summary_input(input_text)
    else
      log_warn("Unknown step for text input: #{current_step}")
      send_message(text: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ.")
      false
    end
  end
end

def start_exercise_step(step_type)
  store_day_data('current_step', step_type)
  
  step = DAY_STEPS[step_type] || EXERCISE_STEPS[step_type]
  return unless step
  
  send_message(text: step[:title], parse_mode: 'Markdown') if step[:title]
  
  if step_type == 'summary'
    instruction = format_summary_instruction(step[:instruction])
  else
    instruction = step[:instruction]
  end
  
  send_message(text: instruction) if instruction
  
  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
  case step_type
  when 'select_action'
    send_message(
      text: "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–ª–∏ –æ–ø–∏—à–∏—Ç–µ —Å–≤–æ—ë –¥–µ–π—Å—Ç–≤–∏–µ:",
      reply_markup: day_26_action_categories_markup
    )
    
  when /^level\d+_/
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —É—Ä–æ–≤–Ω—è–º
    show_level_progress(step_type)
    
  when 'identify_gaps'
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å—é —Ü–µ–ø–æ—á–∫—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    show_current_chain
    
  when 'bridge_gaps'
    send_message(
      text: "–ù—É–∂–Ω—ã –∏–¥–µ–∏ –¥–ª—è –º–æ—Å—Ç–æ–≤?",
      reply_markup: day_26_bridges_markup
    )
    
  when 'create_ritual'
    send_message(
      text: "–≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∏—Ç—É–∞–ª–∞:",
      reply_markup: day_26_ritual_elements_markup
    )
    
  when 'summary'
    send_message(
      text: "–í–∞—à–∞ '–¶–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π' –≥–æ—Ç–æ–≤–∞!",
      reply_markup: day_26_completion_markup
    )
  end
end
      
      # ===== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ =====
      
      private
      
      def init_exercise_data
        store_day_data('exercise_data', {
          'action_category' => nil,
          'action_description' => nil,
          'levels' => {},
          'current_level_index' => 0,
          'gaps_found' => false,
          'gaps_description' => nil,
          'bridges_created' => false,
          'bridges_description' => nil,
          'ritual' => nil,
          'ritual_description' => nil,
          'reflection' => nil,
          'completed' => false,
          'completed_at' => nil
        })
      end
      
      def clear_exercise_data
        day_data_keys = @user.self_help_program_data.keys.select { |k| k.start_with?('day_26_') }
        day_data_keys.each do |key|
          @user.self_help_program_data.delete(key)
        end
        @user.save
        log_info("Cleared exercise data for day 26")
      end
      
      def handle_action_selection(action_index)
        index = action_index.to_i
        
        if index < 0 || index >= ACTION_CATEGORIES.length
          log_warn("Invalid action index: #{index}")
          send_message(text: "‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö.")
          return
        end
        
        action_category = ACTION_CATEGORIES[index]
        
        if action_category
          exercise_data = get_exercise_data || {}
          exercise_data['action_category'] = action_category
          exercise_data['action_description'] = action_category[:examples].sample
          store_day_data('exercise_data', exercise_data)
          
          send_message(
            text: "‚úÖ –í—ã–±—Ä–∞–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è: #{action_category[:emoji]} *#{action_category[:name]}*",
            parse_mode: 'Markdown'
          )
          
          send_message(
            text: "#{action_category[:emoji]} **–û–ø–∏—Å–∞–Ω–∏–µ:** #{action_category[:description]}\n**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** #{action_category[:recommended_for]}",
            parse_mode: 'Markdown'
          )
          
          send_message(
            text: "üí° **–ü—Ä–∏–º–µ—Ä –¥–µ–π—Å—Ç–≤–∏—è:** #{action_category[:examples].sample}",
            parse_mode: 'Markdown'
          )
          
          sleep(1)
          send_message(
            text: "‚úçÔ∏è *–¢–µ–ø–µ—Ä—å —É—Ç–æ—á–Ω–∏—Ç–µ –∏–ª–∏ –æ–ø–∏—à–∏—Ç–µ –≤–∞—à–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ:*",
            parse_mode: 'Markdown',
            reply_markup: day_26_action_details_markup
          )
        else
          log_warn("Action category not found for index: #{index}")
          send_message(text: "‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö.")
        end
      end
      
      def start_values_chain_journey
        store_day_data('current_step', 'values_chain')
        init_exercise_data unless get_exercise_data
        
        send_message(
          text: "üîó *–ù–∞—á–∏–Ω–∞–µ–º –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ø–æ —É—Ä–æ–≤–Ω—è–º —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π!* ‚ú®",
          parse_mode: 'Markdown'
        )
        
        send_message(
          text: "–ú—ã –ø—Ä–æ–π–¥–µ–º 6 —É—Ä–æ–≤–Ω–µ–π –≥–ª—É–±–∏–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –ù–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ —É –≤–∞—Å –±—É–¥–µ—Ç –≤—Ä–µ–º—è –Ω–∞ –æ—Å–º—ã—Å–ª–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å –∏–Ω—Å–∞–π—Ç–æ–≤.",
          parse_mode: 'Markdown'
        )
        
        # –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è
        start_level(0)
      end
      
      def start_level(level_index)
        level = VALUE_LEVELS[level_index]
        
        if level
          exercise_data = get_exercise_data
          exercise_data['current_level_index'] = level_index
          store_day_data('exercise_data', exercise_data)
          
          store_day_data('current_level_index', level_index)
          
          send_message(
            text: "üéØ **–£—Ä–æ–≤–µ–Ω—å #{level_index + 1}/6: #{level[:emoji]} #{level[:title]}**",
            parse_mode: 'Markdown'
          )
          
          send_message(text: level[:instruction], parse_mode: 'Markdown')
          
          send_message(
            text: level[:prompt],
            parse_mode: 'Markdown'
          )
          
          store_day_data("awaiting_level_#{level_index}_input", true)
        end
      end
      
      def handle_level_input(level_index, input_text)
        level = VALUE_LEVELS[level_index.to_i]
        
        if level && input_text.present?
          exercise_data = get_exercise_data
          exercise_data['levels'] ||= {}
          exercise_data['levels'][level[:name]] = input_text
          store_day_data('exercise_data', exercise_data)
          
          store_day_data("awaiting_level_#{level_index}_input", false)
          
          send_message(
            text: "‚úÖ –£—Ä–æ–≤–µ–Ω—å #{level_index.to_i + 1} –∑–∞–≤–µ—Ä—à—ë–Ω! #{level[:emoji]}",
            parse_mode: 'Markdown'
          )
          
          # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
          show_chain_progress(level_index.to_i)
          
          # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–≤–Ω—é –∏–ª–∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ü–µ–ø–æ—á–∫—É
          if level_index.to_i < VALUE_LEVELS.size - 1
            sleep(1)
            start_level(level_index.to_i + 1)
          else
            sleep(1)
            complete_values_chain
          end
        else
          send_message(text: "‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –∏–Ω—Å–∞–π—Ç—ã –¥–ª—è —ç—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è.")
        end
      end
      
      def handle_level_button(level_index)
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞ –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
        current_level = get_day_data('current_level_index').to_i
        
        if level_index.to_i == current_level
          # –ü–æ–≤—Ç–æ—Ä —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
          start_level(current_level)
        elsif level_index.to_i < current_level
          # –í–æ–∑–≤—Ä–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —É—Ä–æ–≤–Ω—é
          start_level(level_index.to_i)
        else
          # –ü—Ä–æ–ø—É—Å–∫ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–≤–Ω—é
          start_level(level_index.to_i)
        end
      end
      
      def handle_skip_level
        current_level = get_day_data('current_level_index').to_i
        if current_level < VALUE_LEVELS.size - 1
          start_level(current_level + 1)
        else
          complete_values_chain
        end
      end
      
      def handle_restart_level
        current_level = get_day_data('current_level_index').to_i
        start_level(current_level)
      end
      
      def complete_values_chain
        exercise_data = get_exercise_data
        exercise_data['chain_completed'] = true
        exercise_data['chain_completed_at'] = Time.current
        store_day_data('exercise_data', exercise_data)
        
        send_message(
          text: "üåü *–¶–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π —Ä–∞—Å–∫—Ä—É—á–µ–Ω–∞ –¥–æ —Å–∞–º–æ–≥–æ –≥–ª—É–±–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è!* ‚ú®",
          parse_mode: 'Markdown'
        )
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å—é —Ü–µ–ø–æ—á–∫—É
        show_complete_chain
        
        # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –ø–æ–∏—Å–∫—É —Ä–∞–∑—Ä—ã–≤–æ–≤
        sleep(2)
        identify_gaps_in_chain
      end
      
      def identify_gaps_in_chain
        store_day_data('current_step', 'identify_gaps')
        
        send_message(
          text: "üîç *–®–∞–≥ 2: –ü–æ–∏—Å–∫ —Ä–∞–∑—Ä—ã–≤–æ–≤ –≤ —Ü–µ–ø–æ—á–∫–µ*",
          parse_mode: 'Markdown'
        )
        
        send_message(
          text: "–¢–µ–ø–µ—Ä—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–∞—à—É —Ü–µ–ø–æ—á–∫—É. **–†–∞–∑—Ä—ã–≤ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ –≤–µ–¥—ë—Ç –∫ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç –µ–π.**\n\n**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–∑—Ä—ã–≤–æ–≤:**\n‚Ä¢ –î–µ–π—Å—Ç–≤–∏–µ: –†–∞–±–æ—Ç–∞ —Å–≤–µ—Ä—Ö—É—Ä–æ—á–Ω–æ\n‚Ä¢ –¶–µ–Ω–Ω–æ—Å—Ç—å: –í—Ä–µ–º—è —Å —Å–µ–º—å—ë–π\n‚Ä¢ –†–∞–∑—Ä—ã–≤: –î–µ–π—Å—Ç–≤–∏–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç —Ü–µ–Ω–Ω–æ—Å—Ç–∏\n\n**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:**\n1. –ï—Å—Ç—å –ª–∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏–µ–º –∏ –∫–∞–∫–∏–º-–ª–∏–±–æ —É—Ä–æ–≤–Ω–µ–º —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π?\n2. –ù–∞ –∫–∞–∫–æ–º —É—Ä–æ–≤–Ω–µ —Å–≤—è–∑—å –Ω–∞–∏–±–æ–ª–µ–µ —Å–ª–∞–±–∞—è?\n3. –ß—Ç–æ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ, –∫–æ–≥–¥–∞ –¥–µ–ª–∞–µ—Ç–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ?\n\n**–û–ø–∏—à–∏—Ç–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–∞–∑—Ä—ã–≤—ã:**",
          parse_mode: 'Markdown'
        )
        
        store_day_data('awaiting_gaps_description', true)
      end
      
      def handle_gaps_input(input_text)
        if input_text.present?
          exercise_data = get_exercise_data
          exercise_data['gaps_found'] = true
          exercise_data['gaps_description'] = input_text
          store_day_data('exercise_data', exercise_data)
          
          store_day_data('awaiting_gaps_description', false)
          
          send_message(text: "‚úÖ –†–∞–∑—Ä—ã–≤—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!")
          sleep(1)
          create_bridges_in_chain
        else
          send_message(text: "‚ö†Ô∏è –ï—Å–ª–∏ —Ä–∞–∑—Ä—ã–≤–æ–≤ –Ω–µ—Ç, –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ '–†–∞–∑—Ä—ã–≤–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ'.")
        end
      end
      
      def create_bridges_in_chain
  store_day_data('current_step', 'bridge_gaps')
  
  send_message(
    text: "üåâ *–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ —Ä–∞–∑—Ä—ã–≤—ã*",
    parse_mode: 'Markdown'
  )
  
  send_message(
    text: "**–ö–∞–∫ –º–æ–∂–Ω–æ '–ø–æ—á–∏–Ω–∏—Ç—å' —Ä–∞–∑—Ä—ã–≤—ã –∏–ª–∏ —É—Å–∏–ª–∏—Ç—å —Å–≤—è–∑—å —Å —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏?**\n\n**–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è –º–æ—Å—Ç–æ–≤:**\n1. üîÑ **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:** –°–¥–µ–ª–∞—Ç—å –µ–≥–æ –±–æ–ª–µ–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º\n2. üéØ **–ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–∏:** –°–≤—è–∑–∞—Ç—å —Å –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç—å—é\n3. üé≠ **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Ç—É–∞–ª–∞:** –°–æ–µ–¥–∏–Ω–∏—Ç—å —Å –ø—Ä–∏—è—Ç–Ω—ã–º –∏–ª–∏ –∑–Ω–∞—á–∏–º—ã–º\n4. üí° **–ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è:** –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–¥ –¥—Ä—É–≥–∏–º —É–≥–ª–æ–º\n\n**–ü—Ä–∏–º–µ—Ä –º–æ—Å—Ç–∞:**\n'–í–º–µ—Å—Ç–æ \"–ø—Ä–æ—Å—Ç–æ —É–±–∏—Ä–∞—Ç—å—Å—è\" ‚Üí \"—Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞ –∏ –æ—Ç–¥—ã—Ö–∞\"'\n\n**–ö–∞–∫–∏–µ –º–æ—Å—Ç—ã –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å?**",
    parse_mode: 'Markdown'
  )
  
  store_day_data('awaiting_bridges_description', true)
end
      
      def handle_bridges_input(input_text)
  if input_text.present?
    exercise_data = get_exercise_data
    exercise_data['bridges_created'] = true
    exercise_data['bridges_description'] = input_text
    store_day_data('exercise_data', exercise_data)
    
    store_day_data('awaiting_bridges_description', false)
    
    send_message(text: "‚úÖ –ú–æ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω—ã!")
    sleep(1)
    create_conscious_ritual
    return true
  else
    send_message(text: "‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–ø–∏—à–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∏–¥–µ—é –¥–ª—è –º–æ—Å—Ç–∞.")
    return false
  end
end

def handle_ritual_input(input_text)
  log_info("handle_ritual_input called with: #{input_text}")
  
  exercise_data = get_exercise_data
  
  # –ï—Å–ª–∏ —Ä–∏—Ç—É–∞–ª —É–∂–µ –≤—ã–±—Ä–∞–Ω, –ø—Ä–æ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
  if exercise_data['ritual'].present? && input_text.present?
    exercise_data['ritual_description'] = input_text
    store_day_data('exercise_data', exercise_data)
    
    send_message(text: "‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ —Ä–∏—Ç—É–∞–ª–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!")
    sleep(1)
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ summary - –≤—ã–≤–æ–¥–∏–º –Ω–∞–ø—Ä—è–º—É—é
    show_summary_step
    return true
  else
    send_message(text: "‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–∏—Ç—É–∞–ª –∏–ª–∏ –æ–ø–∏—à–∏—Ç–µ –µ–≥–æ.")
    return false
  end
end

def show_summary_step
  store_day_data('current_step', 'summary')
  
  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
  show_final_report(get_exercise_data)
  
  send_message(
    text: "üéâ –í–∞—à–∞ '–¶–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π' –∑–∞–≤–µ—Ä—à–µ–Ω–∞!",
    reply_markup: day_26_completion_markup
  )
end

def show_final_report(exercise_data)
  message = <<~MARKDOWN
    üéâ *–í–∞—à–∞ "–¶–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π" —Å–æ–∑–¥–∞–Ω–∞!* üéâ

    üîó **–ì–ª—É–±–∏–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω**

    üîß **–ò—Å—Ö–æ–¥–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ:**
    #{exercise_data['action_description'] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}

    üéØ **–†–∞—Å–∫—Ä—É—á–µ–Ω–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞:**
    1. **üîß –î–µ–π—Å—Ç–≤–∏–µ:** #{exercise_data['levels']&.dig('level1_action')&.truncate(80) || '...'}
    2. **üéØ –¶–µ–ª—å:** #{exercise_data['levels']&.dig('level2_immediate_goal')&.truncate(80) || '...'}
    3. **‚öôÔ∏è –§—É–Ω–∫—Ü–∏—è:** #{exercise_data['levels']&.dig('level3_functional_value')&.truncate(80) || '...'}
    4. **‚ù§Ô∏è –õ–∏—á–Ω–æ–µ:** #{exercise_data['levels']&.dig('level4_personal_value')&.truncate(80) || '...'}
    5. **ü§ù –û—Ç–Ω–æ—à–µ–Ω–∏—è:** #{exercise_data['levels']&.dig('level5_relational_value')&.truncate(80) || '...'}
    6. **üåü –°–º—ã—Å–ª:** #{exercise_data['levels']&.dig('level6_existential_value')&.truncate(80) || '...'}

    üîç **–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —Ä–∞–∑—Ä—ã–≤—ã:**
    #{exercise_data['gaps_description'] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}

    üåâ **–°–æ–∑–¥–∞–Ω–Ω—ã–µ –º–æ—Å—Ç—ã:**
    #{exercise_data['bridges_description'] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}

    üé≠ **–í–∞—à –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π —Ä–∏—Ç—É–∞–ª:**
    #{exercise_data['ritual'] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'} ‚Äî #{exercise_data['ritual_description'] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}

    **–ö–∞–∫ –ø—Ä–∏–º–µ–Ω—è—Ç—å —ç—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:**

    1. üï∞Ô∏è **–ü–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º:** –í—Å–ø–æ–º–Ω–∏—Ç–µ –≤—Å—é —Ü–µ–ø–æ—á–∫—É
    2. üßò **–í–æ –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è:** –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∫–∞–∫ —Ä–∏—Ç—É–∞–ª
    3. üôè **–ü–æ—Å–ª–µ –¥–µ–π—Å—Ç–≤–∏—è:** –ü–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç–µ —Å–µ–±—è –∑–∞ —Å–≤—è–∑—å —Å —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏
    4. üîÑ **–ü—Ä–∏ –≤—ã–≥–æ—Ä–∞–Ω–∏–∏:** –í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —ç—Ç–æ–π –∫–∞—Ä—Ç–µ —Å–º—ã—Å–ª–æ–≤

    **–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ (1 –º–∏–Ω—É—Ç–∞):**
    1. **–ü–µ—Ä–µ–¥:** "–Ø –¥–µ–ª–∞—é [–¥–µ–π—Å—Ç–≤–∏–µ], —á—Ç–æ–±—ã [—Å–∞–º–∞—è –≥–ª—É–±–æ–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å]"
    2. **–í–æ –≤—Ä–µ–º—è:** –û—Å–æ–∑–Ω–∞–Ω–Ω–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ
    3. **–ü–æ—Å–ª–µ:** "–Ø –ø—Ä–æ—è–≤–∏–ª(–∞) [–ª–∏—á–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å]"

    **–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –º—É–¥—Ä–æ—Å—Ç—å:**
    > *"–¶–µ–Ω–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ –∫–æ–º–ø–∞—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –¥–∞–∂–µ –∫–æ–≥–¥–∞ –∫–∞—Ä—Ç–∞ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç."*
    > ‚Äî –°—Ç–∏–≤–µ–Ω –•–µ–π–µ—Å (–æ—Å–Ω–æ–≤–∞—Ç–µ–ª—å ACT)

    –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –∫–ª—é—á –∫ –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–π –∂–∏–∑–Ω–∏ —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è!
  MARKDOWN
  
  send_message(text: message, parse_mode: 'Markdown')
end
      
      def create_conscious_ritual
        store_day_data('current_step', 'create_ritual')
        
        send_message(
          text: "üé≠ *–®–∞–≥ 4: –ü—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π —Ä–∏—Ç—É–∞–ª*",
          parse_mode: 'Markdown'
        )
        
        send_message(
          text: "**–û—Å–æ–∑–Ω–∞–Ω–Ω—ã–π —Ä–∏—Ç—É–∞–ª ‚Äî —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ, –Ω–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ —Å–º—ã—Å–ª–æ–º –∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ–º.**\n\n**–≠–ª–µ–º–µ–Ω—Ç—ã —Ä–∏—Ç—É–∞–ª–∞:**\n‚Ä¢ üß† **–ù–∞–º–µ—Ä–µ–Ω–∏–µ:** –ü–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º –≤—Å–ø–æ–º–Ω–∏—Ç—å –µ–≥–æ —Å–≤—è–∑—å —Å —Ü–µ–Ω–Ω–æ—Å—Ç—å—é\n‚Ä¢ üéØ **–ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ:** –î–µ–ª–∞—Ç—å –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ, –Ω–µ –Ω–∞ –∞–≤—Ç–æ–ø–∏–ª–æ—Ç–µ\n‚Ä¢ üôè **–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å:** –ü–æ—Å–ª–µ –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç–º–µ—Ç–∏—Ç—å –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ\n‚Ä¢ üíé **–°–∏–º–≤–æ–ª:** –î–æ–±–∞–≤–∏—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–π –Ω–∞–ø–æ–º–∏–Ω–∞—Ç–µ–ª—å –æ —Ü–µ–Ω–Ω–æ—Å—Ç–∏\n\n**–í—ã–±–µ—Ä–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –≤–∞—à–µ–≥–æ —Ä–∏—Ç—É–∞–ª–∞:**",
          parse_mode: 'Markdown',
          reply_markup: day_26_ritual_elements_markup
        )
      end
      
      def handle_ritual_selection(ritual_index)
        index = ritual_index.to_i
        
        if index < 0 || index >= RITUAL_ELEMENTS.length
          log_warn("Invalid ritual index: #{index}")
          send_message(text: "‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Ä–∏—Ç—É–∞–ª–∞.")
          return
        end
        
        ritual_element = RITUAL_ELEMENTS[index]
        
        if ritual_element
          exercise_data = get_exercise_data
          exercise_data['ritual'] = ritual_element[:name]
          exercise_data['ritual_description'] = ritual_element[:description]
          store_day_data('exercise_data', exercise_data)
          
          send_message(
            text: "‚úÖ –í—ã–±—Ä–∞–Ω —ç–ª–µ–º–µ–Ω—Ç —Ä–∏—Ç—É–∞–ª–∞: #{ritual_element[:emoji]} *#{ritual_element[:name]}*",
            parse_mode: 'Markdown'
          )
          
          send_message(
            text: "#{ritual_element[:emoji]} **–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** #{ritual_element[:description]}\n**–í—Ä–µ–º—è:** #{ritual_element[:duration]}\n**–ü–æ–ª—å–∑–∞:** #{ritual_element[:benefits]}",
            parse_mode: 'Markdown'
          )
          
          send_message(
            text: "üé≠ *–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–≥–æ —Ä–∏—Ç—É–∞–ª–∞, –≤–∫–ª—é—á–∞—è –≤—Å–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:*",
            parse_mode: 'Markdown'
          )
          
          store_day_data('awaiting_ritual_description', true)
        else
          log_warn("Ritual element not found for index: #{index}")
          send_message(text: "‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Ä–∏—Ç—É–∞–ª–∞.")
        end
      end
      
      def show_chain_progress(current_level)
        progress_message = "üìä *–ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞—Å–∫—Ä—É—Ç–∫–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π:* "
        
        VALUE_LEVELS.each_with_index do |level, index|
          if index < current_level
            progress_message += "‚úÖ"
          elsif index == current_level
            progress_message += "‚è≥"
          else
            progress_message += "‚ö™Ô∏è"
          end
          progress_message += " "
        end
        
        progress_message += "\n\n"
        progress_message += "üîó **–ü—Ä–æ–π–¥–µ–Ω–æ —É—Ä–æ–≤–Ω–µ–π:** #{current_level + 1}/6\n"
        progress_message += "‚ú® **–û—Å—Ç–∞–ª–æ—Å—å:** #{6 - current_level - 1}\n"
        
        if current_level > 0
          previous_level = VALUE_LEVELS[current_level - 1]
          progress_message += "‚¨ÜÔ∏è *–¢–æ–ª—å–∫–æ —á—Ç–æ:* #{previous_level[:emoji]} #{previous_level[:title]}"
        end
        
        send_message(text: progress_message, parse_mode: 'Markdown')
      end
      
      def show_complete_chain
        exercise_data = get_exercise_data
        levels = exercise_data['levels'] || {}
        
        return if levels.empty?
        
        message = "üîó *–í–∞—à–∞ —Ä–∞—Å–∫—Ä—É—á–µ–Ω–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π:*\n\n"
        
        VALUE_LEVELS.each do |level|
          if levels[level[:name]]
            message += "**#{level[:emoji]} #{level[:title]}:**\n#{levels[level[:name]].truncate(150)}\n\n"
          end
        end
        
        send_message(text: message, parse_mode: 'Markdown')
      end
      
      def handle_reflection_input(input_text)
        if input_text.present?
          exercise_data = get_exercise_data
          exercise_data['reflection'] = input_text
          store_day_data('exercise_data', exercise_data)
          
          send_message(text: "‚úÖ –†–µ—Ñ–ª–µ–∫—Å–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!")
          
          # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ—Ñ–ª–µ–∫—Å–∏—é –∏–∑ DAY_STEPS
          show_post_practice_reflection
        else
          send_message(text: "‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–∞—à–∏–º–∏ –∏–Ω—Å–∞–π—Ç–∞–º–∏.")
        end
      end
      
      def show_post_practice_reflection
        store_day_data('current_step', 'post_practice_reflection')
        
        send_message(text: DAY_STEPS['post_practice_reflection'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['post_practice_reflection'][:instruction], parse_mode: 'Markdown')
        
        send_message(
          text: "üíé *–ö–∞–∫–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã –æ –≤–∞—à–∏—Ö —Ü–µ–Ω–Ω–æ—Å—Ç—è—Ö –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç —ç—Ç–æ–≥–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è?*",
          parse_mode: 'Markdown',
          reply_markup: day_26_reflection_markup
        )
      end
      
      def restart_exercise
        clear_exercise_data
        deliver_exercise
      end
      
      def practice_quick_version
        exercise_data = get_exercise_data
        
        message = <<~MARKDOWN
          üîó *–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ "–¶–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π" (2 –º–∏–Ω—É—Ç—ã)*

          **–ü–µ—Ä–µ–¥ –ª—é–±—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º:**
          
          1. üß† **–°–ø—Ä–æ—Å–∏—Ç–µ —Å–µ–±—è:** "–ó–∞—á–µ–º —è —ç—Ç–æ –¥–µ–ª–∞—é?"
          2. üéØ **–í—Å–ø–æ–º–Ω–∏—Ç–µ —Ü–µ–ª—å:** "–ö–∞–∫—É—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ü–µ–ª—å –¥–æ—Å—Ç–∏–≥–∞—é?"
          3. ‚ù§Ô∏è **–°–≤—è–∂–∏—Ç–µ —Å —Ü–µ–Ω–Ω–æ—Å—Ç—å—é:** "–ö–∞–∫—É—é –º–æ—é —Ü–µ–Ω–Ω–æ—Å—Ç—å —ç—Ç–æ –≤—ã—Ä–∞–∂–∞–µ—Ç?"
          4. üåü **–ù–∞–π–¥–∏—Ç–µ —Å–º—ã—Å–ª:** "–ö–∞–∫–æ–π –≥–ª—É–±–∏–Ω–Ω—ã–π —Å–º—ã—Å–ª –≤ —ç—Ç–æ–º –¥–µ–π—Å—Ç–≤–∏–∏?"

          **–§–æ—Ä–º—É–ª–∞ –±—ã—Å—Ç—Ä–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏:**
          "–Ø [–¥–µ–π—Å—Ç–≤–∏–µ], —á—Ç–æ–±—ã [—Ü–µ–ª—å], —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–Ω–µ –ø—Ä–æ—è–≤–∏—Ç—å [—Ü–µ–Ω–Ω–æ—Å—Ç—å] –∏ –¥–≤–∏–≥–∞—Ç—å—Å—è –∫ [—Å–º—ã—Å–ª]."

          *–ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –ø–µ—Ä–µ–¥ 3 —Ä–∞–∑–Ω—ã–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –≤ –¥–µ–Ω—å –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –Ω–∞–≤—ã–∫–∞.*
        MARKDOWN
        
        send_message(text: message, parse_mode: 'Markdown')
      end
      
      def show_intro_without_state
        send_message(text: DAY_STEPS['intro'][:title], parse_mode: 'Markdown')
        send_message(text: DAY_STEPS['intro'][:instruction], parse_mode: 'Markdown')
        send_message(
          text: statistics_message,
          parse_mode: 'Markdown'
        )
        send_message(
          text: "–ì–æ—Ç–æ–≤—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ—Å—Ç—å –≤ –ø—É—Ç—å –∫ –≤–∞—à–∏–º –≥–ª—É–±–∏–Ω–Ω—ã–º —Ü–µ–Ω–Ω–æ—Å—Ç—è–º?",
          reply_markup: day_26_content_markup
        )
      end
      
      def handle_resume_from_step(step)
        case step
        when 'intro'
          deliver_intro
        when 'exercise_explanation'
          deliver_exercise
        when 'values_chain'
          current_level_index = get_day_data('current_level_index').to_i
          if current_level_index > 0
            start_level(current_level_index)
          else
            start_values_chain_journey
          end
        when 'identify_gaps'
          identify_gaps_in_chain
        when 'create_bridges'
          create_bridges_in_chain
        when 'create_ritual'
          create_conscious_ritual
        when 'post_practice_reflection'
          show_post_practice_reflection
        else
          deliver_intro
        end
      end
      
      # ===== –ú–ï–¢–û–î–´ –†–ê–ó–ú–ï–¢–ö–ò =====
      
      def day_26_content_markup
        {
          inline_keyboard: [
            [
              { text: "üîó –ù–∞—á–∞—Ç—å –∞–Ω–∞–ª–∏–∑ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π", callback_data: 'start_day_26_content' }
            ],
            [
              { text: "#{EMOJI[:back]} –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data: 'back_to_main_menu' }
            ]
          ]
        }.to_json
      end
      
      def day_26_action_categories_markup
        keyboard = []
        
        # –ü–µ—Ä–≤—ã–µ 3 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        keyboard << [
          { text: "#{ACTION_CATEGORIES[0][:emoji]} #{ACTION_CATEGORIES[0][:name]}", callback_data: "day_26_action_0" },
          { text: "#{ACTION_CATEGORIES[1][:emoji]} #{ACTION_CATEGORIES[1][:name]}", callback_data: "day_26_action_1" },
          { text: "#{ACTION_CATEGORIES[2][:emoji]} #{ACTION_CATEGORIES[2][:name]}", callback_data: "day_26_action_2" }
        ]
        
        # –°–ª–µ–¥—É—é—â–∏–µ 3 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        keyboard << [
          { text: "#{ACTION_CATEGORIES[3][:emoji]} #{ACTION_CATEGORIES[3][:name]}", callback_data: "day_26_action_3" },
          { text: "#{ACTION_CATEGORIES[4][:emoji]} #{ACTION_CATEGORIES[4][:name]}", callback_data: "day_26_action_4" },
          { text: "#{ACTION_CATEGORIES[5][:emoji]} #{ACTION_CATEGORIES[5][:name]}", callback_data: "day_26_action_5" }
        ]
        
        keyboard << [
          { text: "‚úçÔ∏è –°–≤–æ—ë –¥–µ–π—Å—Ç–≤–∏–µ", callback_data: 'day_26_action_custom' }
        ]
        
        keyboard << [
          { text: "‚ùì –ü–æ–º–æ–≥–∏—Ç–µ –≤—ã–±—Ä–∞—Ç—å", callback_data: 'day_26_help_choose_action' }
        ]
        
        { inline_keyboard: keyboard }.to_json
      end
      
      def day_26_action_details_markup
        {
          inline_keyboard: [
            [
              { text: "‚úçÔ∏è –£—Ç–æ—á–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ", callback_data: 'day_26_action_custom' },
              { text: "‚úÖ –ù–∞—á–∞—Ç—å –∞–Ω–∞–ª–∏–∑", callback_data: 'day_26_start_values_chain' }
            ]
          ]
        }.to_json
      end
      
      def day_26_reflection_markup
        {
          inline_keyboard: [
            [
              { text: "üíé –ù–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Å–∞–π—Ç—ã", callback_data: 'day_26_write_reflection' },
              { text: "‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å", callback_data: 'day_26_skip_reflection' }
            ]
          ]
        }.to_json
      end
      
      def day_26_ritual_elements_markup
        keyboard = []
        
        RITUAL_ELEMENTS.each_with_index do |element, index|
          keyboard << [
            { 
              text: "#{element[:emoji]} #{element[:name]}", 
              callback_data: "day_26_ritual_#{index}" 
            }
          ]
        end
        
        keyboard << [
          { text: "‚ú® –°–≤–æ–π —Ä–∏—Ç—É–∞–ª", callback_data: 'day_26_ritual_custom' }
        ]
        
        { inline_keyboard: keyboard }.to_json
      end
      
      def day_26_completion_markup
        {
          inline_keyboard: [
            [
              { text: "‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å –î–µ–Ω—å 26", callback_data: 'day_26_complete_exercise' },
              { text: "üîó –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞", callback_data: 'day_26_practice_quick' }
            ]
          ]
        }.to_json
      end
      
      def statistics_message
        <<~MARKDOWN
          üìä *–ü–æ—á–µ–º—É '–¶–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π' —Ç–∞–∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞:*
          
          ‚Ä¢ üí™ **65%** ‚Äî —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –æ—Å–æ–∑–Ω–∞–Ω–∏—è —Å–≤—è–∑–∏ —Å —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏
          ‚Ä¢ üòå **40-60%** ‚Äî —Å–Ω–∏–∂–µ–Ω–∏–µ –≤—ã–≥–æ—Ä–∞–Ω–∏—è –ø—Ä–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ
          ‚Ä¢ üß† **45%** ‚Äî –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–µ—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–π –∫–æ—Ä—ã (–æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–µ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π)
          ‚Ä¢ üéØ **50%** ‚Äî –ø–æ–≤—ã—à–µ–Ω–∏–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏
          ‚Ä¢ üîÑ **30 –ª–µ—Ç** ‚Äî —Ç–µ—Ö–Ω–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –≤ ACT-—Ç–µ—Ä–∞–ø–∏–∏ (Acceptance and Commitment Therapy)
          ‚Ä¢ üå± **87%** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç–º–µ—á–∞—é—Ç –ø–æ–≤—ã—à–µ–Ω–∏–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∂–∏–∑–Ω–∏
          ‚Ä¢ üí° **–ù–µ–π—Ä–æ–ø–ª–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å** ‚Äî —Ä–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ —Å–æ–∑–¥–∞—ë—Ç —É—Å—Ç–æ–π—á–∏–≤—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ –ø—É—Ç–∏ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è
          
          *–ò—Å—Ç–æ—á–Ω–∏–∫: Journal of Contextual Behavioral Science, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è ACT-—Ç–µ—Ä–∞–ø–∏–∏, –Ω–µ–π—Ä–æ–±–∏–æ–ª–æ–≥–∏—è –º–æ—Ç–∏–≤–∞—Ü–∏–∏*
        MARKDOWN
      end
      
      def save_value_chain_stats
        begin
          exercise_data = get_exercise_data
          
          store_day_data('value_chain_stats', {
            date: Date.current.to_s,
            action_category: exercise_data['action_category']&.dig(:name),
            action_description: exercise_data['action_description'],
            levels_completed: VALUE_LEVELS.size,
            gaps_found: exercise_data['gaps_found'],
            bridges_created: exercise_data['bridges_created'],
            ritual_created: exercise_data['ritual'].present?,
            reflection: exercise_data['reflection'],
            completed: true
          })
        rescue => e
          log_error("Failed to save value chain stats", e)
        end
      end
      
      def get_exercise_data
        get_day_data('exercise_data') || {}
      end
      
      def log_info(message)
        Rails.logger.info "[Day#{DAY_NUMBER}Service] #{message} - User: #{@user.telegram_id}"
      end
      
      def log_error(message, error = nil)
        Rails.logger.error "[Day#{DAY_NUMBER}Service] #{message} - User: #{@user.telegram_id}"
        Rails.logger.error error.message if error
        Rails.logger.error error.backtrace.join("\n") if error
      end
      
      def log_warn(message)
        Rails.logger.warn "[Day#{DAY_NUMBER}Service] #{message} - User: #{@user.telegram_id}"
      end
    end
  end
end